# æ›´æ–°æ—¥å¿—

## [v2.2.22] - 2025-07-02

### ğŸ› å…³é”®Bugä¿®å¤ (Critical Bug Fixes)

#### ä¿®å¤è¿è¡Œæ—¶é…ç½®ä¿®æ”¹å¯¼è‡´åª’ä½“ç»„æ–‡æœ¬ä¸¢å¤±çš„æ ¹æœ¬é—®é¢˜ (Fix Root Cause of Media Group Text Loss)

**é—®é¢˜å‘ç° (Problem Discovery)**ï¼š
é€šè¿‡æ·±å…¥åˆ†æå‘ç°ï¼Œv2.2.21çš„ä¿®å¤ä»ä¸å®Œæ•´ã€‚çœŸæ­£çš„æ ¹æœ¬åŸå› æ˜¯**é¢„è¿‡æ»¤æœºåˆ¶å¯¼è‡´åŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯è¢«æå‰è¿‡æ»¤æ‰**ã€‚

**æ ¹æœ¬åŸå›  (Root Cause)**ï¼š
1. **ç¬¬ä¸€æ¬¡è½¬å‘ï¼ˆç¨‹åºé‡å¯åï¼‰**ï¼šè·å–æ‰€æœ‰31æ¡æ¶ˆæ¯ï¼ŒåŒ…å«å®Œæ•´åª’ä½“ç»„æ–‡æœ¬
2. **ç¬¬äºŒæ¬¡è½¬å‘ï¼ˆè¿è¡Œæ—¶é…ç½®ä¿®æ”¹ï¼‰**ï¼š`_filter_unforwarded_ids` é¢„è¿‡æ»¤æ‰å·²è½¬å‘çš„2æ¡æ¶ˆæ¯ï¼Œåªè·å–å‰©ä½™29æ¡æ¶ˆæ¯
3. **å…³é”®é—®é¢˜**ï¼šè¢«é¢„è¿‡æ»¤çš„æ¶ˆæ¯å¯èƒ½åŒ…å«äº†åª’ä½“ç»„çš„æ–‡æœ¬ä¿¡æ¯ï¼Œå¯¼è‡´å‰©ä½™æ¶ˆæ¯ä¸­çš„åª’ä½“ç»„å¤±å»æ–‡æœ¬

**å®Œæ•´ä¿®å¤æ–¹æ¡ˆ (Complete Solution)**ï¼š
```python
# src/modules/forward/media_group_collector.py
async def get_media_groups_info_optimized(...):
    # ğŸ”§ ä¿®å¤ï¼šå…ˆè·å–å®Œæ•´èŒƒå›´çš„æ¶ˆæ¯ï¼Œç”¨äºåª’ä½“ç»„æ–‡æœ¬æå–
    complete_messages = []
    async for message in self.message_iterator.iter_messages(source_id, start_id, end_id):
        complete_messages.append(message)
    
    # ğŸ”§ ä»å®Œæ•´æ¶ˆæ¯ä¸­é¢„æå–åª’ä½“ç»„æ–‡æœ¬ï¼ˆåœ¨é¢„è¿‡æ»¤ä¹‹å‰ï¼‰
    if complete_messages:
        complete_media_group_texts = self.message_filter._extract_media_group_texts(complete_messages)
        media_group_texts.update(complete_media_group_texts)
    
    # ç„¶åæ‰è¿›è¡Œé¢„è¿‡æ»¤å’Œåç»­å¤„ç†
    unforwarded_ids = self._filter_unforwarded_ids(...)
```

**æŠ€æœ¯æ”¹è¿› (Technical Improvements)**ï¼š
- **åŒé‡æ–‡æœ¬æå–**ï¼šå®Œæ•´èŒƒå›´é¢„æå– + è¿‡æ»¤åè¡¥å……æå–
- **æ–‡æœ¬æ˜ å°„åˆå¹¶**ï¼šé¢„æå–çš„æ–‡æœ¬ä¼˜å…ˆçº§æ›´é«˜ï¼Œç¡®ä¿ä¸ä¸¢å¤±
- **å¢å¼ºè°ƒè¯•ä¿¡æ¯**ï¼šè¯¦ç»†è·Ÿè¸ªåª’ä½“ç»„æ–‡æœ¬æå–è¿‡ç¨‹

**ä¿®å¤æ•ˆæœ (Result)**ï¼š
- âœ… å½»åº•è§£å†³è¿è¡Œæ—¶é…ç½®ä¿®æ”¹ååª’ä½“ç»„æ–‡æœ¬ä¸¢å¤±é—®é¢˜
- âœ… ç¡®ä¿ç¨‹åºé‡å¯å’Œè¿è¡Œæ—¶ä¿®æ”¹é…ç½®çš„è¡Œä¸ºå®Œå…¨ä¸€è‡´
- âœ… åª’ä½“è¯´æ˜åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½èƒ½æ­£ç¡®ä¿ç•™å’Œåº”ç”¨æ–‡æœ¬æ›¿æ¢

---

## [v2.2.21] - 2025-07-02

### ğŸ› Bugä¿®å¤ (Bug Fixes)

#### ä¿®å¤è¿è¡Œæ—¶é…ç½®ä¿®æ”¹å¯¼è‡´åª’ä½“ç»„æ–‡æœ¬ä¸¢å¤±çš„é—®é¢˜ (Fix Media Group Text Loss on Runtime Configuration Changes)

**é—®é¢˜æè¿° (Issue Description)**ï¼š
ç”¨æˆ·åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­é€šè¿‡å³é”®ç¼–è¾‘èœå•ä¿®æ”¹è½¬å‘é…ç½®æ—¶ï¼Œä¼šå¯¼è‡´åª’ä½“ç»„æ–‡æœ¬ï¼ˆåª’ä½“è¯´æ˜ï¼‰ä¸¢å¤±ã€‚ä¾‹å¦‚ï¼š
1. æ²¡æœ‰å‹¾é€‰"ç§»é™¤åª’ä½“è¯´æ˜"
2. å…ˆé…ç½®åªè½¬å‘è§†é¢‘ï¼Œè½¬å‘æˆåŠŸä¸”ä¿ç•™åª’ä½“è¯´æ˜
3. å³é”®ç¼–è¾‘ä¿®æ”¹ä¸ºåªè½¬å‘ç…§ç‰‡ï¼Œè½¬å‘ååª’ä½“ç»„é‡ç»„ä½†åª’ä½“è¯´æ˜ä¸¢å¤±
4. ç¨‹åºé‡å¯åè½¬å‘ç›¸åŒé…ç½®åˆ™æ­£å¸¸

**æ ¹æœ¬åŸå›  (Root Cause)**ï¼š
è¿è¡Œæ—¶é…ç½®ä¿®æ”¹åï¼Œ`MediaGroupCollector` å®ä¾‹ä¿ç•™äº†ä¹‹å‰çš„å†…éƒ¨çŠ¶æ€ï¼Œå¯¼è‡´åª’ä½“ç»„æ–‡æœ¬é¢„æå–åŸºäºæ—§çš„çŠ¶æ€è¿›è¡Œï¼Œä¸æ–°çš„è¿‡æ»¤é…ç½®ä¸åŒ¹é…ã€‚

**ä¿®å¤æ–¹æ¡ˆ (Solution)**ï¼š
æ¯æ¬¡ç‚¹å‡»"å¼€å§‹è½¬å‘"æ—¶ï¼Œå®Œå…¨é‡æ–°åˆ›å»º `MediaGroupCollector` å®ä¾‹ï¼Œç¡®ä¿åŸºäºæœ€æ–°é…ç½®é‡æ–°åˆå§‹åŒ–ï¼Œæ— çŠ¶æ€æ®‹ç•™ã€‚

**ä¿®å¤å†…å®¹ (Changes)**ï¼š

```python
# src/modules/forward/forwarder.py (ç¬¬162è¡Œ)
# ä¿®æ”¹å‰ï¼š
self.media_group_collector.message_filter = self.message_filter

# ä¿®æ”¹åï¼š
self.media_group_collector = MediaGroupCollector(self.message_iterator, self.message_filter)
```

**æ•ˆæœ (Result)**ï¼š
- âœ… ç¡®ä¿ç¨‹åºé‡å¯åè½¬å‘ = è¿è¡Œæ—¶ä¿®æ”¹é…ç½®åè½¬å‘
- âœ… æ¯æ¬¡ç‚¹å‡»å¼€å§‹è½¬å‘éƒ½æ‰§è¡Œç›¸åŒçš„åˆå§‹åŒ–æµç¨‹
- âœ… åª’ä½“è¯´æ˜åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½èƒ½æ­£ç¡®ä¿ç•™

---

## [v2.2.20] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **é“¾æ¥æ£€æµ‹å®ä½“ç±»å‹å¤„ç†ä¿®å¤**ï¼šä¿®å¤äº†pyrogram MessageEntityTypeæšä¸¾å¤„ç†é”™è¯¯å¯¼è‡´TEXT_LINKæ£€æµ‹å¤±è´¥çš„é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› **ï¼šä¹‹å‰çš„ä»£ç æ— æ³•æ­£ç¡®å¤„ç†pyrogramçš„MessageEntityTypeæšä¸¾ï¼Œå¯¼è‡´TEXT_LINKç±»å‹çš„éšå¼é“¾æ¥æ— æ³•è¢«è¯†åˆ«
  - âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šæ”¹è¿›å®ä½“ç±»å‹å¤„ç†é€»è¾‘ï¼Œä¼˜å…ˆä½¿ç”¨æšä¸¾çš„`name`å±æ€§ï¼Œæ­£ç¡®è¯†åˆ«TEXT_LINKã€URLã€EMAILç­‰ç±»å‹
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç°åœ¨åŒ…å«"ç‚¹å‡»æ­¤å¤„"ç­‰éšå¼è¶…é“¾æ¥çš„æ¶ˆæ¯èƒ½è¢«æ­£ç¡®è¿‡æ»¤ï¼Œexclude_linksé…ç½®å®Œå…¨ç”Ÿæ•ˆ
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š`src/modules/forward/message_filter.py`çš„`_contains_links`æ–¹æ³•

### æŠ€æœ¯å®ç°
- **æšä¸¾ä¼˜å…ˆå¤„ç†**ï¼šä¼˜å…ˆæ£€æŸ¥`raw_type.name`å±æ€§è·å–æšä¸¾åç§°ï¼Œç¡®ä¿å‡†ç¡®è¯†åˆ«pyrogramå®ä½“ç±»å‹
- **é™çº§å¤„ç†æœºåˆ¶**ï¼šæä¾›`value`å±æ€§å’Œå­—ç¬¦ä¸²è½¬æ¢ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼Œç¡®ä¿å…¼å®¹æ€§
- **è¯¦ç»†è°ƒè¯•æ—¥å¿—**ï¼šè®°å½•åŸå§‹ç±»å‹å’Œè½¬æ¢åç±»å‹ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜
- **æ ‡å‡†åŒ–æ¯”è¾ƒ**ï¼šç»Ÿä¸€è½¬æ¢ä¸ºå°å†™å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œé¿å…å¤§å°å†™é—®é¢˜

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **éšå¼é“¾æ¥è¯†åˆ«**ï¼šåŒ…å«"ç‚¹å‡»æ­¤å¤„"ç­‰TEXT_LINKç±»å‹çš„æ¶ˆæ¯ç°åœ¨èƒ½è¢«æ­£ç¡®è¿‡æ»¤
- âœ… **é…ç½®ä¸€è‡´æ€§**ï¼šexclude_linksé…ç½®å¯¹æ‰€æœ‰é“¾æ¥ç±»å‹ï¼ˆæ˜¾å¼ã€éšå¼ï¼‰éƒ½æœ‰æ•ˆ
- âœ… **è°ƒè¯•é€æ˜**ï¼šé€šè¿‡æ—¥å¿—å¯ä»¥æ¸…æ¥šçœ‹åˆ°å®ä½“ç±»å‹çš„æ£€æµ‹å’Œè½¬æ¢è¿‡ç¨‹
- âœ… **å…¼å®¹ä¿è¯**ï¼šæ”¯æŒpyrogramä¸åŒç‰ˆæœ¬çš„å®ä½“ç±»å‹è¡¨ç¤ºæ–¹å¼

## [v2.2.19] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **é“¾æ¥æ£€æµ‹å®ä½“ç±»å‹å¤„ç†ä¿®å¤**ï¼šä¿®å¤äº†pyrogram MessageEntityTypeæšä¸¾å¤„ç†é”™è¯¯å¯¼è‡´TEXT_LINKæ£€æµ‹å¤±è´¥çš„é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› **ï¼šä¹‹å‰çš„ä»£ç æ— æ³•æ­£ç¡®å¤„ç†pyrogramçš„MessageEntityTypeæšä¸¾ï¼Œå¯¼è‡´TEXT_LINKç±»å‹çš„éšå¼é“¾æ¥æ— æ³•è¢«è¯†åˆ«
  - âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šæ”¹è¿›å®ä½“ç±»å‹å¤„ç†é€»è¾‘ï¼Œä¼˜å…ˆä½¿ç”¨æšä¸¾çš„`name`å±æ€§ï¼Œæ­£ç¡®è¯†åˆ«TEXT_LINKã€URLã€EMAILç­‰ç±»å‹
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç°åœ¨åŒ…å«"ç‚¹å‡»æ­¤å¤„"ç­‰éšå¼è¶…é“¾æ¥çš„æ¶ˆæ¯èƒ½è¢«æ­£ç¡®è¿‡æ»¤ï¼Œexclude_linksé…ç½®å®Œå…¨ç”Ÿæ•ˆ
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š`src/modules/forward/message_filter.py`çš„`_contains_links`æ–¹æ³•

### æŠ€æœ¯å®ç°
- **æšä¸¾ä¼˜å…ˆå¤„ç†**ï¼šä¼˜å…ˆæ£€æŸ¥`raw_type.name`å±æ€§è·å–æšä¸¾åç§°ï¼Œç¡®ä¿å‡†ç¡®è¯†åˆ«pyrogramå®ä½“ç±»å‹
- **é™çº§å¤„ç†æœºåˆ¶**ï¼šæä¾›`value`å±æ€§å’Œå­—ç¬¦ä¸²è½¬æ¢ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼Œç¡®ä¿å…¼å®¹æ€§
- **è¯¦ç»†è°ƒè¯•æ—¥å¿—**ï¼šè®°å½•åŸå§‹ç±»å‹å’Œè½¬æ¢åç±»å‹ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜
- **æ ‡å‡†åŒ–æ¯”è¾ƒ**ï¼šç»Ÿä¸€è½¬æ¢ä¸ºå°å†™å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œé¿å…å¤§å°å†™é—®é¢˜

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **éšå¼é“¾æ¥è¯†åˆ«**ï¼šåŒ…å«"ç‚¹å‡»æ­¤å¤„"ç­‰TEXT_LINKç±»å‹çš„æ¶ˆæ¯ç°åœ¨èƒ½è¢«æ­£ç¡®è¿‡æ»¤
- âœ… **é…ç½®ä¸€è‡´æ€§**ï¼šexclude_linksé…ç½®å¯¹æ‰€æœ‰é“¾æ¥ç±»å‹ï¼ˆæ˜¾å¼ã€éšå¼ï¼‰éƒ½æœ‰æ•ˆ
- âœ… **è°ƒè¯•é€æ˜**ï¼šé€šè¿‡æ—¥å¿—å¯ä»¥æ¸…æ¥šçœ‹åˆ°å®ä½“ç±»å‹çš„æ£€æµ‹å’Œè½¬æ¢è¿‡ç¨‹
- âœ… **å…¼å®¹ä¿è¯**ï¼šæ”¯æŒpyrogramä¸åŒç‰ˆæœ¬çš„å®ä½“ç±»å‹è¡¨ç¤ºæ–¹å¼

## [v2.2.18] - 2025-07-02

### ğŸ”§ é“¾æ¥æ£€æµ‹å¢å¼ºä¸è°ƒè¯•
- **é“¾æ¥æ£€æµ‹é€»è¾‘å¢å¼º**ï¼šæ”¹è¿›pyrogramå®ä½“ç±»å‹å¤„ç†ï¼Œç¡®ä¿æ­£ç¡®æ£€æµ‹æ‰€æœ‰ç±»å‹çš„é“¾æ¥
  - ğŸ”§ **å®ä½“ç±»å‹å¤„ç†**ï¼šæ”¯æŒæšä¸¾ç±»å‹ã€å­—ç¬¦ä¸²ç±»å‹ç­‰å¤šç§pyrogramå®ä½“ç±»å‹æ ¼å¼ï¼Œå…¼å®¹æ€§æ›´å¼º
  - ğŸ” **è°ƒè¯•ä¿¡æ¯å¢å¼º**ï¼šæ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œè®°å½•æ£€æµ‹åˆ°çš„å®ä½“ç±»å‹å’Œé“¾æ¥æ¨¡å¼
  - ğŸ¯ **å…¨é¢è¦†ç›–**ï¼šç¡®ä¿æ£€æµ‹`url`ï¼ˆæ˜¾å¼é“¾æ¥ï¼‰ã€`text_link`ï¼ˆéšå¼è¶…é“¾æ¥ï¼‰ã€`email`ï¼ˆé‚®ç®±ï¼‰ã€`phone_number`ï¼ˆç”µè¯ï¼‰ç­‰æ‰€æœ‰é“¾æ¥ç±»å‹
  - âœ… **åŒé‡ä¿éšœ**ï¼šå®ä½“æ£€æµ‹ + æ­£åˆ™è¡¨è¾¾å¼æ£€æµ‹ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•é“¾æ¥
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š`src/modules/forward/message_filter.py`çš„`_contains_links`æ–¹æ³•

### æŠ€æœ¯å®ç°
- **æ™ºèƒ½ç±»å‹è¯†åˆ«**ï¼šè‡ªåŠ¨å¤„ç†pyrogramå®ä½“çš„ä¸åŒè¡¨ç¤ºæ–¹å¼ï¼ˆæšä¸¾å€¼ã€å­—ç¬¦ä¸²ã€å¯¹è±¡ç­‰ï¼‰
- **è°ƒè¯•å‹å¥½**ï¼šæ·»åŠ è¯¦ç»†æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥é“¾æ¥æ£€æµ‹é—®é¢˜ï¼Œæå‡è°ƒè¯•æ•ˆç‡
- **é”™è¯¯å®¹é”™**ï¼šå¥å£®çš„å®ä½“ç±»å‹è·å–ï¼Œé˜²æ­¢å› ç±»å‹æ ¼å¼å·®å¼‚å¯¼è‡´çš„æ£€æµ‹å¤±è´¥
- **æ€§èƒ½ä¼˜åŒ–**ï¼šä¼˜å…ˆä½¿ç”¨ç²¾ç¡®çš„å®ä½“æ£€æµ‹ï¼Œå¤‡ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æµ‹

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **æ£€æµ‹å‡†ç¡®æ€§**ï¼šæ— è®ºæ˜¯æ˜¾å¼é“¾æ¥è¿˜æ˜¯Telegramçš„éšå¼è¶…é“¾æ¥éƒ½èƒ½å‡†ç¡®è¯†åˆ«
- âœ… **é…ç½®ä¸€è‡´æ€§**ï¼šexclude_linksé…ç½®å¯¹æ‰€æœ‰æ¶ˆæ¯ç±»å‹å’Œé“¾æ¥ç±»å‹éƒ½æœ‰æ•ˆ
- âœ… **è°ƒè¯•é€æ˜åº¦**ï¼šé€šè¿‡æ—¥å¿—å¯ä»¥æ¸…æ¥šçœ‹åˆ°é“¾æ¥æ£€æµ‹çš„è¯¦ç»†è¿‡ç¨‹
- âœ… **å…¼å®¹æ€§ä¿è¯**ï¼šæ”¯æŒä¸åŒç‰ˆæœ¬pyrogramçš„å®ä½“ç±»å‹è¡¨ç¤ºæ–¹å¼

## [v2.2.17] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **é“¾æ¥è¿‡æ»¤åŠŸèƒ½å®Œå–„**ï¼šä¿®å¤äº†exclude_linksé…ç½®å¯¹çº¯æ–‡æœ¬æ¶ˆæ¯æ— æ•ˆçš„å…³é”®é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› 1**ï¼šçº¯æ–‡æœ¬æ¶ˆæ¯å¤„ç†ç»•è¿‡äº†æ•´ä¸ªè¿‡æ»¤ç³»ç»Ÿï¼Œç›´æ¥è¿›è¡Œè½¬å‘ï¼Œå¯¼è‡´exclude_linksé…ç½®å¯¹çº¯æ–‡æœ¬æ¶ˆæ¯å®Œå…¨æ— æ•ˆ
  - ğŸ”§ **æ ¹æœ¬åŸå› 2**ï¼šé“¾æ¥æ£€æµ‹åªèƒ½è¯†åˆ«æ˜¾å¼URLï¼ˆå¦‚http://ï¼‰ï¼Œæ— æ³•æ£€æµ‹Telegramä¸­çš„éšå¼è¶…é“¾æ¥ï¼ˆå¦‚"ç‚¹å‡»æ­¤å¤„"è¿™æ ·çš„æ–‡æœ¬é“¾æ¥ï¼‰
  - âœ… **è§£å†³æ–¹æ¡ˆ1**ï¼šåœ¨è½¬å‘å™¨çš„çº¯æ–‡æœ¬æ¶ˆæ¯å¤„ç†æµç¨‹ä¸­æ·»åŠ é“¾æ¥è¿‡æ»¤æ£€æŸ¥ï¼Œç¡®ä¿exclude_linksé…ç½®å¯¹æ‰€æœ‰æ¶ˆæ¯ç±»å‹ç”Ÿæ•ˆ
  - âœ… **è§£å†³æ–¹æ¡ˆ2**ï¼šæ”¹è¿›é“¾æ¥æ£€æµ‹æ–¹æ³•ï¼Œä¼˜å…ˆæ£€æŸ¥Telegramæ¶ˆæ¯å®ä½“ä¸­çš„é“¾æ¥ä¿¡æ¯ï¼ˆentitiesï¼‰ï¼Œèƒ½å‡†ç¡®è¯†åˆ«éšå¼è¶…é“¾æ¥
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç°åœ¨åŒ…å«ä»»ä½•ç±»å‹é“¾æ¥çš„çº¯æ–‡æœ¬æ¶ˆæ¯éƒ½èƒ½è¢«æ­£ç¡®è¿‡æ»¤ï¼Œæ— è®ºæ˜¯æ˜¾å¼URLè¿˜æ˜¯éšå¼è¶…é“¾æ¥
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š
    - `src/modules/forward/forwarder.py`ï¼šçº¯æ–‡æœ¬æ¶ˆæ¯å¤„ç†å‰æ·»åŠ é“¾æ¥è¿‡æ»¤é€»è¾‘
    - `src/modules/forward/message_filter.py`ï¼šæ”¹è¿›_contains_linksæ–¹æ³•æ”¯æŒTelegramå®ä½“æ£€æµ‹

### æŠ€æœ¯å®ç°
- **å®Œæ•´è¦†ç›–**ï¼šç¡®ä¿æ‰€æœ‰æ¶ˆæ¯ç±»å‹ï¼ˆçº¯æ–‡æœ¬ã€åª’ä½“æ¶ˆæ¯ã€åª’ä½“ç»„ï¼‰éƒ½éµå¾ªexclude_linksé…ç½®
- **æ™ºèƒ½æ£€æµ‹**ï¼šé€šè¿‡Telegramæ¶ˆæ¯å®ä½“æ£€æµ‹éšå¼é“¾æ¥ï¼Œæ”¯æŒurlã€text_linkã€emailã€phone_numberç­‰ç±»å‹
- **åŒé‡ä¿éšœ**ï¼šå®ä½“æ£€æµ‹+æ­£åˆ™è¡¨è¾¾å¼æ£€æµ‹ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•é“¾æ¥ç±»å‹
- **ç²¾ç¡®è¿‡æ»¤**ï¼šåŒ…å«é“¾æ¥çš„æ¶ˆæ¯ä¼šè¢«è®°å½•å¹¶è·³è¿‡ï¼Œä¸ä¼šå½±å“å…¶ä»–æ­£å¸¸æ¶ˆæ¯çš„è½¬å‘

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **é…ç½®ä¸€è‡´æ€§**ï¼šexclude_linksé…ç½®ç°åœ¨å¯¹æ‰€æœ‰æ¶ˆæ¯ç±»å‹éƒ½æœ‰æ•ˆï¼Œè¡Œä¸ºå®Œå…¨ä¸€è‡´
- âœ… **æ™ºèƒ½è¯†åˆ«**ï¼šèƒ½å¤Ÿè¯†åˆ«å„ç§å½¢å¼çš„é“¾æ¥ï¼ŒåŒ…æ‹¬Telegramç‰¹æœ‰çš„éšå¼è¶…é“¾æ¥
- âœ… **å‡†ç¡®è¿‡æ»¤**ï¼šæœ‰æ•ˆé˜»æ­¢åŒ…å«æ¨å¹¿é“¾æ¥ã€é‚€è¯·é“¾æ¥ç­‰ä¸éœ€è¦çš„æ¶ˆæ¯è¢«è½¬å‘
- âœ… **æ—¥å¿—æ˜ç¡®**ï¼šè¢«è¿‡æ»¤çš„å«é“¾æ¥æ¶ˆæ¯ä¼šæœ‰æ¸…æ™°çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºç”¨æˆ·äº†è§£è¿‡æ»¤æƒ…å†µ
- âœ… **å‘åå…¼å®¹**ï¼šä¿®å¤ä¸å½±å“ä»»ä½•ç°æœ‰è½¬å‘åŠŸèƒ½ï¼Œçº¯å¢é‡æ”¹è¿›

## [v2.2.16] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **åª’ä½“ç»„è½¬å‘è®¡æ•°ä¿®å¤**ï¼šä¿®å¤äº†ç¦æ­¢è½¬å‘é¢‘é“åª’ä½“ç»„è½¬å‘æ—¶UIè®¡æ•°æ— æ³•å®æ—¶æ›´æ–°çš„é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› **ï¼šå¹¶è¡Œå¤„ç†å™¨ï¼ˆParallelProcessorï¼‰åœ¨åª’ä½“ç»„è½¬å‘å®Œæˆåæ²¡æœ‰å‘é€UIæ›´æ–°ä¿¡å·ï¼Œå¯¼è‡´åª’ä½“ç»„è½¬å‘è®¡æ•°å§‹ç»ˆæ˜¾ç¤ºä¸ºå†å²è®°å½•å€¼
  - âœ… **è§£å†³æ–¹æ¡ˆ1**ï¼šä¸ºParallelProcessoræ„é€ å‡½æ•°æ·»åŠ `emit`å›è°ƒå‚æ•°ï¼Œå¹¶åœ¨è½¬å‘å™¨åˆ›å»ºæ—¶ä¼ é€’`self._emit_event`
  - âœ… **è§£å†³æ–¹æ¡ˆ2**ï¼šåœ¨åª’ä½“ç»„æˆåŠŸä¸Šä¼ åˆ°æ‰€æœ‰ç›®æ ‡é¢‘é“åå‘é€å¯¹åº”çš„è½¬å‘å®Œæˆä¿¡å·ï¼ˆ`media_group_forwarded`æˆ–`message_forwarded`ï¼‰
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç°åœ¨æ— è®ºæ˜¯çº¯æ–‡æœ¬æ¶ˆæ¯è¿˜æ˜¯åª’ä½“ç»„è½¬å‘ï¼ŒçŠ¶æ€è¡¨æ ¼çš„"å·²è½¬å‘æ¶ˆæ¯æ•°"éƒ½èƒ½æ­£ç¡®å®æ—¶æ›´æ–°
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š
    - `src/modules/forward/parallel_processor.py`ï¼šæ„é€ å‡½æ•°æ·»åŠ emitå‚æ•°ï¼Œä¸Šä¼ å®Œæˆåå‘é€ä¿¡å·
    - `src/modules/forward/forwarder.py`ï¼šåˆ›å»ºParallelProcessoræ—¶ä¼ é€’_emit_eventå›è°ƒ

### æŠ€æœ¯å®ç°
- **å›è°ƒæœºåˆ¶**ï¼šé€šè¿‡å‡½æ•°å›è°ƒçš„æ–¹å¼è®©å¹¶è¡Œå¤„ç†å™¨èƒ½å¤Ÿå‘è½¬å‘å™¨å‘é€äº‹ä»¶é€šçŸ¥
- **ä¿¡å·ç»Ÿä¸€æ€§**ï¼šç¡®ä¿æ‰€æœ‰è½¬å‘æ–¹å¼ï¼ˆç›´æ¥è½¬å‘ã€ä¸‹è½½é‡ä¼ ã€å¹¶è¡Œå¤„ç†ï¼‰éƒ½èƒ½å‘é€ä¸€è‡´çš„UIæ›´æ–°ä¿¡å·
- **æ™ºèƒ½è¯†åˆ«**ï¼šè‡ªåŠ¨åŒºåˆ†åª’ä½“ç»„å’Œå•æ¡æ¶ˆæ¯ï¼Œå‘é€å¯¹åº”çš„ä¿¡å·ç±»å‹
- **å®Œæ•´è¦†ç›–**ï¼šæ”¯æŒæˆåŠŸä¸Šä¼ å’Œå¤åˆ¶è½¬å‘ä¸¤ç§åœºæ™¯çš„ä¿¡å·å‘é€

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **å®Œæ•´è®¡æ•°æ”¯æŒ**ï¼šçº¯æ–‡æœ¬æ¶ˆæ¯ã€åª’ä½“æ¶ˆæ¯ã€åª’ä½“ç»„è½¬å‘å…¨éƒ¨æ”¯æŒå®æ—¶è®¡æ•°æ›´æ–°
- âœ… **ç¦æ­¢è½¬å‘é¢‘é“å®Œå…¨æ”¯æŒ**ï¼šæ— è®ºæºé¢‘é“è½¬å‘æƒé™å¦‚ä½•ï¼ŒUIéƒ½èƒ½æ­£ç¡®æ˜¾ç¤ºè½¬å‘è¿›åº¦
- âœ… **çŠ¶æ€ä¸€è‡´æ€§**ï¼šUIæ˜¾ç¤ºçš„è½¬å‘çŠ¶æ€ä¸å®é™…è½¬å‘æ“ä½œå®Œå…¨åŒæ­¥ï¼Œæ— é—æ¼
- âœ… **å®æ—¶åé¦ˆ**ï¼šæ¯ä¸ªåª’ä½“ç»„è½¬å‘æˆåŠŸåç«‹å³æ›´æ–°å¯¹åº”é¢‘é“çš„è½¬å‘è®¡æ•°

## [v2.2.15] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **ç¦æ­¢è½¬å‘é¢‘é“çš„è½¬å‘è®¡æ•°ä¿®å¤**ï¼šä¿®å¤äº†ç¦æ­¢è½¬å‘é¢‘é“æ—¶è½¬å‘è®¡æ•°æ— æ³•å®æ—¶æ›´æ–°çš„é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› **ï¼šåœ¨ç¦æ­¢è½¬å‘é¢‘é“ä½¿ç”¨"ä¸‹è½½åé‡æ–°ä¸Šä¼ "æ–¹å¼å¤„ç†çº¯æ–‡æœ¬æ¶ˆæ¯æ—¶ï¼Œè½¬å‘æˆåŠŸååªè®°å½•äº†å†å²ï¼Œä½†æ²¡æœ‰å‘é€UIæ›´æ–°ä¿¡å·
  - âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨ `forwarder.py` çš„çº¯æ–‡æœ¬æ¶ˆæ¯è½¬å‘æˆåŠŸåæ·»åŠ  `self._emit_event("message_forwarded", message_id, target_info)` ä¿¡å·å‘é€
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç¦æ­¢è½¬å‘é¢‘é“çš„çº¯æ–‡æœ¬æ¶ˆæ¯è½¬å‘åï¼ŒçŠ¶æ€è¡¨æ ¼çš„"å·²è½¬å‘æ¶ˆæ¯æ•°"èƒ½æ­£ç¡®ä»"0/11"æ›´æ–°ä¸º"2/11"ç­‰
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š`src/modules/forward/forwarder.py` ç¬¬409è¡Œï¼Œåœ¨å†å²è®°å½•ä¿å­˜åæ·»åŠ ä¿¡å·å‘é€

### æŠ€æœ¯å®ç°
- **ä¿¡å·å®Œæ•´æ€§ä¿è¯**ï¼šç¡®ä¿æ‰€æœ‰è½¬å‘æ–¹å¼ï¼ˆç›´æ¥è½¬å‘ã€ä¸‹è½½é‡ä¼ ï¼‰éƒ½èƒ½æ­£ç¡®å‘é€UIæ›´æ–°ä¿¡å·
- **å†å²è®°å½•ä¸€è‡´æ€§**ï¼šä¿æŒå†å²è®°å½•ä¿å­˜ä¸UIæ›´æ–°ä¿¡å·çš„åŒæ­¥å‘é€
- **å‘åå…¼å®¹æ€§**ï¼šä¿®å¤ä¸å½±å“ä»»ä½•ç°æœ‰è½¬å‘åŠŸèƒ½ï¼Œçº¯å¢é‡æ”¹è¿›

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **ç¦æ­¢è½¬å‘é¢‘é“æ”¯æŒ**ï¼šæ— è®ºæºé¢‘é“æ˜¯å¦å…è®¸è½¬å‘ï¼ŒUIéƒ½èƒ½æ­£ç¡®æ˜¾ç¤ºå®æ—¶è¿›åº¦
- âœ… **è®¡æ•°å‡†ç¡®æ€§**ï¼šæ‰€æœ‰è½¬å‘åœºæ™¯ä¸‹çš„è½¬å‘è®¡æ•°éƒ½èƒ½å‡†ç¡®å®æ—¶æ›´æ–°
- âœ… **çŠ¶æ€ä¸€è‡´æ€§**ï¼šUIæ˜¾ç¤ºä¸å®é™…è½¬å‘çŠ¶æ€å®Œå…¨åŒæ­¥ï¼Œæ— å»¶è¿Ÿæˆ–ä¸¢å¤±
- âœ… **å®Œæ•´è¦†ç›–**ï¼šçº¯æ–‡æœ¬æ¶ˆæ¯ã€åª’ä½“æ¶ˆæ¯ã€åª’ä½“ç»„è½¬å‘å…¨éƒ¨æ”¯æŒå®æ—¶è®¡æ•°

## [v2.2.14] - 2025-07-02

### âœ¨ ç”¨æˆ·ä½“éªŒæ”¹è¿›
- **è½¬å‘è¿›åº¦è‡ªåŠ¨è·³è½¬åŠŸèƒ½**ï¼šç‚¹å‡»"å¼€å§‹è½¬å‘"æŒ‰é’®åè‡ªåŠ¨è·³è½¬åˆ°"è½¬å‘è¿›åº¦"é€‰é¡¹å¡
  - ğŸ¯ **ç”¨æˆ·éœ€æ±‚**ï¼šç”¨æˆ·å¸Œæœ›å¼€å§‹è½¬å‘åèƒ½ç«‹å³æŸ¥çœ‹è½¬å‘çŠ¶æ€å’Œè¿›åº¦
  - âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨ `_start_forward` æ–¹æ³•ä¸­æ·»åŠ  `self.config_tabs.setCurrentIndex(2)` è‡ªåŠ¨åˆ‡æ¢åˆ°è½¬å‘è¿›åº¦é¡µ
  - ğŸ“ **ä¿®æ”¹ä½ç½®**ï¼š`src/ui/views/forward_view.py` çš„ `_start_forward` æ–¹æ³•
  - ğŸ¯ **å®ç°æ•ˆæœ**ï¼šç‚¹å‡»å¼€å§‹è½¬å‘åç«‹å³è·³è½¬åˆ°è½¬å‘è¿›åº¦é€‰é¡¹å¡ï¼Œæ–¹ä¾¿ç”¨æˆ·å®æ—¶ç›‘æ§è½¬å‘çŠ¶æ€

### æŠ€æœ¯å®ç°
- **æ™ºèƒ½ç•Œé¢åˆ‡æ¢**ï¼šè‡ªåŠ¨è¯†åˆ«è½¬å‘è¿›åº¦é€‰é¡¹å¡ç´¢å¼•ï¼ˆç¬¬3ä¸ªæ ‡ç­¾é¡µï¼Œç´¢å¼•ä¸º2ï¼‰
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šå‡å°‘ç”¨æˆ·æ‰‹åŠ¨åˆ‡æ¢æ ‡ç­¾é¡µçš„æ“ä½œæ­¥éª¤

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **å³æ—¶åé¦ˆ**ï¼šè½¬å‘å¼€å§‹åç«‹å³æ˜¾ç¤ºè½¬å‘çŠ¶æ€è¡¨æ ¼å’Œè¿›åº¦ä¿¡æ¯
- âœ… **æ“ä½œç®€åŒ–**ï¼šæ— éœ€æ‰‹åŠ¨åˆ‡æ¢æ ‡ç­¾é¡µå³å¯æŸ¥çœ‹è½¬å‘è¿›åº¦
- âœ… **çŠ¶æ€å¯è§æ€§**ï¼šè½¬å‘è¿‡ç¨‹ä¸­çš„æ‰€æœ‰çŠ¶æ€å˜åŒ–éƒ½èƒ½åŠæ—¶çœ‹åˆ°
- âœ… **ç›´è§‚ç›‘æ§**ï¼šè½¬å‘æ¶ˆæ¯æ•°ã€çŠ¶æ€ç­‰å…³é”®ä¿¡æ¯ä¸€ç›®äº†ç„¶

## [v2.2.13] - 2025-07-02

### ğŸ› é‡è¦ä¿®å¤
- **è½¬å‘è®¡æ•°å®æ—¶æ›´æ–°ä¿®å¤**ï¼šä¿®å¤äº†è½¬å‘å†å²è®°å½•ç»Ÿè®¡åŠŸèƒ½ä¸­çš„è®¡æ•°æ›´æ–°é—®é¢˜
  - ğŸ”§ **æ ¹æœ¬åŸå› **ï¼šè½¬å‘å™¨ä¿¡å·å¤„ç†æ—¶æå‰æå–é¢‘é“åç§°ï¼Œä¸¢å¤±äº†å…³é”®çš„é¢‘é“IDä¿¡æ¯
  - âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šä¿ç•™å®Œæ•´çš„`target_info`ä¼ é€’ç»™é¢‘é“åŒ¹é…æ–¹æ³•ï¼Œç¡®ä¿IDæå–é€»è¾‘æ­£å¸¸å·¥ä½œ
  - ğŸ¯ **ä¿®å¤æ•ˆæœ**ï¼šç°åœ¨è½¬å‘æ–°æ¶ˆæ¯åï¼Œå·²è½¬å‘æ¶ˆæ¯æ•°èƒ½æ­£ç¡®ä»"44/60"æ›´æ–°ä¸º"47/60"ç­‰
  - ğŸ“ˆ **æ¶‰åŠæ–¹æ³•**ï¼š`_on_message_forwarded`ã€`_on_message_forwarded_event`ã€`_increment_forwarded_count_for_target`

### æŠ€æœ¯æ”¹è¿›
- **é¢‘é“åŒ¹é…é€»è¾‘å¢å¼º**ï¼šæ”¹è¿›äº†å¤šç§é¢‘é“åŒ¹é…ç­–ç•¥çš„å¯é æ€§
  - æ–¹æ³•1: é€šè¿‡é¢‘é“IDç²¾ç¡®åŒ¹é…ï¼ˆåˆ©ç”¨å®Œæ•´target_infoä¸­çš„IDï¼‰
  - æ–¹æ³•2: æ™ºèƒ½åå‘æŸ¥æ‰¾ï¼ˆåŸºäºå·²å»ºç«‹çš„é¢‘é“IDæ˜ å°„ï¼‰
  - æ–¹æ³•3-6: å¤šé‡å¤‡ç”¨åŒ¹é…ç­–ç•¥ï¼Œç¡®ä¿å…¼å®¹æ€§
- **è°ƒè¯•ä¿¡æ¯å®Œå–„**ï¼šå¢åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜è¯Šæ–­
- **é”™è¯¯å¤„ç†ä¼˜åŒ–**ï¼šæ”¹è¿›äº†å¼‚å¸¸å¤„ç†å’Œé”™è¯¯ä¿¡æ¯æç¤º

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **å®æ—¶è¿›åº¦åé¦ˆ**ï¼šè½¬å‘è¿›è¡Œæ—¶UIå®æ—¶æ˜¾ç¤ºå‡†ç¡®çš„è¿›åº¦è®¡æ•°
- âœ… **çŠ¶æ€ä¸€è‡´æ€§**ï¼šå†å²è®°å½•ä¸å®æ—¶è½¬å‘è¿›åº¦å®Œç¾èåˆï¼Œæ— ç¼æ˜¾ç¤º
- âœ… **æ•°æ®å‡†ç¡®æ€§**ï¼šç¡®ä¿æ¯æ¬¡è½¬å‘æ“ä½œéƒ½èƒ½æ­£ç¡®æ›´æ–°UIçŠ¶æ€
- âœ… **ç³»ç»Ÿç¨³å®šæ€§**ï¼šå¤šé‡åŒ¹é…ç­–ç•¥æé«˜äº†é¢‘é“è¯†åˆ«çš„æˆåŠŸç‡

## [v2.2.12] - 2025-07-02

### åŠŸèƒ½å¢å¼º
- **å†å²è½¬å‘è®°å½•ç»Ÿè®¡**ï¼šå®Œå–„è½¬å‘çŠ¶æ€æ˜¾ç¤ºï¼ŒåŒ…å«å†å²è½¬å‘è®°å½•
  - æ–°å¢ `_get_forwarded_message_count` æ–¹æ³•ï¼Œä»å†å²ç®¡ç†å™¨è·å–å·²è½¬å‘æ¶ˆæ¯æ•°é‡
  - ä¿®æ”¹çŠ¶æ€è¡¨æ ¼åˆå§‹åŒ–é€»è¾‘ï¼Œæ˜¾ç¤ºå†å²è®°å½•ä¸­çš„å·²è½¬å‘æ¶ˆæ¯æ•°è€Œä¸æ˜¯ä»0å¼€å§‹
  - åœ¨è½¬å‘å¼€å§‹å‰ç»Ÿè®¡å†å²è®°å½•ï¼Œç¡®ä¿ç”¨æˆ·çœ‹åˆ°å‡†ç¡®çš„è½¬å‘è¿›åº¦
  - å®ç°æ™ºèƒ½è®¡æ•°ç´¯åŠ ï¼šæ€»è®¡æ•° = å†å²è®°å½• + å½“å‰ä¼šè¯å¢é‡
  - æ”¯æŒæŒ‡å®šæ¶ˆæ¯IDèŒƒå›´å†…çš„å†å²è®°å½•ç»Ÿè®¡ï¼Œä¸è½¬å‘é…ç½®ä¿æŒä¸€è‡´
  - ç¨‹åºå¯åŠ¨åçŠ¶æ€è¡¨æ ¼æ­£ç¡®æ˜¾ç¤º"48/60"è€Œä¸æ˜¯"0/60"

### æŠ€æœ¯æ”¹è¿›
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ–°å¢ `forwarded_message_counts` å­—æ®µä¸“é—¨å­˜å‚¨å†å²è®°å½•æ•°æ®
- **å¼‚æ­¥ä¼˜åŒ–**ï¼šåœ¨è½¬å‘å¯åŠ¨å‰å¼‚æ­¥ç»Ÿè®¡å†å²è®°å½•ï¼Œä¸é˜»å¡UIå“åº”
- **ç²¾ç¡®åŒ¹é…**ï¼šæ ¹æ®é…ç½®çš„èµ·å§‹IDå’Œç»“æŸIDèŒƒå›´ï¼Œç²¾ç¡®ç»Ÿè®¡èŒƒå›´å†…çš„å·²è½¬å‘æ¶ˆæ¯
- **æ™ºèƒ½æ˜¾ç¤º**ï¼šç»“åˆæ€»æ¶ˆæ¯æ•°å’Œå·²è½¬å‘æ¶ˆæ¯æ•°ï¼Œæä¾›å®Œæ•´çš„è½¬å‘è¿›åº¦ä¿¡æ¯

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… **çœŸå®è¿›åº¦åé¦ˆ**ï¼šæ˜¾ç¤ºåŒ…å«å†å²è®°å½•çš„çœŸå®è½¬å‘è¿›åº¦ï¼Œè€Œä¸æ˜¯ä»0å¼€å§‹
- âœ… **çŠ¶æ€æŒç»­æ€§**ï¼šç¨‹åºé‡å¯åä»èƒ½æ­£ç¡®æ˜¾ç¤ºä¹‹å‰çš„è½¬å‘è¿›åº¦
- âœ… **èŒƒå›´ç²¾ç¡®æ€§**ï¼šåªç»Ÿè®¡é…ç½®èŒƒå›´å†…çš„å·²è½¬å‘æ¶ˆæ¯ï¼Œé¿å…ä¸ç›¸å…³çš„å†å²æ•°æ®å¹²æ‰°
- âœ… **å³æ—¶æ›´æ–°**ï¼šè½¬å‘å¼€å§‹å‰è‡ªåŠ¨åˆ·æ–°å†å²ç»Ÿè®¡ï¼Œç¡®ä¿æ•°æ®æœ€æ–°

## [v2.2.11] - 2025-07-02

### é‡å¤§ä¿®å¤
- **é¢‘é“IDæ˜ å°„å»ºç«‹æ—¶æœºä¿®å¤**ï¼šå½»åº•è§£å†³äº†å®æ—¶è½¬å‘è®¡æ•°åŠŸèƒ½
  - ä¿®æ”¹é¢‘é“IDæ˜ å°„å»ºç«‹çš„æ—¶æœºï¼Œä»çŠ¶æ€è¡¨æ ¼æ›´æ–°æ—¶æ”¹ä¸ºè½¬å‘å¼€å§‹æ—¶
  - åœ¨ `_async_start_forward` æ–¹æ³•ä¸­æ·»åŠ äº† `_build_channel_id_mapping` è°ƒç”¨
  - å®ç°äº†æ­£ç¡®çš„å¼‚æ­¥é¢‘é“IDè·å–ï¼Œä½¿ç”¨ `channel_resolver.get_channel_id` æ–¹æ³•
  - ç¡®ä¿åœ¨è½¬å‘å¼€å§‹å‰ï¼Œæ‰€æœ‰ç›®æ ‡é¢‘é“çš„IDéƒ½å·²æ­£ç¡®æ˜ å°„åˆ°çŠ¶æ€è¡¨æ ¼è¡Œ
  - å®æ—¶è½¬å‘è¿›åº¦è®¡æ•°ç°åœ¨èƒ½å¤Ÿ100%å‡†ç¡®æ›´æ–°ï¼Œä¸å†æ˜¾ç¤ºä¸º0

### æŠ€æœ¯æ”¹è¿›
- **ç®€åŒ–å¼‚æ­¥è°ƒç”¨**ï¼šç§»é™¤äº†å¤æ‚çš„åŒæ­¥/å¼‚æ­¥åŒ…è£…å™¨ï¼Œé‡‡ç”¨æ›´ç›´æ¥çš„æ–¹æ³•
- **æ˜ å°„æ—¶æœºä¼˜åŒ–**ï¼šåœ¨è½¬å‘å¼€å§‹æ—¶ä¸€æ¬¡æ€§å»ºç«‹æ‰€æœ‰é¢‘é“IDæ˜ å°„ï¼Œé¿å…ç«æ€æ¡ä»¶
- **é”™è¯¯å¤„ç†å¢å¼º**ï¼šå®Œå–„äº†é¢‘é“IDè·å–å¤±è´¥æ—¶çš„å¤„ç†é€»è¾‘
- **è°ƒè¯•ä¿¡æ¯å®Œå–„**ï¼šæ·»åŠ äº†è¯¦ç»†çš„é¢‘é“IDæ˜ å°„å»ºç«‹è¿‡ç¨‹æ—¥å¿—

### ä¿®å¤æ•ˆæœ
- âœ… çŠ¶æ€è¡¨æ ¼çš„"å·²è½¬å‘æ¶ˆæ¯æ•°"èƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºæ­£ç¡®çš„è½¬å‘è¿›åº¦
- âœ… æ”¯æŒå•æ¡æ¶ˆæ¯è½¬å‘å’Œåª’ä½“ç»„è½¬å‘çš„å‡†ç¡®è®¡æ•°
- âœ… é¢‘é“IDå’ŒçŠ¶æ€è¡¨æ ¼è¡Œçš„ç²¾ç¡®åŒ¹é…ï¼Œæ— è®ºé¢‘é“åç§°å¦‚ä½•å˜åŒ–
- âœ… å®Œæ•´çš„äº‹ä»¶ä¼ é€’é“¾ï¼šDirectForwarder â†’ Forwarder â†’ App â†’ UI â†’ çŠ¶æ€è¡¨æ ¼æ›´æ–°

## [v2.2.10] - 2025-07-02

### é‡å¤§ä¿®å¤
- **ä¿¡å·æ•°æ®ç±»å‹ä¿®å¤**ï¼šå½»åº•è§£å†³äº†Qtä¿¡å·æ§½è¿æ¥å¤±è´¥å’Œ64ä½æ•´æ•°æº¢å‡ºé—®é¢˜
  - ä¿®æ”¹ `TGManagerApp.media_group_forwarded` ä¿¡å·å®šä¹‰ï¼Œå°†é¢‘é“IDå‚æ•°ä»intæ”¹ä¸ºstrç±»å‹
  - æ›´æ–° `Forwarder._emit_event` æ–¹æ³•ï¼Œå°†é¢‘é“IDè½¬æ¢ä¸ºå­—ç¬¦ä¸²å‘å°„ç»™ä¿¡å·
  - ä¿®æ”¹ `ForwardView` ä¸­çš„ä¿¡å·å¤„ç†æ–¹æ³•ï¼Œæ¥æ”¶å­—ç¬¦ä¸²ç±»å‹çš„é¢‘é“IDå¹¶è½¬æ¢ä¸ºæ•´æ•°ä½¿ç”¨
  - è§£å†³äº†"AttributeError: Slot not found"å’Œ"RuntimeWarning: Overflow"é”™è¯¯
  - å®æ—¶è½¬å‘è¿›åº¦è®¡æ•°ç°åœ¨èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œä¸å†æ˜¾ç¤ºä¸º0

### æŠ€æœ¯ç»†èŠ‚
- **64ä½æ•´æ•°å…¼å®¹æ€§**ï¼šQt Signalçš„intç±»å‹åªæ”¯æŒ32ä½ï¼ŒTelegramé¢‘é“IDæ˜¯64ä½éœ€è¦ä½¿ç”¨strç±»å‹ä¼ é€’
- **å‘åå…¼å®¹æ€§**ï¼šä¿æŒæ‰€æœ‰ç°æœ‰è½¬å‘åŠŸèƒ½å®Œå…¨ä¸å—å½±å“
- **é”™è¯¯å¤„ç†ä¼˜åŒ–**ï¼šå®Œå–„äº†å¼‚å¸¸å¤„ç†å’Œç±»å‹è½¬æ¢é€»è¾‘
- **è°ƒè¯•ä¿¡æ¯æ”¹è¿›**ï¼šæ·»åŠ äº†æ›´è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥

## [v2.2.9] - 2025-07-02

### é‡å¤§ä¿®å¤
- **é¢‘é“IDç²¾ç¡®åŒ¹é…**ï¼šå½»åº•è§£å†³äº†å®æ—¶è½¬å‘è®¡æ•°æ— æ³•æ›´æ–°çš„é—®é¢˜
  - ä¿®æ”¹ `DirectForwarder` äº‹ä»¶å‘å°„æœºåˆ¶ï¼ŒåŒæ—¶ä¼ é€’é¢‘é“IDå‚æ•°
  - æ›´æ–° `TGManagerApp` çš„ `media_group_forwarded` ä¿¡å·å®šä¹‰ï¼Œæ”¯æŒé¢‘é“IDå‚æ•°
  - åœ¨ `ForwardView` ä¸­å®ç°åŸºäºé¢‘é“IDçš„ç²¾ç¡®åŒ¹é…æœºåˆ¶ï¼Œé¿å…åç§°åŒ¹é…çš„ä¸ç¡®å®šæ€§
  - åœ¨çŠ¶æ€è¡¨æ ¼æ›´æ–°æ—¶å»ºç«‹é¢‘é“IDåˆ°è¡¨æ ¼è¡Œçš„æ˜ å°„å…³ç³»
  - å®ç°äº†å®Œæ•´çš„äº‹ä»¶ä¼ é€’é“¾ï¼šDirectForwarder â†’ Forwarder â†’ App â†’ UI
  - å®æ—¶è½¬å‘è¿›åº¦è®¡æ•°ç°åœ¨èƒ½å¤Ÿ100%å‡†ç¡®å·¥ä½œ

### æŠ€æœ¯æ”¹è¿›
- **äº‹ä»¶å‚æ•°å‡çº§**ï¼šæ‰€æœ‰åª’ä½“ç»„è½¬å‘äº‹ä»¶ç°åœ¨åŒ…å«4ä¸ªå‚æ•°ï¼ˆæ¶ˆæ¯IDåˆ—è¡¨ã€ç›®æ ‡ä¿¡æ¯ã€æ•°é‡ã€é¢‘é“IDï¼‰
- **ç²¾ç¡®åŒ¹é…ç­–ç•¥**ï¼šä¼˜å…ˆä½¿ç”¨é¢‘é“IDåŒ¹é…ï¼Œå¤±è´¥æ—¶å›é€€åˆ°åç§°åŒ¹é…
- **å‘åå…¼å®¹**ï¼šä¿æŒå¯¹ç°æœ‰è½¬å‘åŠŸèƒ½çš„å®Œå…¨å…¼å®¹
- **é”™è¯¯å¤„ç†å¢å¼º**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œè¯¦ç»†çš„è°ƒè¯•æ—¥å¿—

## [v2.2.8] - 2025-07-02

### ä¿®å¤
- **è½¬å‘è®¡æ•°æ™ºèƒ½åŒ¹é…**ï¼šä¿®å¤äº†å®æ—¶è½¬å‘è®¡æ•°æ— æ³•æ›´æ–°çš„é—®é¢˜
  - åœ¨ `_increment_forwarded_count_for_target` æ–¹æ³•ä¸­æ·»åŠ äº†æ™ºèƒ½é¢‘é“åç§°åŒ¹é…é€»è¾‘
  - æ”¯æŒæ˜¾ç¤ºåç§°åˆ°é¢‘é“æ ‡è¯†ç¬¦çš„æ¨¡ç³ŠåŒ¹é…ï¼ˆç§»é™¤@ç¬¦å·ã€åŒ…å«å…³ç³»åŒ¹é…ç­‰ï¼‰
  - è§£å†³äº†çŠ¶æ€è¡¨æ ¼æ˜¾ç¤ºé¢‘é“æ ‡è¯†ç¬¦è€Œè½¬å‘äº‹ä»¶ä½¿ç”¨æ˜¾ç¤ºåç§°å¯¼è‡´çš„åŒ¹é…å¤±è´¥é—®é¢˜
  - æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥åŒ¹é…é—®é¢˜
  - å®æ—¶è½¬å‘è¿›åº¦è®¡æ•°ç°åœ¨å¯ä»¥æ­£ç¡®æ˜¾ç¤ºå’Œæ›´æ–°

## [v2.2.7] - 2025-07-01

### ä¿®å¤
- **è½¬å‘äº‹ä»¶å‘å°„æœºåˆ¶ä¿®å¤**ï¼šä¿®å¤äº†DirectForwarderäº‹ä»¶å‘å°„æ—¶åº”ç”¨å¯¹è±¡ç¼ºå°‘ä¿¡å·å±æ€§çš„é”™è¯¯
  - åœ¨ `TGManagerApp` ç±»ä¸­æ·»åŠ äº† `message_forwarded` å’Œ `media_group_forwarded` ä¿¡å·å®šä¹‰
  - åœ¨ `ForwardView` ç±»ä¸­æ·»åŠ äº† `_connect_app_signals` æ–¹æ³•è¿æ¥åº”ç”¨çº§åˆ«çš„ä¿¡å·
  - è§£å†³äº†"'TGManagerApp' object has no attribute 'media_group_forwarded'"é”™è¯¯
  - å®æ—¶è½¬å‘è¿›åº¦æ›´æ–°ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œ

## [v2.2.6] - 2025-01-01

### ğŸ› é—®é¢˜ä¿®å¤ (Bug Fix)

#### ä¿®å¤è½¬å‘è¿‡ç¨‹ä¸­å·²è½¬å‘æ¶ˆæ¯æ•°å®æ—¶æ›´æ–°é—®é¢˜ (Fixed Real-time Forwarded Message Count Update)

**é—®é¢˜æè¿°**ï¼š
- âŒ **é”™è¯¯è¡Œä¸º**ï¼šè½¬å‘è¿‡ç¨‹ä¸­"å·²è½¬å‘æ¶ˆæ¯æ•°"ä¸€ç›´æ˜¾ç¤ºä¸º0ï¼Œä¸èƒ½å®æ—¶å¢åŠ 
- âŒ **æ ¹æœ¬åŸå› **ï¼šè½¬å‘å™¨åœ¨è½¬å‘æˆåŠŸæ—¶æ²¡æœ‰å‘é€å®æ—¶æ›´æ–°ä¿¡å·ç»™UIç•Œé¢

**ä¿®å¤å†…å®¹**ï¼š

##### 1. **è½¬å‘å™¨äº‹ä»¶å‘å°„æœºåˆ¶** (Forwarder Event Emission)
- **DirectForwarderæ”¹è¿›**ï¼š
  ```python
  # æ·»åŠ emitå‚æ•°æ”¯æŒäº‹ä»¶å‘å°„
  def __init__(self, client, history_manager, general_config, emit=None):
      self.emit = emit  # äº‹ä»¶å‘å°„å‡½æ•°
  
  # åœ¨è½¬å‘æˆåŠŸæ—¶å‘å°„ä¿¡å·
  if self.emit:
      self.emit("message_forwarded", message_id, target_info)
      self.emit("media_group_forwarded", message_ids, target_info, count)
  ```

- **Forwarderç±»é›†æˆ**ï¼š
  ```python
  # ä¼ é€’emitæ–¹æ³•ç»™DirectForwarder
  self.direct_forwarder = DirectForwarder(client, history_manager, self.general_config, self._emit_event)
  
  # å¤„ç†äº‹ä»¶å¹¶è½¬å‘ç»™UI
  def _emit_event(self, event_type, *args):
      if event_type == "message_forwarded":
          self.app.message_forwarded.emit(message_id, target_info)
  ```

##### 2. **UIå®æ—¶çŠ¶æ€æ›´æ–°** (UI Real-time Status Update)
- **ä¿¡å·è¿æ¥æœºåˆ¶**ï¼š
  ```python
  # è¿æ¥å®æ—¶è½¬å‘è¿›åº¦ä¿¡å·
  if hasattr(self.forwarder, 'message_forwarded'):
      self.forwarder.message_forwarded.connect(self._on_message_forwarded)
  if hasattr(self.forwarder, 'media_group_forwarded'):
      self.forwarder.media_group_forwarded.connect(self._on_media_group_forwarded)
  ```

- **æ™ºèƒ½è®¡æ•°æ›´æ–°**ï¼š
  ```python
  def _increment_forwarded_count_for_target(self, target_channel, increment=1):
      # æŸ¥æ‰¾åŒ¹é…çš„çŠ¶æ€è¡¨æ ¼è¡Œå¹¶å®æ—¶æ›´æ–°è®¡æ•°
      new_count = current_count + increment
      self.update_forward_status(source_channel, target_channel, new_count, "è½¬å‘ä¸­")
  ```

##### 3. **å¤šç§è½¬å‘æ–¹å¼æ”¯æŒ** (Multiple Forward Method Support)
- âœ… **å•æ¡æ¶ˆæ¯è½¬å‘**ï¼šæ¯è½¬å‘ä¸€æ¡æ¶ˆæ¯ï¼Œè®¡æ•°+1
- âœ… **åª’ä½“ç»„è½¬å‘**ï¼šæŒ‰åª’ä½“ç»„ä¸­çš„æ¶ˆæ¯æ•°é‡å¢åŠ è®¡æ•°
- âœ… **é‡ç»„åª’ä½“ç»„è½¬å‘**ï¼šæ”¯æŒå¤æ‚åª’ä½“ç»„é‡ç»„åœºæ™¯
- âœ… **ä¸åŒè½¬å‘æ¨¡å¼**ï¼šcopy_media_groupã€forward_messagesã€send_media_groupç­‰

**ç”¨æˆ·ä½“éªŒæ”¹è¿›**ï¼š
- ğŸ“Š **å®æ—¶è¿›åº¦åé¦ˆ**ï¼šè½¬å‘è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°"å·²è½¬å‘æ¶ˆæ¯æ•°"å®æ—¶å¢åŠ 
- ğŸ¯ **ç²¾ç¡®è®¡æ•°**ï¼šæ¯è½¬å‘ä¸€æ¡æ¶ˆæ¯æˆ–åª’ä½“ç»„ï¼Œç«‹å³æ›´æ–°å¯¹åº”ç›®æ ‡é¢‘é“çš„è®¡æ•°
- ğŸ” **çŠ¶æ€åŒæ­¥**ï¼šUIçŠ¶æ€è¡¨æ ¼ä¸å®é™…è½¬å‘è¿›åº¦å®Œå…¨åŒæ­¥
- âš¡ **å“åº”è¿…é€Ÿ**ï¼šè½¬å‘æˆåŠŸåç«‹å³æ›´æ–°UIï¼Œæ— éœ€ç­‰å¾…æ•´ä¸ªè½¬å‘è¿‡ç¨‹å®Œæˆ

**å½±å“æ–‡ä»¶**ï¼š
- `src/modules/forward/direct_forwarder.py`: æ·»åŠ äº‹ä»¶å‘å°„æœºåˆ¶
- `src/modules/forward/forwarder.py`: é›†æˆäº‹ä»¶å¤„ç†å’Œè½¬å‘
- `src/ui/views/forward_view.py`: å®ç°å®æ—¶UIæ›´æ–°é€»è¾‘

---

## [v2.2.5] - 2025-01-01

### ğŸ› é—®é¢˜ä¿®å¤ (Bug Fix)

#### ä¿®å¤è½¬å‘çŠ¶æ€è¡¨æ ¼æ€»æ¶ˆæ¯æ•°è®¡ç®—é”™è¯¯ (Fixed Forward Status Table Total Message Count Calculation)

**é—®é¢˜æè¿°**ï¼š
- âŒ **é”™è¯¯è¡Œä¸º**ï¼šå½“ç»“æŸIDè®¾ç½®ä¸º0ï¼ˆè¡¨ç¤º"æœ€æ–°æ¶ˆæ¯"ï¼‰æ—¶ï¼Œæ€»æ¶ˆæ¯æ•°å›ºå®šæ˜¾ç¤ºä¸º50
- âŒ **æ ¹æœ¬åŸå› **ï¼š`_calculate_total_message_count()` æ–¹æ³•ä½¿ç”¨ç¡¬ç¼–ç çš„é»˜è®¤å€¼50

**ä¿®å¤å†…å®¹**ï¼š
- **æ­£ç¡®è®¡ç®—é€»è¾‘**ï¼š
  ```python
  # ä¿®å¤å‰çš„é”™è¯¯é€»è¾‘
  elif start_id > 0:
      return 50  # å›ºå®šè¿”å›50 âŒ
  
  # ä¿®å¤åçš„æ­£ç¡®é€»è¾‘
  elif start_id == 0 and end_id > 0:
      return max(0, end_id - 1 + 1)  # ä»æ¶ˆæ¯ID 1å¼€å§‹è®¡ç®— âœ…
  elif start_id > 0 and end_id == 0:
      return -1  # è¿”å›-1è¡¨ç¤ºæœªçŸ¥ï¼Œæ˜¾ç¤ºä¸º"--" âœ…
  ```

- **æ¶ˆæ¯æ•°æ˜¾ç¤ºä¼˜åŒ–**ï¼š
  - âœ… **å‡†ç¡®è®¡ç®—**ï¼šå½“èµ·å§‹IDå’Œç»“æŸIDéƒ½æœ‰å€¼æ—¶ï¼Œæ­£ç¡®è®¡ç®— `end_id - start_id + 1`
  - âœ… **æ™ºèƒ½å¤„ç†**ï¼šèµ·å§‹IDä¸º0æ—¶ï¼Œå‡è®¾ä»æ¶ˆæ¯ID 1å¼€å§‹è®¡ç®—
  - âœ… **æœªçŸ¥çŠ¶æ€**ï¼šç»“æŸIDä¸º0ï¼ˆæœ€æ–°æ¶ˆæ¯ï¼‰æ—¶ï¼Œæ˜¾ç¤º `å·²è½¬å‘æ•°/--` è€Œé `å·²è½¬å‘æ•°/50`
  - âœ… **è¾¹ç•Œæƒ…å†µ**ï¼šä¸¤ä¸ªIDéƒ½ä¸º0æˆ–æ— æ•ˆæ—¶ï¼Œæ­£ç¡®å¤„ç†ä¸ºæœªçŸ¥çŠ¶æ€

**ç”¨æˆ·ä½“éªŒæ”¹è¿›**ï¼š
- ğŸ“Š **çŠ¶æ€è¡¨æ ¼æ›´å‡†ç¡®**ï¼šæ€»æ¶ˆæ¯æ•°ä¸å†æ˜¾ç¤ºè¯¯å¯¼æ€§çš„å›ºå®šå€¼50
- ğŸ¯ **èŒƒå›´è®¡ç®—æ­£ç¡®**ï¼šIDèŒƒå›´1000-1010å°†æ­£ç¡®æ˜¾ç¤ºæ€»æ•°11ï¼Œè€Œé50
- ğŸ” **æœªçŸ¥çŠ¶æ€æ¸…æ™°**ï¼šæ— æ³•ç¡®å®šæ€»æ•°æ—¶æ˜¾ç¤º"--"ï¼Œç”¨æˆ·ä¸€ç›®äº†ç„¶

**å½±å“æ–‡ä»¶**ï¼š
- `src/ui/views/forward_view.py`: ä¿®å¤æ€»æ¶ˆæ¯æ•°è®¡ç®—é€»è¾‘

---

## [v2.2.4] - 2025-01-01

### ğŸš€ åŠŸèƒ½å¢å¼º (Feature Enhancement)

#### å®Œå–„è½¬å‘è¿›åº¦çŠ¶æ€è¡¨æ ¼ (Enhanced Forward Progress Status Table)

**ä¸»è¦æ”¹è¿›**ï¼š
- **åŠ¨æ€æ˜¾ç¤ºå·²å¯ç”¨é¢‘é“å¯¹**ï¼šçŠ¶æ€è¡¨æ ¼æ ¹æ®å½“å‰å·²é…ç½®ä¸”å·²å¯ç”¨çš„é¢‘é“å¯¹åŠ¨æ€æ›´æ–°æ˜¾ç¤º
- **å¤šç›®æ ‡é¢‘é“æ”¯æŒ**ï¼š
  - 1ä¸ªæºé¢‘é“å¯¹åº”å¤šä¸ªç›®æ ‡é¢‘é“æ—¶ï¼Œæ¯ä¸ªç›®æ ‡é¢‘é“å•ç‹¬æ˜¾ç¤ºä¸€è¡Œ
  - ç¤ºä¾‹ï¼šæºé¢‘é“Aå¯¹åº”ç›®æ ‡é¢‘é“Bå’ŒCï¼Œæ˜¾ç¤ºä¸ºä¸¤è¡Œæ•°æ®
- **æ¶ˆæ¯æ•°æ˜¾ç¤ºä¼˜åŒ–**ï¼šæ ¼å¼ä¸º"å·²è½¬å‘æ¶ˆæ¯æ•°/æ€»æ¶ˆæ¯æ•°"
  - æ€»æ¶ˆæ¯æ•°åœ¨ä¿å­˜é…ç½®æ—¶æ ¹æ®IDèŒƒå›´è‡ªåŠ¨è®¡ç®—
  - è½¬å‘æ—¶å®æ—¶æ›´æ–°å·²è½¬å‘æ¶ˆæ¯æ•°
- **è½¬å‘çŠ¶æ€å®æ—¶è·Ÿè¸ª**ï¼š
  - å¾…è½¬å‘ï¼šæœªå¼€å§‹è½¬å‘æ—¶æ˜¾ç¤º
  - è½¬å‘ä¸­ï¼šæ­£åœ¨è½¬å‘è¿‡ç¨‹ä¸­
  - åœæ­¢ä¸­ï¼šç”¨æˆ·æ‰‹åŠ¨åœæ­¢è½¬å‘æ—¶
  - å·²å®Œæˆï¼šè½¬å‘æˆåŠŸå®Œæˆ
  - å‡ºé”™ï¼šè½¬å‘è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯

**æŠ€æœ¯å®ç°**ï¼š
- **æ•°æ®ç»“æ„ä¼˜åŒ–**ï¼š
  ```python
  self.status_table_data = {}  # å­˜å‚¨æ¯è¡Œçš„çŠ¶æ€æ•°æ®
  self.total_message_counts = {}  # å­˜å‚¨æ¯ä¸ªé¢‘é“å¯¹çš„æ€»æ¶ˆæ¯æ•°
  self.forwarding_status = False  # å½“å‰è½¬å‘çŠ¶æ€
  ```
- **æ™ºèƒ½çŠ¶æ€è¡¨æ ¼æ›´æ–°**ï¼š
  - æ·»åŠ é¢‘é“å¯¹æ—¶è‡ªåŠ¨æ›´æ–°è¡¨æ ¼
  - åˆ é™¤é¢‘é“å¯¹æ—¶è‡ªåŠ¨æ›´æ–°è¡¨æ ¼
  - å¯ç”¨/ç¦ç”¨é¢‘é“å¯¹æ—¶è‡ªåŠ¨æ›´æ–°è¡¨æ ¼
  - ä¿å­˜é…ç½®æ—¶é‡æ–°è®¡ç®—æ€»æ¶ˆæ¯æ•°å¹¶æ›´æ–°è¡¨æ ¼
- **è½¬å‘çŠ¶æ€åŒæ­¥**ï¼š
  - `_start_forward()`: æ›´æ–°çŠ¶æ€ä¸º"è½¬å‘ä¸­"
  - `_stop_forward()`: æ›´æ–°çŠ¶æ€ä¸º"åœæ­¢ä¸­"
  - `_on_forward_complete_ui_update()`: æ›´æ–°çŠ¶æ€ä¸º"å·²å®Œæˆ"
  - `_on_forward_error_ui_update()`: æ›´æ–°çŠ¶æ€ä¸º"å‡ºé”™"

**ç”¨æˆ·ä½“éªŒæå‡**ï¼š
- âœ… **é…ç½®å³æ—¶åé¦ˆ**ï¼šä¿å­˜é…ç½®åç«‹å³çœ‹åˆ°çŠ¶æ€è¡¨æ ¼æ›´æ–°
- âœ… **å¤šç›®æ ‡æ”¯æŒ**ï¼šæ¸…æ™°æ˜¾ç¤ºæ¯ä¸ªè½¬å‘ç›®æ ‡çš„ç‹¬ç«‹çŠ¶æ€
- âœ… **è¿›åº¦å¯è§†åŒ–**ï¼šç›´è§‚äº†è§£æ¯ä¸ªè½¬å‘ä»»åŠ¡çš„è¿›åº¦å’ŒçŠ¶æ€
- âœ… **çŠ¶æ€åŒæ­¥**ï¼šè½¬å‘çŠ¶æ€ä¸å®é™…æ“ä½œå®Œå…¨åŒæ­¥

**å½±å“æ–‡ä»¶**ï¼š
- `src/ui/views/forward_view.py`: çŠ¶æ€è¡¨æ ¼å®Œå–„å®ç°

---

## [v2.2.3] - 2025-01-01

### ğŸ¨ ç•Œé¢ä¼˜åŒ– (UI Optimization)

#### ç®€åŒ–è½¬å‘è¿›åº¦é€‰é¡¹å¡ç•Œé¢ (Simplified Forward Progress Tab UI)

**ä¿®æ”¹å†…å®¹**ï¼š
- **ä¿ç•™æ ¸å¿ƒåŠŸèƒ½**ï¼šåªä¿ç•™çŠ¶æ€è¡¨æ ¼ (QTableWidget)ï¼Œæ˜¾ç¤ºå„é¢‘é“å¯¹çš„è½¬å‘è¯¦æƒ…
- **ç§»é™¤å†—ä½™UIå…ƒç´ **ï¼š
  - âŒ åˆ é™¤æ€»ä½“çŠ¶æ€æ ‡ç­¾ (`overall_status_label`)  
  - âŒ åˆ é™¤å·²è½¬å‘æ¶ˆæ¯æ•°æ ‡ç­¾ (`forwarded_count_label`)
  - âŒ åˆ é™¤è¿›åº¦æ¡ (`progress_bar`) å’Œè¿›åº¦æ ‡ç­¾ (`progress_label`)

**æŠ€æœ¯å®ç°**ï¼š
- **ç•Œé¢ç®€åŒ–**ï¼šä¿®æ”¹ `_create_forward_panel()` æ–¹æ³•ï¼Œåªä¿ç•™çŠ¶æ€è¡¨æ ¼ä¸€ä¸ªUIå…ƒç´ 
- **çŠ¶æ€åé¦ˆä¼˜åŒ–**ï¼šå°†åŸæœ¬åœ¨UIæ ‡ç­¾ä¸­æ˜¾ç¤ºçš„çŠ¶æ€ä¿¡æ¯æ”¹ä¸ºæ—¥å¿—è¾“å‡ºï¼Œä½¿ç”¨ `logger.info()` è®°å½•
- **å…¼å®¹æ€§ä¿è¯**ï¼šä¿®æ”¹æ‰€æœ‰å¼•ç”¨è¢«åˆ é™¤UIå…ƒç´ çš„æ–¹æ³•ï¼Œç¡®ä¿è½¬å‘åŠŸèƒ½å®Œå…¨ä¸å—å½±å“
- **é”™è¯¯å¤„ç†å¢å¼º**ï¼šä¿æŒå¯¹è¯æ¡†æç¤ºåŠŸèƒ½ï¼Œå…³é”®ä¿¡æ¯ä»é€šè¿‡ `QMessageBox` æä¾›ç”¨æˆ·åé¦ˆ

**ç”¨æˆ·ä½“éªŒæ”¹è¿›**ï¼š
- âœ… **ç•Œé¢æ›´ç®€æ´**ï¼šè½¬å‘è¿›åº¦é€‰é¡¹å¡èšç„¦äºæœ€é‡è¦çš„çŠ¶æ€è¡¨æ ¼ä¿¡æ¯
- âœ… **åŠŸèƒ½ä¸å—å½±å“**ï¼šè½¬å‘é€»è¾‘ã€çŠ¶æ€æ›´æ–°ã€é”™è¯¯å¤„ç†ç­‰æ ¸å¿ƒåŠŸèƒ½å®Œå…¨ä¿æŒ
- âœ… **ä¿¡æ¯è·å–ä¾¿åˆ©**ï¼šçŠ¶æ€ä¿¡æ¯é€šè¿‡æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥
- âœ… **èµ„æºå ç”¨æ›´å°‘**ï¼šå‡å°‘ä¸å¿…è¦çš„UIå…ƒç´ æ›´æ–°å¼€é”€

**å½±å“æ–‡ä»¶**ï¼š
- `src/ui/views/forward_view.py`: è½¬å‘ç•Œé¢UIç®€åŒ–å®ç°

---

## [v2.2.2] - 2025-01-01

### ğŸ“š å¼€å‘æŒ‡å—æ›´æ–° (Development Guide Update)

#### æ·»åŠ æ–°é…ç½®å­—æ®µçš„å®Œæ•´æµç¨‹æŒ‡å— (Complete Guide for Adding New Configuration Fields)

**èƒŒæ™¯**ï¼šåœ¨å®ç°ç½‘é¡µé¢„è§ˆé…ç½®åŠŸèƒ½è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†é…ç½®å­—æ®µæ·»åŠ çš„å…³é”®é—æ¼ç‚¹ï¼Œä¸ºé¿å…åç»­å¼€å‘ä¸­å‡ºç°ç±»ä¼¼é—®é¢˜ï¼Œç‰¹åˆ¶å®šæ­¤å¼€å‘æŒ‡å—ã€‚

##### ğŸ¯ å®Œæ•´å¼€å‘æµç¨‹ (Complete Development Process)

**ç¬¬1æ­¥ï¼šUIæ¨¡å‹å®šä¹‰** âœ…
```python
# åœ¨ src/utils/ui_config_models.py ä¸­å®šä¹‰å­—æ®µ
class UIChannelPair(BaseModel):
    enable_web_page_preview: bool = Field(False, description="æ˜¯å¦å¯ç”¨æœ€ç»ˆæ¶ˆæ¯çš„ç½‘é¡µé¢„è§ˆ")
```

**ç¬¬2æ­¥ï¼šç•Œé¢æ§ä»¶æ·»åŠ ** âœ…
```python
# åœ¨ç›¸å…³UIè§†å›¾ä¸­æ·»åŠ æ§ä»¶
self.enable_web_page_preview_check = QCheckBox("ç½‘é¡µé¢„è§ˆ")
```

**ç¬¬3æ­¥ï¼šé…ç½®è½¬æ¢å¤„ç†** âœ…
```python
# åœ¨ src/utils/config_utils.py çš„ filter_field åˆ—è¡¨ä¸­æ·»åŠ å­—æ®µ
filter_field = ["exclude_forwards", "exclude_replies", "exclude_text", "exclude_links", 
                "remove_captions", "hide_author", "send_final_message", "enabled", 
                "enable_web_page_preview"]  # æ–°å¢å­—æ®µ
```

**âš ï¸ ç¬¬4æ­¥ï¼šé…ç½®ç®¡ç†å™¨åŠ è½½å¤„ç†** âŒ **ã€æœ€å®¹æ˜“é—æ¼çš„å…³é”®æ­¥éª¤ã€‘**
```python
# åœ¨ src/utils/ui_config_manager.py ä¸­æ·»åŠ å­—æ®µå¤„ç†
valid_pair = {
    "source_channel": source_channel,
    "target_channels": valid_targets,
    # ... å…¶ä»–å­—æ®µ ...
    "enable_web_page_preview": pair.get("enable_web_page_preview", False)  # å¿…é¡»æ·»åŠ ï¼
}

# é»˜è®¤é…ç½®ä¸­ä¹Ÿè¦æ·»åŠ 
valid_pairs = [{
    "source_channel": "",
    "target_channels": [""],
    # ... å…¶ä»–å­—æ®µ ...
    "enable_web_page_preview": False  # å¿…é¡»æ·»åŠ ï¼
}]
```

**ç¬¬5æ­¥ï¼šåŠŸèƒ½é›†æˆä½¿ç”¨** âœ…
```python
# åœ¨å®é™…åŠŸèƒ½ä»£ç ä¸­ä½¿ç”¨å­—æ®µ
disable_web_page_preview=not pair.get('enable_web_page_preview', False)
```

##### âš ï¸ ç‰¹åˆ«æé†’ (Critical Reminders)

**ğŸš¨ é…ç½®ç®¡ç†å™¨æ˜¯æœ€å®¹æ˜“é—æ¼çš„ç¯èŠ‚ï¼**
- **ç—‡çŠ¶**ï¼šç•Œé¢æ­£å¸¸æ˜¾ç¤ºã€ä¿å­˜æˆåŠŸï¼Œä½†é‡å¯åé…ç½®ä¸¢å¤±æˆ–ä½¿ç”¨é»˜è®¤å€¼
- **åŸå› **ï¼šé…ç½®ç®¡ç†å™¨åœ¨åŠ è½½é…ç½®æ—¶å¿½ç•¥äº†æ–°å­—æ®µï¼Œåªèƒ½ä½¿ç”¨æ¨¡å‹é»˜è®¤å€¼
- **åæœ**ï¼šç”¨æˆ·è®¾ç½®çš„é…ç½®æ— æ³•ç”Ÿæ•ˆï¼ŒåŠŸèƒ½è¡¨ç°å¼‚å¸¸

**ğŸ” å¸¸è§é”™è¯¯æ¨¡å¼**ï¼š
1. âœ… åœ¨UIæ¨¡å‹ä¸­å®šä¹‰å­—æ®µ â†’ ç•Œé¢æ˜¾ç¤ºæ­£å¸¸
2. âœ… åœ¨ç•Œé¢ä¸­æ·»åŠ æ§ä»¶ â†’ ç”¨æˆ·å¯ä»¥æ“ä½œ
3. âœ… åœ¨é…ç½®è½¬æ¢ä¸­å¤„ç† â†’ ä¿å­˜åˆ°æ–‡ä»¶æˆåŠŸ
4. âŒ **å¿˜è®°åœ¨é…ç½®ç®¡ç†å™¨ä¸­å¤„ç†** â†’ åŠ è½½æ—¶å­—æ®µä¸¢å¤±
5. âœ… åœ¨åŠŸèƒ½ä»£ç ä¸­ä½¿ç”¨ â†’ åªèƒ½ä½¿ç”¨é»˜è®¤å€¼

**ğŸ› ï¸ æ£€æŸ¥æ¸…å• (Checklist)**ï¼š
- [ ] UIæ¨¡å‹å­—æ®µå®šä¹‰ (`src/utils/ui_config_models.py`)
- [ ] ç•Œé¢æ§ä»¶æ·»åŠ  (ç›¸å…³è§†å›¾æ–‡ä»¶)
- [ ] é…ç½®è½¬æ¢å¤„ç† (`src/utils/config_utils.py`)
- [ ] **é…ç½®ç®¡ç†å™¨åŠ è½½** (`src/utils/ui_config_manager.py`) **ã€å…³é”®ï¼ã€‘**
- [ ] åŠŸèƒ½é›†æˆä½¿ç”¨ (ä¸šåŠ¡é€»è¾‘ä»£ç )

**ğŸ’¡ éªŒè¯æ–¹æ³•**ï¼š
1. æ·»åŠ é…ç½®å­—æ®µå¹¶è®¾ç½®ä¸ºéé»˜è®¤å€¼
2. ä¿å­˜é…ç½®å¹¶é‡å¯ç¨‹åº
3. æ£€æŸ¥å­—æ®µæ˜¯å¦ä¿æŒéé»˜è®¤å€¼
4. å¦‚æœå˜å›é»˜è®¤å€¼ï¼Œæ£€æŸ¥é…ç½®ç®¡ç†å™¨æ˜¯å¦é—æ¼å¤„ç†

**ğŸ“ å¼€å‘å»ºè®®**ï¼š
- åœ¨æ·»åŠ æ–°å­—æ®µæ—¶ï¼Œä¼˜å…ˆå®ç°é…ç½®ç®¡ç†å™¨çš„å¤„ç†é€»è¾‘
- ä½¿ç”¨æœç´¢åŠŸèƒ½ç¡®ä¿æ‰€æœ‰ç›¸å…³æ–‡ä»¶éƒ½å·²æ›´æ–°
- è¿›è¡Œå®Œæ•´çš„ä¿å­˜-é‡å¯-éªŒè¯æµ‹è¯•æµç¨‹

##### ğŸ¯ æ­¤æ¬¡ä¿®å¤å†…å®¹ (Current Fix Details)

**é—®é¢˜**ï¼šç½‘é¡µé¢„è§ˆé…ç½®å­—æ®µ `enable_web_page_preview` åœ¨é…ç½®ç®¡ç†å™¨ä¸­è¢«é—æ¼
- âœ… UIæ¨¡å‹å·²å®šä¹‰ (`UIChannelPair.enable_web_page_preview`)
- âœ… ç•Œé¢æ§ä»¶å·²æ·»åŠ  (ä¸»ç•Œé¢å’Œç¼–è¾‘å¼¹çª—çš„å¤é€‰æ¡†)  
- âœ… é…ç½®è½¬æ¢å·²å¤„ç† (`config_utils.py` çš„ `filter_field` åˆ—è¡¨)
- âŒ **é…ç½®ç®¡ç†å™¨é—æ¼** (`ui_config_manager.py` ç¼ºå°‘å­—æ®µå¤„ç†)
- âœ… åŠŸèƒ½é›†æˆå·²å®Œæˆ (è½¬å‘å™¨ä¸­çš„APIè°ƒç”¨)

**ä¿®å¤**ï¼šåœ¨ `src/utils/ui_config_manager.py` çš„ä¸¤ä¸ªå…³é”®ä½ç½®æ·»åŠ å­—æ®µå¤„ç†
1. ä¸»è¦é¢‘é“å¯¹é…ç½®å¤„ç† (ç¬¬255-269è¡Œ)
2. é»˜è®¤é¢‘é“å¯¹é…ç½®å¤„ç† (ç¬¬322-334è¡Œ)

**ç»“æœ**ï¼šç½‘é¡µé¢„è§ˆé…ç½®ç°åœ¨èƒ½æ­£ç¡®ä¿å­˜ã€åŠ è½½å’Œä½¿ç”¨

---

## [v2.2.1] - 2024-12-30

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix)

#### ä¿®å¤ParallelProcessorä¸­æ–‡æœ¬æ›¿æ¢åŠŸèƒ½å¤±æ•ˆçš„BUG (Fix Text Replacement Function Failure in ParallelProcessor)
- **é—®é¢˜æ ¹æº**ï¼š
  - **å­—æ®µè·å–é”™è¯¯**ï¼šåœ¨`ParallelProcessor._producer_download_media_groups_parallel`æ–¹æ³•ä¸­ï¼Œé”™è¯¯åœ°ä»`text_filter`å­—æ®µè·å–æ–‡æœ¬æ›¿æ¢å­—å…¸
  - **æ•°æ®æ ¼å¼ä¸åŒ¹é…**ï¼š`text_filter`æ˜¯åˆ—è¡¨æ ¼å¼`[{'original_text': '...', 'target_text': '...'}]`ï¼Œè€Œä»£ç æœŸæœ›å­—å…¸æ ¼å¼`{'åŸæ–‡': 'æ›¿æ¢æ–‡æœ¬'}`
  - **åŠŸèƒ½å®Œå…¨å¤±æ•ˆ**ï¼šå¯¼è‡´æ–‡æœ¬æ›¿æ¢è§„åˆ™å®Œå…¨æ— æ³•ç”Ÿæ•ˆï¼Œç”¨æˆ·é…ç½®çš„æ–‡æœ¬æ›¿æ¢è¢«å¿½ç•¥

- **å‘ç°è¿‡ç¨‹**ï¼š
  - é€šè¿‡å®é™…è½¬å‘æ—¥å¿—åˆ†æå‘ç°ï¼šé…ç½®çš„"è«ä¸ƒä¸ƒ" â†’ "è«å…«å…«"æ›¿æ¢è§„åˆ™æœªç”Ÿæ•ˆ
  - æ—¥å¿—æ˜¾ç¤ºï¼š"ä½¿ç”¨é¢„æå–çš„åª’ä½“ç»„æ–‡æœ¬: '#åå…­å¤œ #è«ä¸ƒä¸ƒ   6.12-18è‡ªå½•...'"
  - æ–‡æœ¬ä¸­çš„"è«ä¸ƒä¸ƒ"æ²¡æœ‰è¢«æ›¿æ¢ä¸º"è«å…«å…«"ï¼Œè¡¨æ˜æ–‡æœ¬æ›¿æ¢é€»è¾‘å®Œå…¨å¤±æ•ˆ

- **ä¿®å¤å†…å®¹**ï¼š
  ```python
  # ä¿®å¤å‰ (âŒ é”™è¯¯ä»£ç )
  text_replacements = pair_config.get('text_filter', {})
  
  # ä¿®å¤å (âœ… æ­£ç¡®ä»£ç )  
  text_replacements = pair_config.get('text_replacements', {})
  ```

#### ä¿®å¤ParallelProcessorä¸­é‡å¤è¿‡æ»¤å¯¼è‡´å…³é”®è¯æ¶ˆæ¯ä¸¢å¤±çš„BUG (Fix Duplicate Filtering Causing Keyword Message Loss in ParallelProcessor)
- **é—®é¢˜æ ¹æº**ï¼š
  - **é‡å¤è¿‡æ»¤æ¶æ„ç¼ºé™·**ï¼šMediaGroupCollectorå’ŒParallelProcessoréƒ½åœ¨è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´é‡å¤å¤„ç†
  - **å…³é”®è¯æ–‡æœ¬ä¸¢å¤±**ï¼šåŒ…å«å…³é”®è¯çš„æ¶ˆæ¯åœ¨ç¬¬ä¸€æ¬¡è¿‡æ»¤åè¢«åª’ä½“ç±»å‹è¿‡æ»¤ç§»é™¤ï¼Œç¬¬äºŒæ¬¡è¿‡æ»¤æ—¶æ‰¾ä¸åˆ°å…³é”®è¯æ–‡æœ¬
  - **æ€§èƒ½æµªè´¹**ï¼šé‡å¤è¿‡æ»¤å¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€å’Œé€»è¾‘å¤æ‚æ€§

- **å‘ç°è¿‡ç¨‹**ï¼š
  - ç”¨æˆ·é…ç½®å…³é”®è¯"è«ä¸ƒä¸ƒ"ï¼Œåª’ä½“ç±»å‹æ’é™¤"video"
  - MediaGroupCollectorï¼šåª’ä½“ç»„é€šè¿‡å…³é”®è¯è¿‡æ»¤ï¼Œä½†è§†é¢‘æ¶ˆæ¯114246è¢«åª’ä½“ç±»å‹è¿‡æ»¤ç§»é™¤
  - ParallelProcessorï¼šå¯¹å‰©ä½™9æ¡æ¶ˆæ¯é‡æ–°è¿‡æ»¤ï¼Œæ²¡æœ‰"è«ä¸ƒä¸ƒ"æ–‡æœ¬ï¼Œæ•´ä¸ªåª’ä½“ç»„è¢«å…³é”®è¯è¿‡æ»¤æ‹’ç»
  - æ—¥å¿—è¯æ®ï¼š`å…³é”®è¯è¿‡æ»¤: 1 ä¸ªåª’ä½“ç»„(9 æ¡æ¶ˆæ¯)ä¸åŒ…å«å…³é”®è¯ ['è«ä¸ƒä¸ƒ'] è¢«è¿‡æ»¤`

- **ä¿®å¤ç­–ç•¥**ï¼š
  ```python
  # ä¿®å¤å‰ (âŒ é‡å¤è¿‡æ»¤)
  # MediaGroupCollector: apply_all_filters() -> è¿‡æ»¤åæ¶ˆæ¯
  # ParallelProcessor: apply_all_filters() -> å†æ¬¡è¿‡æ»¤ï¼
  
  # ä¿®å¤å (âœ… ç»Ÿä¸€è¿‡æ»¤ï¼Œé¿å…é‡å¤)
  # MediaGroupCollector: apply_all_filters() -> è¿‡æ»¤åæ¶ˆæ¯
  # ParallelProcessor: ç›´æ¥ä½¿ç”¨å·²è¿‡æ»¤æ¶ˆæ¯ï¼Œåªæå–æ–‡æœ¬ä¿¡æ¯
  ```

- **æŠ€æœ¯å®ç°**ï¼š
  - **ä¿ç•™MediaGroupCollectorè¿‡æ»¤**ï¼šæ€§èƒ½æœ€ä¼˜ï¼Œåœ¨æ•°æ®è·å–é˜¶æ®µå°±å®Œæˆè¿‡æ»¤
  - **ç§»é™¤ParallelProcessoré‡å¤è¿‡æ»¤**ï¼šæ”¹ä¸ºåªæå–åª’ä½“ç»„æ–‡æœ¬ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨å·²è¿‡æ»¤æ¶ˆæ¯
  - **ç»´æŒv2.2.0æ¶æ„ç›®æ ‡**ï¼šç¦æ­¢è½¬å‘é¢‘é“é€šè¿‡MediaGroupCollectorä½¿ç”¨ç»Ÿä¸€çš„`apply_all_filters`é€»è¾‘

#### ä¿®å¤ç¦æ­¢è½¬å‘é¢‘é“ä¸­åª’ä½“ç»„æ–‡æœ¬ä¸¢å¤±çš„BUG (Fix Media Group Text Loss in Restricted Channels)
- **é—®é¢˜æ ¹æº**ï¼š
  - **æ¶æ„è®¾è®¡ç¼ºé™·**ï¼šç¦æ­¢è½¬å‘é¢‘é“ä½¿ç”¨MediaGroupCollector + ParallelProcessoræ¶æ„ï¼Œä½†ç¼ºä¹æ–‡æœ¬ä¿¡æ¯ä¼ é€’æœºåˆ¶
  - **æ–‡æœ¬ä¼ é€’ä¸­æ–­**ï¼šMediaGroupCollectorçš„`get_media_groups_info_optimized`æ–¹æ³•åªè¿”å›æ¶ˆæ¯IDï¼Œä¸è¿”å›é¢„æå–çš„åª’ä½“ç»„æ–‡æœ¬
  - **é‡å¤æå–å¤±è´¥**ï¼šParallelProcessoré‡æ–°æå–æ–‡æœ¬æ—¶ï¼ŒåŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯å·²è¢«åª’ä½“ç±»å‹è¿‡æ»¤ç§»é™¤
  - **åŠŸèƒ½ä¸ä¸€è‡´**ï¼šéç¦æ­¢è½¬å‘é¢‘é“(DirectForwarder)æœ‰å®Œå–„çš„æ–‡æœ¬ä¼ é€’æœºåˆ¶ï¼Œä½†ç¦æ­¢è½¬å‘é¢‘é“ç¼ºå¤±æ­¤åŠŸèƒ½

- **å‘ç°è¿‡ç¨‹**ï¼š
  - ç”¨æˆ·é…ç½®ï¼š`'remove_captions': False`ï¼ˆæœªå‹¾é€‰ç§»é™¤åª’ä½“è¯´æ˜ï¼‰
  - é¢„æå–æˆåŠŸï¼š`DEBUG | é¢„æå–åª’ä½“ç»„ -8847434337627453974 çš„æ–‡æœ¬: '#åå…­å¤œ #è«ä¸ƒä¸ƒ   6.12-18è‡ªå½•...'`
  - ParallelProcessorä¸­æ–‡æœ¬ä¸¢å¤±ï¼š`DEBUG | åª’ä½“ç»„ -8847434337627453974 è·å–åˆ°åª’ä½“ç»„æ–‡æœ¬: 0 ä¸ª`
  - ç»“æœï¼šè½¬å‘æˆåŠŸä½†åª’ä½“ç»„æ²¡æœ‰æ–‡æœ¬å†…å®¹

- **ä¿®å¤ç­–ç•¥**ï¼š
  ```python
  # ä¿®å¤å‰ (âŒ æ–‡æœ¬ä¿¡æ¯ä¼ é€’ä¸­æ–­)
  # MediaGroupCollector: get_media_groups_info_optimized() -> List[åª’ä½“ç»„ID, æ¶ˆæ¯IDåˆ—è¡¨]
  # ParallelProcessor: é‡æ–°æå–æ–‡æœ¬ -> å¤±è´¥ï¼ˆåŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯å·²è¢«è¿‡æ»¤ï¼‰
  
  # ä¿®å¤å (âœ… å®Œæ•´çš„æ–‡æœ¬ä¼ é€’é“¾è·¯)
  # MediaGroupCollector: get_media_groups_info_optimized() -> (åª’ä½“ç»„ä¿¡æ¯, åª’ä½“ç»„æ–‡æœ¬æ˜ å°„)
  # Forwarder: å°†åª’ä½“ç»„æ–‡æœ¬æ·»åŠ åˆ°é…ç½®ä¸­ä¼ é€’ç»™ParallelProcessor
  # ParallelProcessor: ä¼˜å…ˆä½¿ç”¨é¢„ä¼ é€’çš„åª’ä½“ç»„æ–‡æœ¬ä¿¡æ¯
  ```

- **æŠ€æœ¯å®ç°**ï¼š
  - **ä¿®æ”¹MediaGroupCollectorè¿”å›å€¼**ï¼š`get_media_groups_info_optimized`æ–¹æ³•ç°åœ¨è¿”å›`(åª’ä½“ç»„ä¿¡æ¯, åª’ä½“ç»„æ–‡æœ¬æ˜ å°„)`
  - **å¢å¼ºForwarderä¼ é€’æœºåˆ¶**ï¼šå°†åª’ä½“ç»„æ–‡æœ¬ä¿¡æ¯æ·»åŠ åˆ°é¢‘é“å¯¹é…ç½®ä¸­ï¼Œä¼ é€’ç»™ParallelProcessor
  - **ä¼˜åŒ–ParallelProcessoræ–‡æœ¬è·å–**ï¼šä¼˜å…ˆä½¿ç”¨Forwarderä¼ é€’çš„é¢„æå–æ–‡æœ¬ï¼Œæ”¯æŒå¤šç§åª’ä½“ç»„IDæ ¼å¼åŒ¹é…
  - **æ–‡æœ¬æ›¿æ¢æ­£å¸¸å·¥ä½œ**ï¼šç¡®ä¿\"è«ä¸ƒä¸ƒ\" â†’ \"è«å…«å…«\"ç­‰æ–‡æœ¬æ›¿æ¢è§„åˆ™åœ¨åª’ä½“ç»„ä¸­æ­£ç¡®åº”ç”¨

- **ç”¨æˆ·ä»·å€¼**ï¼š
  - âœ… **ä¿ç•™åª’ä½“ç»„æ–‡æœ¬**ï¼šç”¨æˆ·é…ç½®ä¸ç§»é™¤è¯´æ˜æ—¶ï¼Œåª’ä½“ç»„çš„æ–‡æœ¬å†…å®¹å¾—åˆ°å®Œæ•´ä¿ç•™
  - âœ… **æ–‡æœ¬æ›¿æ¢ç”Ÿæ•ˆ**ï¼šæ–‡æœ¬æ›¿æ¢åŠŸèƒ½åœ¨ç¦æ­¢è½¬å‘é¢‘é“ä¸­æ­£å¸¸å·¥ä½œ
  - âœ… **åŠŸèƒ½ä¸€è‡´æ€§**ï¼šç¦æ­¢è½¬å‘é¢‘é“ä¸éç¦æ­¢è½¬å‘é¢‘é“äº«å—å®Œå…¨ä¸€è‡´çš„æ–‡æœ¬å¤„ç†åŠŸèƒ½
  - âœ… **æ¶æ„ç»Ÿä¸€æ€§**ï¼šv2.2.0çš„ç»Ÿä¸€è¿‡æ»¤æ¶æ„ç°åœ¨çœŸæ­£å®Œæ•´ï¼Œæ— åŠŸèƒ½ç¼ºå¤±

### å½±å“èŒƒå›´
- **ä¿®å¤v2.2.0æ¶æ„ç¼ºé™·**ï¼šv2.2.0å®ç°äº†ç»Ÿä¸€è¿‡æ»¤ä½†å­˜åœ¨æ–‡æœ¬ä¼ é€’æœºåˆ¶ä¸å®Œæ•´çš„é—®é¢˜
- **æå‡ç”¨æˆ·ä½“éªŒ**ï¼šç”¨æˆ·ä¸å†é‡åˆ°åª’ä½“ç»„æ–‡æœ¬æ„å¤–ä¸¢å¤±çš„é—®é¢˜
- **ç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§**ï¼šç¦æ­¢è½¬å‘é¢‘é“ç°åœ¨å®Œå…¨æ”¯æŒæ–‡æœ¬ä¿ç•™å’Œæ›¿æ¢åŠŸèƒ½

---

## [v2.2.0] - 2024-12-22

### ğŸš€ é‡å¤§åŠŸèƒ½å‡çº§ (Major Feature Enhancement)

#### ç¦æ­¢è½¬å‘é¢‘é“ç»Ÿä¸€è¿‡æ»¤åŠŸèƒ½å®ç° (Unified Filtering for Protected Content Channels)
- **æ ¸å¿ƒå‡çº§**ï¼š
  - **ğŸ¯ åŠŸèƒ½ç»Ÿä¸€åŒ–**ï¼šç¦æ­¢è½¬å‘é¢‘é“ç°å·²æ”¯æŒä¸éç¦æ­¢è½¬å‘é¢‘é“å®Œå…¨ç›¸åŒçš„è¿‡æ»¤å’Œå¤„ç†åŠŸèƒ½
  - **ğŸ”§ ä»£ç å¤ç”¨ä¼˜åŒ–**ï¼šé‡æ„å¹¶è¡Œå¤„ç†å™¨(ParallelProcessor)ï¼Œä½¿ç”¨`apply_all_filters`ç»Ÿä¸€è¿‡æ»¤é€»è¾‘
  - **ğŸ“¦ æ¶æ„æ”¹è¿›**ï¼šæ¶ˆé™¤ä»£ç é‡å¤ï¼Œæå‡ç»´æŠ¤æ€§å’ŒåŠŸèƒ½ä¸€è‡´æ€§

- **æ–°å¢åŠŸèƒ½æ”¯æŒ**ï¼š
  - âœ… **ç»Ÿä¸€è¿‡æ»¤é€»è¾‘**ï¼šç¦æ­¢è½¬å‘é¢‘é“ç°åœ¨ä½¿ç”¨`apply_all_filters`å‡½æ•°è¿›è¡Œç»Ÿä¸€çš„æ¶ˆæ¯è¿‡æ»¤
  - âœ… **å…³é”®è¯è¿‡æ»¤**ï¼šæ”¯æŒåª’ä½“ç»„çº§åˆ«çš„å…³é”®è¯è¿‡æ»¤ï¼Œä»»ä¸€æ¶ˆæ¯åŒ…å«å…³é”®è¯åˆ™æ•´ä¸ªåª’ä½“ç»„é€šè¿‡
  - âœ… **åª’ä½“ç±»å‹è¿‡æ»¤**ï¼šæ”¯æŒæ¶ˆæ¯çº§åˆ«çš„ç²¾ç¡®åª’ä½“ç±»å‹è¿‡æ»¤ï¼Œå¯æŒ‰éœ€ä¿ç•™ç‰¹å®šç±»å‹å†…å®¹
  - âœ… **æ–‡æœ¬æ›¿æ¢åŠŸèƒ½**ï¼šæ”¯æŒå¯¹æ¶ˆæ¯æ ‡é¢˜å’Œæ–‡æœ¬å†…å®¹è¿›è¡Œæ›¿æ¢å¤„ç†
  - âœ… **æ’é™¤å«é“¾æ¥æ¶ˆæ¯**ï¼šè‡ªåŠ¨è¿‡æ»¤åŒ…å«é“¾æ¥çš„æ¶ˆæ¯ï¼ˆHTTP/HTTPS/t.me/@ç”¨æˆ·åç­‰ï¼‰
  - âœ… **ç§»é™¤æ ‡é¢˜åŠŸèƒ½**ï¼šæ ¹æ®é…ç½®å†³å®šæ˜¯å¦ç§»é™¤æ¶ˆæ¯æ ‡é¢˜
  - âœ… **åª’ä½“ç»„æ–‡æœ¬é‡ç»„**ï¼šç¡®ä¿åª’ä½“ç»„æ–‡æœ¬å†…å®¹æ­£ç¡®ä¿ç•™å’Œåº”ç”¨ï¼Œæ”¯æŒé¢„æå–æœºåˆ¶
  - âœ… **å‘é€æœ€ç»ˆæ¶ˆæ¯**ï¼šæ”¯æŒè½¬å‘å®Œæˆåå‘é€æœ€ç»ˆæ¶ˆæ¯åŠŸèƒ½

- **æŠ€æœ¯å®ç°è¯¦æƒ…**ï¼š
  ```python
  # ParallelProcessoræ„é€ å‡½æ•°æ–°å¢MessageFilteræ”¯æŒ
  def __init__(self, client, history_manager=None, general_config=None, config=None):
      self.message_filter = MessageFilter(config or {})  # æ–°å¢è¿‡æ»¤å™¨ç»„ä»¶
  
  # ä¸»è¦æ–¹æ³•ç­¾åæ›´æ–°ï¼Œæ”¯æŒé¢‘é“å¯¹é…ç½®
  async def process_parallel_download_upload(self, source_channel, source_id, 
                                           media_groups_info, temp_dir, 
                                           target_channels, pair_config=None) -> int:
  
  # ç”Ÿäº§è€…æ–¹æ³•ä¸­é›†æˆç»Ÿä¸€è¿‡æ»¤é€»è¾‘
  async def _producer_download_media_groups_parallel(..., pair_config=None):
      # åº”ç”¨è¿‡æ»¤è§„åˆ™ï¼ˆä½¿ç”¨æ–°çš„ç»Ÿä¸€è¿‡æ»¤å™¨ï¼‰
      if pair_config and messages:
          filtered_messages, _, filter_stats = self.message_filter.apply_all_filters(messages, pair_config)
          media_group_texts = filter_stats.get('media_group_texts', {})
  ```

- **æ™ºèƒ½æ–‡æœ¬å¤„ç†ä¼˜åŒ–**ï¼š
  - ğŸ¯ **é¢„æå–åª’ä½“ç»„æ–‡æœ¬**ï¼šåœ¨è¿‡æ»¤å¼€å§‹å‰é¢„å…ˆæå–åª’ä½“ç»„æ–‡æœ¬ï¼Œé˜²æ­¢å› åª’ä½“ç±»å‹è¿‡æ»¤å¯¼è‡´æ–‡æœ¬ä¸¢å¤±
  - ğŸ“ **ä¼˜å…ˆçº§å¤„ç†æœºåˆ¶**ï¼šä¼˜å…ˆä½¿ç”¨é¢„æå–çš„åª’ä½“ç»„æ–‡æœ¬ï¼Œç¡®ä¿æ–‡æœ¬å†…å®¹å®Œæ•´æ€§
  - ğŸ”„ **æ™ºèƒ½å›é€€é€»è¾‘**ï¼šé¢„æå–å¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°åŸæœ‰æ–‡æœ¬è·å–é€»è¾‘
  - ğŸ›ï¸ **æ–‡æœ¬æ›¿æ¢é›†æˆ**ï¼šé¢„æå–çš„æ–‡æœ¬åŒæ ·æ”¯æŒæ–‡æœ¬æ›¿æ¢è§„åˆ™åº”ç”¨

- **è½¬å‘å™¨é›†æˆæ”¹è¿›**ï¼š
  ```python
  # Forwarderä¸­çš„ParallelProcessoråˆå§‹åŒ–æ›´æ–°
  self.parallel_processor = ParallelProcessor(client, history_manager, 
                                              general_config, self.config)
  
  # è°ƒç”¨æ—¶ä¼ é€’é¢‘é“å¯¹é…ç½®
  forward_count = await self.parallel_processor.process_parallel_download_upload(
      source_channel, source_id, media_groups_info, 
      channel_temp_dir, valid_target_channels, pair)
  ```

- **æ€§èƒ½ä¸è®¡æ•°ä¼˜åŒ–**ï¼š
  - ğŸ“Š **å‡†ç¡®è®¡æ•°è¿”å›**ï¼šå¹¶è¡Œå¤„ç†å™¨ç°åœ¨è¿”å›å®é™…è½¬å‘çš„åª’ä½“ç»„æ•°é‡
  - âš¡ **å¤„ç†æ•ˆç‡æå‡**ï¼šé€šè¿‡ç»Ÿä¸€è¿‡æ»¤å‡å°‘é‡å¤é€»è¾‘ï¼Œæå‡å¤„ç†æ•ˆç‡
  - ğŸ¯ **å†…å­˜ä½¿ç”¨ä¼˜åŒ–**ï¼šä¼˜åŒ–è¿‡æ»¤è¿‡ç¨‹ä¸­çš„å†…å­˜ä½¿ç”¨ï¼Œå‡å°‘ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»º

- **ç”¨æˆ·ä½“éªŒæå‡**ï¼š
  - âœ… **åŠŸèƒ½ä¸€è‡´æ€§**ï¼šç¦æ­¢è½¬å‘å’Œéç¦æ­¢è½¬å‘é¢‘é“ç°åœ¨äº«æœ‰å®Œå…¨ç›¸åŒçš„è¿‡æ»¤åŠŸèƒ½
  - âœ… **é…ç½®ç»Ÿä¸€æ€§**ï¼šæ‰€æœ‰é¢‘é“å¯¹é…ç½®åœ¨ç¦æ­¢è½¬å‘æ¨¡å¼ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œ
  - âœ… **è¡Œä¸ºå¯é¢„æœŸæ€§**ï¼šç”¨æˆ·é…ç½®çš„è¿‡æ»¤è§„åˆ™åœ¨ä»»ä½•è½¬å‘æ¨¡å¼ä¸‹éƒ½æœ‰ä¸€è‡´çš„è¡Œä¸º
  - âœ… **åŠŸèƒ½å®Œæ•´æ€§**ï¼šæ¶ˆé™¤äº†å› é¢‘é“é™åˆ¶å¯¼è‡´çš„åŠŸèƒ½ç¼ºå¤±é—®é¢˜

- **ä»£ç è´¨é‡æ”¹è¿›**ï¼š
  - ğŸ”§ **æ¶æ„ç»Ÿä¸€**ï¼šæ¶ˆé™¤äº†ç¦æ­¢è½¬å‘å’Œéç¦æ­¢è½¬å‘é¢‘é“ä¹‹é—´çš„ä»£ç é‡å¤
  - ğŸ“ **ç»´æŠ¤æ€§æå‡**ï¼šè¿‡æ»¤é€»è¾‘é›†ä¸­åœ¨MessageFilterä¸­ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
  - ğŸ¯ **æµ‹è¯•ä¾¿åˆ©æ€§**ï¼šç»Ÿä¸€çš„æ¥å£ä½¿å¾—æµ‹è¯•è¦†ç›–æ›´åŠ å…¨é¢
  - ğŸ›¡ï¸ **ç¨³å®šæ€§å¢å¼º**ï¼šå‡å°‘ä»£ç åˆ†æ”¯ï¼Œé™ä½å‡ºé”™æ¦‚ç‡

- **å‘åå…¼å®¹æ€§**ï¼š
  - âœ… **å®Œå…¨å…¼å®¹**ï¼šç°æœ‰é…ç½®å’Œä½¿ç”¨æ–¹å¼ä¿æŒ100%å…¼å®¹
  - âœ… **å¹³æ»‘å‡çº§**ï¼šæ— éœ€ä¿®æ”¹ä»»ä½•ç”¨æˆ·é…ç½®ï¼ŒåŠŸèƒ½è‡ªåŠ¨å¢å¼º
  - âœ… **è¡Œä¸ºä¿æŒ**ï¼šåŸæœ‰å·¥ä½œçš„åŠŸèƒ½ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œæ–°å¢åŠŸèƒ½è‡ªåŠ¨å¯ç”¨

## [v2.1.9.29] - 2024-12-22

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix) 

#### ä¿®å¤åª’ä½“ç»„æ–‡æœ¬ä¼ é€’æœºåˆ¶ä¸­çš„é‡å¤è¿‡æ»¤é—®é¢˜ (Fix Duplicate Filtering in Media Group Text Transfer Mechanism)
- **é—®é¢˜æ ¹æºåˆ†æ**ï¼š
  - **åŒé‡è¿‡æ»¤é—®é¢˜**ï¼šMediaGroupCollectorå’ŒDirectForwarderéƒ½åœ¨è°ƒç”¨è¿‡æ»¤å™¨ï¼Œå¯¼è‡´æ–‡æœ¬ä¿¡æ¯åœ¨ç¬¬äºŒæ¬¡è¿‡æ»¤æ—¶ä¸¢å¤±
  - **æ•°æ®ä¼ é€’ç¼ºå¤±**ï¼šMediaGroupCollectorè¿‡æ»¤åçš„ç»“æœæ²¡æœ‰åŒ…å«åª’ä½“ç»„æ–‡æœ¬ä¿¡æ¯ï¼ŒDirectForwarderæ— æ³•è·å–é¢„æå–çš„æ–‡æœ¬
  - **æ—¶åºé—®é¢˜**ï¼šåŒ…å«æ–‡æœ¬çš„ç…§ç‰‡æ¶ˆæ¯åœ¨ç¬¬ä¸€æ¬¡è¿‡æ»¤ä¸­è¢«ç§»é™¤ï¼Œç¬¬äºŒæ¬¡è¿‡æ»¤æ—¶å·²æ— æ³•è·å–åŸå§‹æ–‡æœ¬

- **å®Œæ•´ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ”§ **ä¿®æ”¹MediaGroupCollectorè¿”å›å€¼**ï¼š`get_media_groups_optimized`ç°åœ¨è¿”å›`(media_groups, media_group_texts)`å…ƒç»„
  - ğŸ“¤ **å¢å¼ºæ•°æ®ä¼ é€’æœºåˆ¶**ï¼šForwarderå°†åª’ä½“ç»„æ–‡æœ¬ä¿¡æ¯æ·»åŠ åˆ°é¢‘é“å¯¹é…ç½®ä¸­ä¼ é€’ç»™DirectForwarder
  - ğŸ¯ **ä¼˜åŒ–DirectForwarderé€»è¾‘**ï¼šä¼˜å…ˆä½¿ç”¨ä¼ é€’çš„åª’ä½“ç»„æ–‡æœ¬ï¼Œé¿å…é‡å¤è¿‡æ»¤
  - ğŸ“ **å¢å¼ºè°ƒè¯•æ”¯æŒ**ï¼šæ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—è·Ÿè¸ªæ–‡æœ¬ä¼ é€’è¿‡ç¨‹

- **ä¿®å¤æ•ˆæœ**ï¼š
  - âœ… **æ¶ˆé™¤é‡å¤è¿‡æ»¤**ï¼šç¡®ä¿è¿‡æ»¤å™¨åªåœ¨MediaGroupCollectorä¸­è¿è¡Œä¸€æ¬¡
  - âœ… **ä¿è¯æ–‡æœ¬ä¼ é€’**ï¼šå³ä½¿åŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯è¢«è¿‡æ»¤ï¼Œæ–‡æœ¬ä¿¡æ¯ä¹Ÿèƒ½æ­£ç¡®ä¼ é€’åˆ°DirectForwarder
  - âœ… **ä¿æŒåŠŸèƒ½å®Œæ•´æ€§**ï¼šæ‰€æœ‰åŸæœ‰åŠŸèƒ½ï¼ˆæ–‡æœ¬æ›¿æ¢ã€åª’ä½“ç±»å‹è¿‡æ»¤ç­‰ï¼‰ç»§ç»­æ­£å¸¸å·¥ä½œ
  - âœ… **å‘åå…¼å®¹**ï¼šå…¼å®¹æ²¡æœ‰é¢„æå–æ–‡æœ¬çš„æƒ…å†µï¼Œè‡ªåŠ¨é™çº§åˆ°åŸæœ‰é€»è¾‘

- **æŠ€æœ¯å®ç°ç»†èŠ‚**ï¼š
  ```python
  # MediaGroupCollectorç°åœ¨è¿”å›æ–‡æœ¬ä¿¡æ¯
  media_groups, media_group_texts = await self.media_group_collector.get_media_groups_optimized(...)
  
  # Forwarderä¼ é€’æ–‡æœ¬ä¿¡æ¯
  enhanced_pair_config = pair.copy()
  enhanced_pair_config['media_group_texts'] = media_group_texts
  
  # DirectForwarderä¼˜å…ˆä½¿ç”¨ä¼ é€’çš„æ–‡æœ¬
  if pair_config and 'media_group_texts' in pair_config:
      media_group_texts = pair_config.get('media_group_texts', {})
      # è·³è¿‡é‡å¤è¿‡æ»¤ï¼Œç›´æ¥ä½¿ç”¨é¢„è¿‡æ»¤çš„æ¶ˆæ¯
  ```

## [v2.1.9.28] - 2024-12-22

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix)

#### ä¿®å¤åª’ä½“ç±»å‹è¿‡æ»¤å¯¼è‡´åª’ä½“ç»„æ–‡æœ¬ä¸¢å¤±çš„é—®é¢˜ (Fix Media Group Text Loss Due to Media Type Filtering)
- **é—®é¢˜æè¿°**ï¼š
  - å½“å‰”é™¤ç…§ç‰‡ç­‰åª’ä½“ç±»å‹æ—¶ï¼Œåª’ä½“è¯´æ˜ä»ç„¶è¢«ç§»é™¤
  - ç”¨æˆ·åæ˜ ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼ˆç…§ç‰‡ï¼‰åŒ…å«æ–‡æœ¬ï¼Œä½†è¢«åª’ä½“ç±»å‹è¿‡æ»¤å‰”é™¤åï¼Œæ•´ä¸ªåª’ä½“ç»„çš„æ–‡æœ¬å†…å®¹ä¸¢å¤±

- **æ ¹æœ¬åŸå› **ï¼š
  - **æ—¶åºé—®é¢˜**ï¼šåª’ä½“ç±»å‹è¿‡æ»¤åœ¨æ–‡æœ¬æå–ä¹‹å‰æ‰§è¡Œï¼ŒåŒ…å«æ–‡æœ¬çš„ç…§ç‰‡æ¶ˆæ¯è¢«è¿‡æ»¤æ‰åï¼Œæ–‡æœ¬å†…å®¹éšä¹‹ä¸¢å¤±
  - **å¤„ç†é¡ºåºé”™è¯¯**ï¼š
    1. é€šç”¨è¿‡æ»¤
    2. å…³é”®è¯è¿‡æ»¤ï¼ˆåªæœ‰è®¾ç½®å…³é”®è¯æ—¶æ‰ä¿å­˜åª’ä½“ç»„æ–‡æœ¬ï¼‰
    3. **åª’ä½“ç±»å‹è¿‡æ»¤** â† åŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯åœ¨è¿™ä¸€æ­¥è¢«ç§»é™¤
  - **æ–‡æœ¬ä¿å­˜ä¸å®Œæ•´**ï¼šåªæœ‰è®¾ç½®äº†å…³é”®è¯è¿‡æ»¤æ—¶æ‰ä¼šä¿å­˜åª’ä½“ç»„æ–‡æœ¬ï¼Œå…¶ä»–æƒ…å†µä¸‹æ–‡æœ¬å†…å®¹ç›´æ¥ä¸¢å¤±

- **ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ¯ **é¢„æå–æ–‡æœ¬**ï¼šåœ¨ä»»ä½•è¿‡æ»¤å¼€å§‹ä¹‹å‰ï¼Œé¢„å…ˆæå–å¹¶ä¿å­˜æ‰€æœ‰åª’ä½“ç»„çš„æ–‡æœ¬å†…å®¹
  - ğŸ“ **æ–°å¢æ–¹æ³•**ï¼šå®ç° `_extract_media_group_texts()` æ–¹æ³•ï¼Œä¸“é—¨è´Ÿè´£æ–‡æœ¬é¢„æå–
  - ğŸ”§ **ä¼˜åŒ–å¤„ç†é¡ºåº**ï¼š
    1. **æ–‡æœ¬é¢„æå–** â† æ–°å¢æ­¥éª¤ï¼Œç¡®ä¿æ–‡æœ¬ä¸ä¸¢å¤±
    2. é€šç”¨è¿‡æ»¤
    3. å…³é”®è¯è¿‡æ»¤
    4. åª’ä½“ç±»å‹è¿‡æ»¤
  - ğŸ›ï¸ **æ™ºèƒ½åˆå¹¶**ï¼šå°†é¢„æå–çš„æ–‡æœ¬ä¸å…³é”®è¯è¿‡æ»¤äº§ç”Ÿçš„æ–‡æœ¬æ™ºèƒ½åˆå¹¶

- **æŠ€æœ¯å®ç°**ï¼š
  ```python
  def _extract_media_group_texts(self, messages: List[Message]) -> Dict[str, str]:
      """é¢„æå–æ‰€æœ‰åª’ä½“ç»„çš„æ–‡æœ¬å†…å®¹ï¼Œåœ¨ä»»ä½•è¿‡æ»¤å¼€å§‹ä¹‹å‰æ‰§è¡Œ"""
      media_groups = self._group_messages_by_media_group(messages)
      media_group_texts = {}
      
      for group_messages in media_groups:
          media_group_id = getattr(group_messages[0], 'media_group_id', None)
          if not media_group_id:
              continue
              
          # å¯»æ‰¾ç¬¬ä¸€ä¸ªæœ‰æ–‡æœ¬å†…å®¹çš„æ¶ˆæ¯
          for message in group_messages:
              text_content = message.caption or message.text
              if text_content:
                  media_group_texts[media_group_id] = text_content
                  break
      
      return media_group_texts
  
  # åœ¨apply_all_filtersä¸­çš„æ–°å¤„ç†é¡ºåº
  def apply_all_filters(self, messages, pair_config):
      # 0. é¢„æå–åª’ä½“ç»„æ–‡æœ¬ï¼ˆå…³é”®æ–°æ­¥éª¤ï¼‰
      media_group_texts = self._extract_media_group_texts(current_messages)
      
      # 1-3. æ‰§è¡Œå„ç§è¿‡æ»¤...
      
      # æœ€ç»ˆåˆå¹¶æ–‡æœ¬æ˜ å°„
      filter_stats['media_group_texts'] = media_group_texts
  ```

- **æ—¥å¿—æ”¹è¿›**ï¼š
  - æ·»åŠ é¢„æå–æ–‡æœ¬çš„è°ƒè¯•æ—¥å¿—ï¼š`ğŸ“ é¢„æå–åª’ä½“ç»„æ–‡æœ¬: æ‰¾åˆ° X ä¸ªåª’ä½“ç»„çš„æ–‡æœ¬å†…å®¹`
  - æ¯ä¸ªåª’ä½“ç»„çš„æ–‡æœ¬æå–éƒ½æœ‰è¯¦ç»†æ—¥å¿—ï¼š`é¢„æå–åª’ä½“ç»„ {id} çš„æ–‡æœ¬: '{text[:50]}...'`

- **ç”¨æˆ·ä»·å€¼**ï¼š
  - âœ… **æ–‡æœ¬æ°¸ä¸ä¸¢å¤±**ï¼šæ— è®ºè¿‡æ»¤æ‰å“ªäº›åª’ä½“ç±»å‹ï¼ŒåŒ…å«æ–‡æœ¬çš„æ¶ˆæ¯çš„æ–‡æœ¬å†…å®¹éƒ½ä¼šè¢«ä¿ç•™
  - âœ… **æ™ºèƒ½æ–‡æœ¬åº”ç”¨**ï¼šä¿ç•™çš„æ–‡æœ¬ä¼šæ­£ç¡®åº”ç”¨åˆ°é‡ç»„åçš„åª’ä½“ç»„
  - âœ… **ä¸€è‡´çš„è¡Œä¸º**ï¼šä¸ç®¡åª’ä½“ç»„ä¸­ç¬¬ä¸€æ¡æ¶ˆæ¯æ˜¯ä»€ä¹ˆç±»å‹ï¼Œæ–‡æœ¬å¤„ç†é€»è¾‘éƒ½ä¿æŒä¸€è‡´
  - âœ… **æ–‡æœ¬æ›¿æ¢ç”Ÿæ•ˆ**ï¼šé¢„æå–çš„æ–‡æœ¬åŒæ ·ä¼šåº”ç”¨æ–‡æœ¬æ›¿æ¢è§„åˆ™

- **ä¿®å¤éªŒè¯**ï¼š
  - æµ‹è¯•åœºæ™¯1ï¼šåª’ä½“ç»„ [ç…§ç‰‡+è§†é¢‘]ï¼Œæ’é™¤ç…§ç‰‡ï¼Œä¿ç•™è§†é¢‘å’Œæ–‡æœ¬ âœ…
  - æµ‹è¯•åœºæ™¯2ï¼šåª’ä½“ç»„ [è§†é¢‘+ç…§ç‰‡]ï¼Œæ’é™¤ç…§ç‰‡ï¼Œä¿ç•™è§†é¢‘å’Œæ–‡æœ¬ âœ…
  - æµ‹è¯•åœºæ™¯3ï¼šåª’ä½“ç»„ [ç…§ç‰‡+ç…§ç‰‡+è§†é¢‘]ï¼Œæ’é™¤ç…§ç‰‡ï¼Œä¿ç•™è§†é¢‘å’Œæ–‡æœ¬ âœ…

## [v2.1.9.27] - 2024-12-22

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix)

#### ä¿®å¤åª’ä½“ç»„æ ‡é¢˜å¤„ç†çš„ä¸ä¸€è‡´é—®é¢˜ (Fix Inconsistent Media Group Caption Handling)
- **é—®é¢˜æè¿°**ï¼š
  - åœ¨å‰”é™¤è§†é¢‘æ—¶åª’ä½“è¯´æ˜æ­£å¸¸ä¿ç•™ï¼Œä½†åœ¨å‰”é™¤ç…§ç‰‡æ—¶åª’ä½“è¯´æ˜è¢«æ„å¤–ç§»é™¤
  - ä¸åŒè¿‡æ»¤åœºæ™¯ä¸‹åª’ä½“ç»„æ ‡é¢˜å¤„ç†é€»è¾‘ä¸ä¸€è‡´ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ç»Ÿä¸€

- **æ ¹æœ¬åŸå› **ï¼š
  - é‡ç»„åª’ä½“ç»„æ—¶ï¼Œæ ‡é¢˜å¤„ç†é€»è¾‘ä¾èµ–äºæ¶ˆæ¯é¡ºåºå’Œæ¶ˆæ¯ç±»å‹
  - ç…§ç‰‡æ¶ˆæ¯é€šå¸¸æ²¡æœ‰`caption`ï¼Œè§†é¢‘æ¶ˆæ¯é€šå¸¸æœ‰`caption`
  - åŸé€»è¾‘å¼ºåˆ¶ä½¿ç”¨"æ¯æ¡æ¶ˆæ¯è‡ªå·±çš„æ ‡é¢˜"ï¼Œå¯¼è‡´æ— æ ‡é¢˜çš„æ¶ˆæ¯ï¼ˆå¦‚ç…§ç‰‡ï¼‰ä¸¢å¤±åª’ä½“ç»„æ ‡é¢˜

- **ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ¯ **æ™ºèƒ½æ ‡é¢˜é€‰æ‹©**ï¼šå½“æ²¡æœ‰ä¿å­˜çš„åª’ä½“ç»„æ–‡æœ¬æ—¶ï¼Œè‡ªåŠ¨å¯»æ‰¾ç¬¬ä¸€ä¸ªæœ‰æ ‡é¢˜çš„æ¶ˆæ¯ä½œä¸ºåª’ä½“ç»„æ ‡é¢˜
  - ğŸ“ **ç»Ÿä¸€åª’ä½“ç»„æ ¼å¼**ï¼šç¡®ä¿é‡ç»„åçš„åª’ä½“ç»„å§‹ç»ˆéµå¾ªTelegramæ ‡å‡†æ ¼å¼ï¼ˆåªæœ‰ç¬¬ä¸€æ¡æ¶ˆæ¯å¸¦æ ‡é¢˜ï¼‰
  - ğŸ”§ **ä¸€è‡´çš„å¤„ç†é€»è¾‘**ï¼šæ— è®ºè¿‡æ»¤æ‰çš„æ˜¯ä»€ä¹ˆç±»å‹çš„åª’ä½“ï¼Œæ ‡é¢˜å¤„ç†é€»è¾‘ä¿æŒç»Ÿä¸€

- **æŠ€æœ¯å®ç°**ï¼š
  ```python
  # ä¿®å¤å‰çš„æœ‰é—®é¢˜é€»è¾‘
  else:
      caption = message.caption or ""  # å¯èƒ½å¯¼è‡´ç©ºæ ‡é¢˜
  
  # ä¿®å¤åçš„æ™ºèƒ½é€»è¾‘
  if not group_caption:
      for msg in filtered_messages:
          if msg.caption:
              group_caption = msg.caption  # æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰æ ‡é¢˜çš„æ¶ˆæ¯
              break
  
  # ç»Ÿä¸€çš„æ ‡é¢˜åˆ†é…
  caption = group_caption if i == 0 else ""  # åªæœ‰ç¬¬ä¸€æ¡æ¶ˆæ¯å¸¦æ ‡é¢˜
  ```

- **ç”¨æˆ·ä»·å€¼**ï¼š
  - âœ… **ä¸€è‡´çš„ä½“éªŒ**ï¼šæ— è®ºå‰”é™¤ä»€ä¹ˆç±»å‹çš„åª’ä½“ï¼Œæ ‡é¢˜å¤„ç†é€»è¾‘ç»Ÿä¸€
  - âœ… **æ™ºèƒ½ä¿ç•™**ï¼šè‡ªåŠ¨å¯»æ‰¾å¹¶ä¿ç•™æœ‰æ„ä¹‰çš„åª’ä½“ç»„æ ‡é¢˜
  - âœ… **æ–‡æœ¬æ›¿æ¢ç”Ÿæ•ˆ**ï¼šç¡®ä¿æ–‡æœ¬æ›¿æ¢åœ¨æ‰€æœ‰è¿‡æ»¤åœºæ™¯ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œ
  - âœ… **ç¬¦åˆè§„èŒƒ**ï¼šé‡ç»„åçš„åª’ä½“ç»„ç¬¦åˆTelegramåª’ä½“ç»„æ˜¾ç¤ºæ ‡å‡†

## [v2.1.9.26] - 2024-12-22

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix)

#### ä¿®å¤é‡ç»„åª’ä½“ç»„æ—¶åª’ä½“è¯´æ˜è¢«æ„å¤–ç§»é™¤çš„é—®é¢˜ (Fix Media Caption Loss in Regrouped Media)
- **é—®é¢˜æè¿°**ï¼š
  - åœ¨å®ç°åª’ä½“ç»„é‡ç»„åŠŸèƒ½åï¼Œå‘ç°å³ä½¿æ²¡æœ‰å‹¾é€‰"ç§»é™¤åª’ä½“è¯´æ˜"ï¼Œè½¬å‘åçš„åª’ä½“è¯´æ˜ä¹Ÿè¢«ç§»é™¤äº†
  - é—®é¢˜å‡ºç°åœ¨é‡ç»„æ¨¡å¼ä¸‹çš„æ ‡é¢˜å¤„ç†é€»è¾‘ï¼Œå¼ºåˆ¶å°†éé¦–æ¡æ¶ˆæ¯çš„æ ‡é¢˜è®¾ä¸ºç©ºå­—ç¬¦ä¸²

- **æ ¹æœ¬åŸå› **ï¼š
  - é‡ç»„é€»è¾‘ä¸­å‡è®¾åªæœ‰é¦–æ¡æ¶ˆæ¯éœ€è¦æ ‡é¢˜ï¼Œå…¶ä½™æ¶ˆæ¯å¼ºåˆ¶ä¸ºç©º
  - å½“æ²¡æœ‰ä¿å­˜çš„åª’ä½“ç»„æ–‡æœ¬æ—¶ï¼Œ`group_caption` ä¸ºç©ºï¼Œå¯¼è‡´æ‰€æœ‰æ¶ˆæ¯æ ‡é¢˜éƒ½ä¸¢å¤±
  - æ²¡æœ‰æ­£ç¡®å¤„ç†æ¯æ¡æ¶ˆæ¯è‡ªèº«çš„åŸå§‹æ ‡é¢˜

- **ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ¯ **åˆ†æƒ…å†µå¤„ç†æ ‡é¢˜**ï¼š
    - `remove_captions=true`ï¼šæ‰€æœ‰æ¶ˆæ¯éƒ½ä¸å¸¦æ ‡é¢˜ âœ…
    - æœ‰ä¿å­˜çš„åª’ä½“ç»„æ–‡æœ¬ï¼šé¦–æ¡æ¶ˆæ¯ç”¨ç»„æ–‡æœ¬ï¼Œå…¶ä½™ä¸ºç©º âœ…  
    - æ— ä¿å­˜çš„åª’ä½“ç»„æ–‡æœ¬ï¼šæ¯æ¡æ¶ˆæ¯ä½¿ç”¨è‡ªå·±çš„åŸå§‹æ ‡é¢˜ âœ…
  - ğŸ“ **ä¿ç•™æ–‡æœ¬æ›¿æ¢**ï¼šåœ¨ä¿ç•™åŸå§‹æ ‡é¢˜çš„åŒæ—¶ï¼Œæ­£ç¡®åº”ç”¨æ–‡æœ¬æ›¿æ¢è§„åˆ™
  - ğŸ”§ **è¯¦ç»†æ—¥å¿—**ï¼šæ·»åŠ æ¯æ¡æ¶ˆæ¯æ ‡é¢˜å¤„ç†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥

- **æŠ€æœ¯å®ç°**ï¼š
  ```python
  # ä¿®å¤å‰çš„æœ‰é—®é¢˜é€»è¾‘
  caption = group_caption if i == 0 else ""  # å¼ºåˆ¶å…¶ä½™æ¶ˆæ¯ä¸ºç©º
  
  # ä¿®å¤åçš„æ­£ç¡®é€»è¾‘
  if remove_captions:
      caption = ""  # é…ç½®ç§»é™¤æ—¶æ‰ä¸ºç©º
  elif group_caption and i == 0:
      caption = group_caption  # æœ‰ç»„æ–‡æœ¬æ—¶ç”¨äºé¦–æ¡
  elif group_caption and i > 0:
      caption = ""  # æœ‰ç»„æ–‡æœ¬æ—¶å…¶ä½™ä¸ºç©º
  else:
      caption = message.caption or ""  # æ— ç»„æ–‡æœ¬æ—¶ä¿ç•™åŸå§‹æ ‡é¢˜
      # åº”ç”¨æ–‡æœ¬æ›¿æ¢...
  ```

- **ç”¨æˆ·ä½“éªŒæå‡**ï¼š
  - âœ… **é…ç½®ä¸€è‡´æ€§**ï¼šä¸å‹¾é€‰"ç§»é™¤åª’ä½“è¯´æ˜"æ—¶ï¼Œåª’ä½“è¯´æ˜è¢«æ­£ç¡®ä¿ç•™
  - âœ… **æ–‡æœ¬æ›¿æ¢ç”Ÿæ•ˆ**ï¼šä¿ç•™è¯´æ˜çš„åŒæ—¶ï¼Œæ–‡æœ¬æ›¿æ¢è§„åˆ™æ­£å¸¸å·¥ä½œ
  - âœ… **åª’ä½“ç»„å®Œæ•´æ€§**ï¼šé‡ç»„åçš„åª’ä½“ç»„ä¿æŒåŸæœ‰çš„æ ‡é¢˜ä¿¡æ¯
  - âœ… **è¡Œä¸ºå¯é¢„æœŸ**ï¼šç”¨æˆ·é…ç½®ä¸å®é™…è½¬å‘ç»“æœå®Œå…¨ä¸€è‡´

## [v2.1.9.25] - 2024-12-22

### ğŸ”§ å…³é”®ä¿®å¤ (Critical Fix)

#### å½»åº•è§£å†³åª’ä½“ç»„è¿‡æ»¤ç»•è¿‡é—®é¢˜ (Final Fix for Media Group Filter Bypass)
- **é—®é¢˜æ ¹æº**ï¼š
  - `MediaGroupCollector` åœ¨è·å–æ¶ˆæ¯åç«‹å³è¿‡æ»¤ï¼Œä¼ é€’ç»™ `DirectForwarder` çš„æ˜¯å·²è¿‡æ»¤ç»“æœ
  - `DirectForwarder` æ— æ³•çŸ¥é“åŸå§‹åª’ä½“ç»„å¤§å°ï¼Œæ— æ³•åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†è¿‡æ»¤
  - å¯¼è‡´ `copy_media_group` æ–¹æ³•ç»•è¿‡è¿‡æ»¤ç»“æœï¼Œè½¬å‘åŸå§‹å®Œæ•´åª’ä½“ç»„

- **ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ¯ **æ™ºèƒ½é‡ç»„åˆ¤æ–­**ï¼šåŸºäºåª’ä½“ç»„IDå’Œé…ç½®ä¸­æ’é™¤çš„åª’ä½“ç±»å‹æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦é‡ç»„
  - ğŸ“ **é…ç½®åˆ†æ**ï¼šæ£€æŸ¥ `media_types` é…ç½®ï¼Œåˆ¤æ–­æ˜¯å¦æ’é™¤äº†æŸäº›åª’ä½“ç±»å‹
  - ğŸ”§ **å¼ºåˆ¶é‡ç»„æ¨¡å¼**ï¼šå½“æ£€æµ‹åˆ°åª’ä½“ç»„å¯èƒ½è¢«è¿‡æ»¤æ—¶ï¼Œå¼ºåˆ¶ä½¿ç”¨ `send_media_group` é‡ç»„

- **æŠ€æœ¯å®ç°**ï¼š
  ```python
  # æ£€æŸ¥é…ç½®æ˜¯å¦æ’é™¤äº†æŸäº›åª’ä½“ç±»å‹
  allowed_media_types = pair_config.get('media_types', [])
  all_media_types = ['text', 'photo', 'video', 'document', 'audio', 'animation', 'sticker', 'voice', 'video_note']
  has_excluded_media_types = len(allowed_media_types) < len(all_media_types)
  
  # é‡ç»„æ¡ä»¶ï¼šæœ‰åª’ä½“ç»„IDï¼Œæ’é™¤äº†æŸäº›åª’ä½“ç±»å‹ï¼Œä¸”å½“å‰æœ‰å¤šæ¡æ¶ˆæ¯
  has_filtering = (original_media_group_id is not None and 
                  has_excluded_media_types and 
                  current_group_size > 1)
  ```

- **æ—¥å¿—æ”¹è¿›**ï¼š
  - æ¸…æ™°æ˜¾ç¤ºæ£€æµ‹åˆ°çš„è¿‡æ»¤æƒ…å†µï¼šåª’ä½“ç»„IDã€æ’é™¤çš„åª’ä½“ç±»å‹ã€å½“å‰æ¶ˆæ¯æ•°
  - ä¾¿äºè°ƒè¯•å’ŒéªŒè¯è¿‡æ»¤æ˜¯å¦æ­£ç¡®åº”ç”¨

- **ç”¨æˆ·ä»·å€¼**ï¼š
  - âœ… **ç²¾ç¡®è¿‡æ»¤**ï¼šç¡®ä¿æ’é™¤çš„åª’ä½“ç±»å‹ï¼ˆå¦‚è§†é¢‘ï¼‰ä¸ä¼šè¢«è½¬å‘
  - âœ… **ä¿æŒæ ¼å¼**ï¼šè¿‡æ»¤åçš„åª’ä½“ç»„ä»ä¿æŒçœŸæ­£çš„åª’ä½“ç»„æ ¼å¼
  - âœ… **é…ç½®ç”Ÿæ•ˆ**ï¼šåª’ä½“ç±»å‹è¿‡æ»¤é…ç½®100%ç”Ÿæ•ˆï¼Œæ— ç»•è¿‡é£é™©

## [v2.1.9.24] - 2024-12-22

### ğŸš€ é‡å¤§æ”¹è¿› (Major Improvement)

#### ä½¿ç”¨send_media_groupé‡ç»„åª’ä½“ç»„ï¼Œä¿æŒçœŸæ­£çš„åª’ä½“ç»„æ ¼å¼ (Media Group Reorganization with send_media_group)
- **åŠŸèƒ½æè¿°**ï¼š
  - å½“åª’ä½“ç»„å› åª’ä½“ç±»å‹è¿‡æ»¤è€Œéœ€è¦é‡ç»„æ—¶ï¼Œç°åœ¨ä½¿ç”¨ `send_media_group` å‘é€ï¼Œä¿æŒTelegramåŸç”Ÿåª’ä½“ç»„æ ¼å¼
  - ç›¸æ¯”ä¹‹å‰é€æ¡å‘é€ `copy_message` çš„æ–¹å¼ï¼Œæ–°æ–¹å¼ä¿æŒäº†çœŸæ­£çš„åª’ä½“ç»„ç‰¹æ€§
- **æŠ€æœ¯å®ç°**ï¼š
  - ğŸ¯ **InputMediaç³»åˆ—æ”¯æŒ**ï¼šæ·»åŠ äº† `InputMediaPhoto`ã€`InputMediaVideo`ã€`InputMediaDocument`ã€`InputMediaAudio`ã€`InputMediaAnimation` çš„å¯¼å…¥å’Œä½¿ç”¨
  - ğŸ”§ **æ™ºèƒ½åª’ä½“åˆ›å»º**ï¼šæ–°å¢ `_create_input_media_from_message()` æ–¹æ³•ï¼Œæ ¹æ®æ¶ˆæ¯ç±»å‹è‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„InputMediaå¯¹è±¡
  - ğŸ“ **æ ‡é¢˜å¤„ç†ä¼˜åŒ–**ï¼š
    - è‹¥ç”¨æˆ·è®¾ç½®ç§»é™¤åª’ä½“è¯´æ˜ï¼ˆ`remove_captions: true`ï¼‰ï¼Œæ‰€æœ‰InputMediaéƒ½ä¸åŒ…å«æ ‡é¢˜
    - è‹¥ç”¨æˆ·æœªè®¾ç½®ç§»é™¤åª’ä½“è¯´æ˜ï¼Œå°†åŸå§‹æ–‡æœ¬æˆ–æ›¿æ¢åçš„æ–‡æœ¬å¡«å…¥ç¬¬ä¸€ä¸ªInputMediaå¯¹è±¡ä½œä¸ºåª’ä½“ç»„æ ‡é¢˜
    - å…¶ä½™åª’ä½“ä¸å¸¦æ ‡é¢˜ï¼Œå½¢æˆç»Ÿä¸€çš„åª’ä½“ç»„
- **ç”¨æˆ·ä½“éªŒæå‡**ï¼š
  - âœ… **çœŸæ­£çš„åª’ä½“ç»„**ï¼šé‡ç»„åçš„åª’ä½“åœ¨Telegramä¸­æ˜¾ç¤ºä¸ºå®Œæ•´çš„åª’ä½“ç»„ï¼Œè€Œéç‹¬ç«‹æ¶ˆæ¯
  - âœ… **ç»Ÿä¸€æ ‡é¢˜**ï¼šåª’ä½“ç»„æ ‡é¢˜åªæ˜¾ç¤ºåœ¨ç¬¬ä¸€æ¡åª’ä½“ä¸Šï¼Œç¬¦åˆTelegramåª’ä½“ç»„æ˜¾ç¤ºè§„èŒƒ
  - âœ… **ä¿æŒæ ¼å¼**ï¼šé‡ç»„åä¿æŒåŸå§‹åª’ä½“ç»„çš„è§†è§‰æ•ˆæœå’Œäº¤äº’ä½“éªŒ
- **æŠ€æœ¯ä¼˜åŠ¿**ï¼š
  - ğŸ“ˆ **æ€§èƒ½æå‡**ï¼šä¸€æ¬¡APIè°ƒç”¨å‘é€æ•´ä¸ªåª’ä½“ç»„ï¼Œæ¯”é€æ¡å‘é€æ›´é«˜æ•ˆ
  - ğŸ¨ **è§†è§‰ä¸€è‡´æ€§**ï¼šé‡ç»„åçš„åª’ä½“ç»„ä¸åŸå§‹åª’ä½“ç»„åœ¨å¤–è§‚ä¸Šå®Œå…¨ä¸€è‡´
  - ğŸ”„ **åŸå­æ“ä½œ**ï¼šæ•´ä¸ªåª’ä½“ç»„ä½œä¸ºä¸€ä¸ªå•å…ƒå‘é€ï¼Œé¿å…äº†é€æ¡å‘é€å¯èƒ½å‡ºç°çš„é—´æ–­
- **å®ç°ç»†èŠ‚**ï¼š
  ```python
  # åˆ›å»ºInputMediaåˆ—è¡¨
  media_list = []
  for i, message in enumerate(filtered_messages):
      # ç¬¬ä¸€æ¡æ¶ˆæ¯å¸¦æ ‡é¢˜ï¼Œå…¶ä½™æ¶ˆæ¯ä¸å¸¦æ ‡é¢˜
      caption = group_caption if i == 0 else ""
      
      # æ ¹æ®æ¶ˆæ¯ç±»å‹åˆ›å»ºå¯¹åº”çš„InputMediaå¯¹è±¡
      input_media = await self._create_input_media_from_message(message, caption)
      if input_media:
          media_list.append(input_media)
  
  # ä½¿ç”¨send_media_groupå‘é€é‡ç»„åçš„åª’ä½“ç»„
  forwarded_messages = await self.client.send_media_group(
      chat_id=target_id,
      media=media_list,
      disable_notification=True
  )
  ```
- **æ–‡ä»¶ä½ç½®**ï¼š`src/modules/forward/direct_forwarder.py`
  - æ–°å¢æ–¹æ³•ï¼š`_create_input_media_from_message()`
  - ä¿®æ”¹æ–¹æ³•ï¼š`forward_media_group_directly()` ä¸­çš„é‡ç»„é€»è¾‘

### ğŸ¯ ç”¨æˆ·ä»·å€¼ (User Value)
- **å®Œç¾åª’ä½“ç»„ä½“éªŒ**ï¼šé‡ç»„åçš„åª’ä½“ç»„åœ¨æ¥æ”¶ç«¯çœ‹èµ·æ¥ä¸åŸå§‹åª’ä½“ç»„å®Œå…¨ç›¸åŒ
- **æ ‡é¢˜æ§åˆ¶çµæ´»**ï¼šæ”¯æŒå®Œå…¨ç§»é™¤æ ‡é¢˜æˆ–å°†åŸå§‹æ ‡é¢˜åº”ç”¨åˆ°åª’ä½“ç»„
- **è¿‡æ»¤æ•ˆæœç²¾ç¡®**ï¼šåœ¨ä¿æŒåª’ä½“ç»„æ ¼å¼çš„åŒæ—¶ï¼Œç²¾ç¡®è¿‡æ»¤æ‰ä¸éœ€è¦çš„åª’ä½“ç±»å‹

---

## [v2.1.9.23] - 2024-12-22

### ğŸš¨ å…³é”®ä¿®å¤ (Critical Fix)

#### ä¿®å¤åª’ä½“ç»„è¿‡æ»¤è¢«ç»•è¿‡çš„ä¸¥é‡é—®é¢˜ (Fix Media Group Filter Bypass)
- **é—®é¢˜æè¿°**ï¼š
  - åª’ä½“ç»„ä¸­çš„è§†é¢‘ç­‰ä¸éœ€è¦çš„åª’ä½“ç±»å‹è¢«æ­£ç¡®è¿‡æ»¤ï¼Œä½†åœ¨è½¬å‘æ—¶ä»ç„¶è¢«è½¬å‘
  - è¿‡æ»¤å™¨å·¥ä½œæ­£å¸¸ï¼Œä½†è½¬å‘å™¨ä½¿ç”¨ `copy_media_group` æ–¹æ³•ç»•è¿‡äº†è¿‡æ»¤ç»“æœ
- **æ ¹æœ¬åŸå› **ï¼š
  - `copy_media_group` æ–¹æ³•åŸºäºåª’ä½“ç»„ä¸­ä»»æ„ä¸€æ¡æ¶ˆæ¯IDï¼Œä¼šè‡ªåŠ¨è·å–**æ•´ä¸ªåŸå§‹åª’ä½“ç»„**çš„æ‰€æœ‰æ¶ˆæ¯
  - å½“åª’ä½“ç»„è¢«éƒ¨åˆ†è¿‡æ»¤æ—¶ï¼Œé‡ç»„åˆ¤æ–­é€»è¾‘ `is_regrouped_media` å¯èƒ½ä¸º `False`
  - å¯¼è‡´ä½¿ç”¨ `copy_media_group` æˆ– `forward_messages` æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¼šå¿½ç•¥è¿‡æ»¤ç»“æœ
- **ä¿®å¤æ–¹æ¡ˆ**ï¼š
  - ğŸ”§ **å¼ºåˆ¶é‡ç»„æ¨¡å¼**ï¼šå½“æ£€æµ‹åˆ°åª’ä½“ç»„å‘ç”Ÿè¿‡æ»¤æ—¶ï¼ˆ`len(filtered_messages) != len(messages)`ï¼‰ï¼Œå¼ºåˆ¶ä½¿ç”¨é‡ç»„æ¨¡å¼
  - ğŸ“ **ç®€åŒ–åˆ¤æ–­é€»è¾‘**ï¼šç§»é™¤å¯¹ `original_media_group_id` çš„ä¾èµ–ï¼Œä»¥è¿‡æ»¤çŠ¶æ€ä¸ºå‡†
  - ğŸ¯ **ç¡®ä¿è¿‡æ»¤ç”Ÿæ•ˆ**ï¼šé‡ç»„æ¨¡å¼ä½¿ç”¨ `copy_message` é€æ¡è½¬å‘ï¼Œç¡®ä¿åªè½¬å‘é€šè¿‡è¿‡æ»¤çš„æ¶ˆæ¯
- **æŠ€æœ¯å®ç°**ï¼š
  ```python
  # ä¿®å¤å‰çš„æœ‰ç¼ºé™·çš„é€»è¾‘
  is_regrouped_media = (original_media_group_id and 
                       len(filtered_messages) > 1 and 
                       len(filtered_messages) < len(messages))
  
  # ä¿®å¤åçš„å¯é é€»è¾‘
  has_filtering = len(filtered_messages) != len(messages)
  is_regrouped_media = (has_filtering and len(filtered_messages) > 1)
  ```
- **å½±å“èŒƒå›´**ï¼š
  - âœ… å½»åº•è§£å†³åª’ä½“ç»„ä¸­è§†é¢‘ç­‰ä¸éœ€è¦ç±»å‹ä»è¢«è½¬å‘çš„é—®é¢˜
  - âœ… ç¡®ä¿åª’ä½“ç±»å‹è¿‡æ»¤100%ç”Ÿæ•ˆ
  - âœ… ä¿æŒæ–‡æœ¬å†…å®¹å’Œè½¬å‘åŠŸèƒ½çš„å®Œæ•´æ€§
- **æ–‡ä»¶ä½ç½®**ï¼š`src/modules/forward/direct_forwarder.py` - `forward_media_group_directly`æ–¹æ³•

---

## [v2.1.9.22] - 2024-12-22

### ğŸš€ é‡å¤§åŠŸèƒ½æ›´æ–° (Major Feature Updates)

#### ğŸ“Š æ¶ˆæ¯çº§åˆ«åª’ä½“ç±»å‹è¿‡æ»¤ (Message-level Media Type Filtering)
- **å®ç°ç²¾ç¡®çš„æ¶ˆæ¯çº§åˆ«è¿‡æ»¤**ï¼š
  - **é—®é¢˜è§£å†³**ï¼šä¿®å¤äº†åª’ä½“ç»„ä¸­è§†é¢‘ä»è¢«è½¬å‘çš„é—®é¢˜
  - **è¿‡æ»¤ç­–ç•¥å˜æ›´**ï¼šä»"åª’ä½“ç»„çº§åˆ«"è¿‡æ»¤æ”¹ä¸º"æ¶ˆæ¯çº§åˆ«"ç²¾ç¡®è¿‡æ»¤
  - **å…·ä½“è¡¨ç°**ï¼š
    - ä»¥å‰ï¼šåª’ä½“ç»„ `[photo, video, document]` ä¸­æœ‰å…è®¸çš„ `photo`ï¼Œæ•´ä¸ªç»„éƒ½è¢«è½¬å‘
    - ç°åœ¨ï¼šåªè½¬å‘ `photo` å’Œ `document`ï¼Œ`video` è¢«ç²¾ç¡®è¿‡æ»¤æ‰
  - **å®ç°ä½ç½®**ï¼š`src/modules/forward/message_filter.py` - `apply_media_type_filter`æ–¹æ³•

#### ğŸ”„ åª’ä½“ç»„æ–‡æœ¬é‡ç»„åŠŸèƒ½ (Media Group Text Reorganization)
- **æ™ºèƒ½åª’ä½“ç»„é‡ç»„**ï¼š
  - **è§¦å‘æ¡ä»¶**ï¼šå…³é”®è¯è¿‡æ»¤é€šè¿‡åï¼Œåª’ä½“ç±»å‹è¿‡æ»¤å¯¼è‡´åª’ä½“ç»„éƒ¨åˆ†æ¶ˆæ¯è¢«è¿‡æ»¤
  - **æ–‡æœ¬ä¿å­˜æœºåˆ¶**ï¼šåœ¨å…³é”®è¯è¿‡æ»¤é˜¶æ®µä¿å­˜åª’ä½“ç»„çš„åŸå§‹æ–‡æœ¬å†…å®¹
  - **é‡ç»„è½¬å‘é€»è¾‘**ï¼š
    - ä¿ç•™é€šè¿‡è¿‡æ»¤çš„åª’ä½“æ–‡ä»¶
    - å°†åŸå§‹æ–‡æœ¬ï¼ˆæˆ–æ–‡æœ¬æ›¿æ¢åçš„å†…å®¹ï¼‰ä½œä¸ºç¬¬ä¸€æ¡æ¶ˆæ¯çš„æ ‡é¢˜
    - å…¶ä½™æ¶ˆæ¯ä¸å¸¦æ ‡é¢˜ï¼Œå½¢æˆæ–°çš„åª’ä½“ç»„
  - **å®ç°ä½ç½®**ï¼š
    - `src/modules/forward/message_filter.py` - `apply_keyword_filter_with_text_processing`æ–¹æ³•
    - `src/modules/forward/direct_forwarder.py` - `forward_media_group_directly`æ–¹æ³•

#### ğŸ”§ è¿‡æ»¤é€»è¾‘ä¼˜åŒ– (Filter Logic Optimization)
- **åˆ é™¤åºŸå¼ƒçš„è¿‡æ»¤è§„åˆ™**ï¼š
  - ç§»é™¤è½¬å‘æ¶ˆæ¯è¿‡æ»¤ï¼ˆ`exclude_forwards`ï¼‰
  - ç§»é™¤å›å¤æ¶ˆæ¯è¿‡æ»¤ï¼ˆ`exclude_replies`ï¼‰
  - è¿™äº›åŠŸèƒ½å·²è¢«èˆå¼ƒï¼Œç®€åŒ–è¿‡æ»¤é€»è¾‘
- **è¿‡æ»¤é¡ºåºè°ƒæ•´**ï¼š
  - **æ–°é¡ºåº**ï¼šé€šç”¨è¿‡æ»¤è§„åˆ™ â†’ å…³é”®è¯è¿‡æ»¤ â†’ åª’ä½“ç±»å‹è¿‡æ»¤
  - **æ—§é¡ºåº**ï¼šå…³é”®è¯è¿‡æ»¤ â†’ é€šç”¨è¿‡æ»¤è§„åˆ™ â†’ åª’ä½“ç±»å‹è¿‡æ»¤
  - ä¼˜åŒ–å¤„ç†æ•ˆç‡ï¼Œå…ˆè¿‡æ»¤æ˜æ˜¾ä¸ç¬¦åˆçš„æ¶ˆæ¯

### ğŸ› ï¸ æŠ€æœ¯å®ç°ç»†èŠ‚ (Technical Implementation)

#### æ¶ˆæ¯è¿‡æ»¤å™¨å¢å¼º
- **æ–°å¢æ–¹æ³•**ï¼š
  - `apply_keyword_filter_with_text_processing()`ï¼šå¸¦æ–‡æœ¬å¤„ç†çš„å…³é”®è¯è¿‡æ»¤
  - è¿”å›å€¼åŒ…å«åª’ä½“ç»„æ–‡æœ¬æ˜ å°„ï¼š`Dict[str, str]`
- **ä¿®æ”¹æ–¹æ³•**ï¼š
  - `apply_media_type_filter()`ï¼šæ”¹ä¸ºæ¶ˆæ¯çº§åˆ«ç²¾ç¡®è¿‡æ»¤
  - `apply_all_filters()`ï¼šé›†æˆæ–°çš„è¿‡æ»¤æµç¨‹å’Œæ–‡æœ¬å¤„ç†

#### ç›´æ¥è½¬å‘å™¨å¢å¼º
- **é‡ç»„åª’ä½“ç»„å¤„ç†**ï¼š
  - æ£€æµ‹ `is_regrouped_media`ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºé‡ç»„çš„åª’ä½“ç»„
  - æ™ºèƒ½è½¬å‘ç­–ç•¥ï¼šå•ç‹¬å‘é€æ¯æ¡æ¶ˆæ¯ï¼Œç¬¬ä¸€æ¡å¸¦ç»Ÿä¸€æ ‡é¢˜
  - å»¶è¿Ÿæ§åˆ¶ï¼šæ¶ˆæ¯é—´0.2ç§’å»¶è¿Ÿé¿å…é¢‘ç‡é™åˆ¶

#### åª’ä½“ç»„æ”¶é›†å™¨æ›´æ–°
- **ç»Ÿä¸€è¿‡æ»¤åº”ç”¨**ï¼š
  - æ‰€æœ‰è·å–æ–¹æ³•éƒ½ä½¿ç”¨æ–°çš„ `apply_all_filters()` æ–¹æ³•
  - ç§»é™¤æ—§çš„ `is_media_allowed()` æ–¹æ³•è°ƒç”¨
  - ä¿æŒè¿‡æ»¤é€»è¾‘ä¸€è‡´æ€§

### ğŸ“ˆ æ€§èƒ½ä¸ä½“éªŒæå‡ (Performance & UX Improvements)

#### æ—¥å¿—ä¼˜åŒ–
- **è¿‡æ»¤ç»“æœå±•ç¤º**ï¼š
  - æ˜¾ç¤ºåª’ä½“ç»„éƒ¨åˆ†è¿‡æ»¤çš„è¯¦ç»†ä¿¡æ¯
  - è®°å½•é‡ç»„åª’ä½“ç»„çš„è½¬å‘è¿‡ç¨‹
  - æä¾›æ¸…æ™°çš„è¿‡æ»¤ç»Ÿè®¡ä¿¡æ¯

#### è½¬å‘ä½“éªŒ
- **ç²¾ç¡®æ§åˆ¶**ï¼šç”¨æˆ·å¯ä»¥ç²¾ç¡®æ§åˆ¶è½¬å‘çš„åª’ä½“ç±»å‹
- **æ–‡æœ¬ä¿æŒ**ï¼šåª’ä½“ç»„é‡ç»„åä¿æŒåŸå§‹æ–‡æœ¬ä¿¡æ¯
- **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤æ‚çš„è¿‡æ»¤å’Œè½¬å‘éœ€æ±‚

### ğŸ” é…ç½®å½±å“ (Configuration Impact)
- **å‘åå…¼å®¹**ï¼šç°æœ‰é…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹
- **åŠŸèƒ½å¢å¼º**ï¼šåª’ä½“ç±»å‹è¿‡æ»¤æ›´åŠ ç²¾ç¡®æœ‰æ•ˆ
- **åºŸå¼ƒå­—æ®µ**ï¼š`exclude_forwards`å’Œ`exclude_replies`å­—æ®µä¸å†ä½¿ç”¨ï¼ˆä¿ç•™å…¼å®¹æ€§ï¼‰

### ğŸ¯ ç”¨æˆ·ä»·å€¼ (User Value)
- **ç²¾ç¡®è¿‡æ»¤**ï¼šå½»åº•è§£å†³è§†é¢‘è¯¯è½¬å‘é—®é¢˜
- **æ™ºèƒ½é‡ç»„**ï¼šä¿æŒå†…å®¹å®Œæ•´æ€§çš„åŒæ—¶ç²¾ç¡®è¿‡æ»¤
- **ç®€åŒ–é…ç½®**ï¼šç§»é™¤ä¸å¿…è¦çš„è¿‡æ»¤é€‰é¡¹ï¼Œé™ä½é…ç½®å¤æ‚åº¦

---

## [v2.1.9.21] - 2024-12-22

### ğŸ› å…³é”®é…ç½®åŠ è½½ä¿®å¤ (Critical Configuration Loading Fix)
- **ä¿®å¤exclude_linksé…ç½®åŠ è½½é—®é¢˜**
  - **é—®é¢˜æ ¹æº**ï¼šUIé…ç½®ç®¡ç†å™¨åœ¨è½¬æ¢é¢‘é“å¯¹é…ç½®æ—¶é—æ¼äº†`exclude_links`å­—æ®µçš„å¤„ç†
  - **ç—‡çŠ¶æè¿°**ï¼š
    - é…ç½®æ–‡ä»¶ä¸­`exclude_links: true`
    - è½¬å‘ç•Œé¢æ˜¾ç¤º`exclude_links: false`
    - ç•Œé¢å¤é€‰æ¡†çŠ¶æ€ä¸æ­£ç¡®
    - é¢‘é“å¯¹åˆ—è¡¨ä¸­ä¸æ˜¾ç¤º"æ’é™¤é“¾æ¥"é€‰é¡¹
  - **æ ¹æœ¬ä¿®å¤**ï¼š
    - âœ… **src/utils/ui_config_manager.py**ï¼šåœ¨`_convert_to_ui_config`æ–¹æ³•ä¸­æ·»åŠ `exclude_links`å­—æ®µå¤„ç†
    - âœ… ç¡®ä¿è½¬å‘é¢‘é“å¯¹é…ç½®ä¸­`exclude_links`å­—æ®µè¢«æ­£ç¡®ä»JSONé…ç½®æ–‡ä»¶è¯»å–
    - âœ… ä¿®å¤é»˜è®¤é¢‘é“å¯¹æ¨¡æ¿ä¹ŸåŒ…å«`exclude_links`å­—æ®µ
  - **éªŒè¯ç»“æœ**ï¼š
    - âœ… é…ç½®æ–‡ä»¶ä¸­çš„`exclude_links: true`æ­£ç¡®ä¼ é€’åˆ°ç•Œé¢
    - âœ… ä¸»ç•Œé¢"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"å¤é€‰æ¡†æ­£ç¡®å‹¾é€‰
    - âœ… é¢‘é“å¯¹åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º"æ’é™¤é“¾æ¥"é€‰é¡¹
    - âœ… ç¼–è¾‘å¯¹è¯æ¡†ä¸­å¤é€‰æ¡†çŠ¶æ€æ­£ç¡®

### ğŸ”§ æŠ€æœ¯æ”¹è¿› (Technical Improvements)
- **é…ç½®ä¸€è‡´æ€§ä¿éšœ**ï¼š
  - ç¡®ä¿UIé…ç½®æ¨¡å‹ä¸é…ç½®æ–‡ä»¶ä¹‹é—´çš„å­—æ®µå®Œå…¨ä¸€è‡´
  - é¿å…é…ç½®å­—æ®µåœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¸¢å¤±
  - æé«˜é…ç½®åŠ è½½çš„å¯é æ€§

### ğŸ“ é‡è¦æé†’ (Important Note)
- **æ­¤ä¿®å¤è§£å†³äº†v2.1.9.20ä¸­é—ç•™çš„é…ç½®æ˜¾ç¤ºé—®é¢˜**
- **æ‰€æœ‰`exclude_links`ç›¸å…³åŠŸèƒ½ç°åœ¨å®Œå…¨æ­£å¸¸å·¥ä½œ**
- **å»ºè®®é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºä»¥ç¡®ä¿ä¿®å¤ç”Ÿæ•ˆ**

---

## [v2.1.9.20] - 2024-12-22

### ğŸ› é‡è¦ä¿®å¤ (Critical Bug Fix)
- **è½¬å‘æ¨¡å—exclude_linksé…ç½®æ˜¾ç¤ºä¿®å¤**
  - **é—®é¢˜æè¿°**ï¼šé…ç½®æ–‡ä»¶ä¸­`exclude_links`ä¸º`true`ï¼Œä½†ç¨‹åºå¯åŠ¨åç•Œé¢æ˜¾ç¤ºä¸æ­£ç¡®
    - å·²é…ç½®é¢‘é“å¯¹æ»šåŠ¨åŒºåŸŸä¸­æ²¡æœ‰æ˜¾ç¤º"æ’é™¤é“¾æ¥"é€‰é¡¹
    - å³é”®ç¼–è¾‘èœå•ä¸­"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"å¤é€‰æ¡†æ²¡æœ‰å‹¾é€‰
    - ä¸»ç•Œé¢çš„"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"å¤é€‰æ¡†é»˜è®¤æœªå‹¾é€‰
  - **æ ¹æœ¬åŸå› **ï¼šè½¬å‘ç•Œé¢çš„é…ç½®åŠ è½½å’Œæ˜¾ç¤ºé€»è¾‘å­˜åœ¨å¤šå¤„é—æ¼
  - **ä¿®å¤å†…å®¹**ï¼š
    - âœ… ä¿®å¤`load_config`æ–¹æ³•ï¼Œæ­£ç¡®åŠ è½½`exclude_links`é…ç½®åˆ°ä¸»ç•Œé¢å¤é€‰æ¡†
    - âœ… ä¿®å¤`_update_channel_pair_display`æ–¹æ³•ï¼Œæ­£ç¡®æ˜¾ç¤º`exclude_links`çŠ¶æ€
    - âœ… ä¿®å¤`_add_channel_pair`æ–¹æ³•ï¼Œç¡®ä¿æ–°æ·»åŠ çš„é¢‘é“å¯¹æ­£ç¡®æ˜¾ç¤º`exclude_links`é€‰é¡¹
    - âœ… å°†ä¸»ç•Œé¢çš„"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"å¤é€‰æ¡†é»˜è®¤è®¾ç½®ä¸ºå‹¾é€‰çŠ¶æ€ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨

### ğŸ”§ æŠ€æœ¯æ”¹è¿› (Technical Improvements)
- **é…ç½®åŠ è½½é€»è¾‘ä¼˜åŒ–**ï¼š
  - åœ¨`load_config`æ–¹æ³•ä¸­æ·»åŠ äº†`first_pair_exclude_links`å˜é‡è·Ÿè¸ªç¬¬ä¸€ä¸ªé¢‘é“å¯¹çš„`exclude_links`è®¾ç½®
  - ä½¿ç”¨ç¬¬ä¸€ä¸ªé¢‘é“å¯¹çš„`exclude_links`çŠ¶æ€è®¾ç½®ä¸»ç•Œé¢å¤é€‰æ¡†çš„é»˜è®¤å€¼
  - ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„`exclude_links`è®¾ç½®èƒ½æ­£ç¡®åæ˜ åœ¨ç•Œé¢ä¸Š
- **æ˜¾ç¤ºæ–‡æœ¬å®Œå–„**ï¼š
  - åœ¨`_update_channel_pair_display`æ–¹æ³•ä¸­æ·»åŠ äº†"æ’é™¤é“¾æ¥"é€‰é¡¹çš„æ˜¾ç¤º
  - åœ¨`_add_channel_pair`æ–¹æ³•ä¸­æ·»åŠ äº†"æ’é™¤é“¾æ¥"é€‰é¡¹çš„æ˜¾ç¤º
  - ç¡®ä¿é¢‘é“å¯¹åˆ—è¡¨ä¸­èƒ½å®Œæ•´æ˜¾ç¤ºæ‰€æœ‰è½¬å‘é€‰é¡¹
- **ç”¨æˆ·ä½“éªŒæå‡**ï¼š
  - ä¸»ç•Œé¢çš„"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"å¤é€‰æ¡†é»˜è®¤å‹¾é€‰ï¼Œç¬¦åˆå¤§å¤šæ•°ç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯
  - é…ç½®åŠ è½½åç•Œé¢çŠ¶æ€ä¸é…ç½®æ–‡ä»¶ä¿æŒå®Œå…¨ä¸€è‡´

### ğŸ“Š ä¿®å¤éªŒè¯ (Fix Verification)
- **ä¿®å¤å‰ç—‡çŠ¶**ï¼š
  ```
  - é…ç½®æ–‡ä»¶: "exclude_links": true
  - ç•Œé¢æ˜¾ç¤º: å¤é€‰æ¡†æœªå‹¾é€‰
  - é¢‘é“å¯¹åˆ—è¡¨: æ— "æ’é™¤é“¾æ¥"é€‰é¡¹æ˜¾ç¤º
  ```
- **ä¿®å¤åæ•ˆæœ**ï¼š
  ```
  - é…ç½®æ–‡ä»¶: "exclude_links": true
  - ç•Œé¢æ˜¾ç¤º: å¤é€‰æ¡†æ­£ç¡®å‹¾é€‰
  - é¢‘é“å¯¹åˆ—è¡¨: æ­£ç¡®æ˜¾ç¤º"æ’é™¤é“¾æ¥"é€‰é¡¹
  ```

### ğŸ¯ ç”¨æˆ·å½±å“ (User Impact)
- **é…ç½®ä¸€è‡´æ€§**ï¼šç•Œé¢æ˜¾ç¤ºä¸é…ç½®æ–‡ä»¶å®Œå…¨åŒæ­¥ï¼Œé¿å…ç”¨æˆ·å›°æƒ‘
- **æ“ä½œä¾¿åˆ©æ€§**ï¼šé»˜è®¤å‹¾é€‰"æ’é™¤å«é“¾æ¥æ¶ˆæ¯"ï¼Œå‡å°‘ç”¨æˆ·é…ç½®æ­¥éª¤
- **åŠŸèƒ½å¯è§æ€§**ï¼šé¢‘é“å¯¹åˆ—è¡¨ä¸­æ¸…æ™°æ˜¾ç¤ºæ‰€æœ‰è½¬å‘é€‰é¡¹ï¼Œä¾¿äºç”¨æˆ·æ£€æŸ¥é…ç½®

---

## [v2.1.9.19] - 2024-12-22

### ä¿®å¤
- **è½¬å‘æ¨¡å—éšè—ä½œè€…åŠŸèƒ½ä¿®å¤**
  - ä¿®å¤äº†é¢‘é“å¯¹çš„`hide_author`é…ç½®ä¸ç”Ÿæ•ˆçš„é—®é¢˜
  - ä¿®å¤äº†ä»£ç ä»å…¨å±€é…ç½®è¯»å–`hide_author`è€Œä¸æ˜¯ä»é¢‘é“å¯¹é…ç½®è¯»å–çš„bug
  - ç°åœ¨æ¯ä¸ªé¢‘é“å¯¹å¯ä»¥ç‹¬ç«‹æ§åˆ¶æ˜¯å¦éšè—ä½œè€…
  - æ·»åŠ äº†è°ƒè¯•æ—¥å¿—æ˜¾ç¤ºæ¯ä¸ªé¢‘é“å¯¹çš„`hide_author`é…ç½®çŠ¶æ€

### æŠ€æœ¯æ”¹è¿›
- å°†`hide_author`å‚æ•°ä»`self.forward_config.get('hide_author', False)`æ”¹ä¸º`pair.get('hide_author', False)`
- ä¸ºæ¯ä¸ªé¢‘é“å¯¹æ·»åŠ äº†è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œä¾¿äºæ’æŸ¥é…ç½®é—®é¢˜
- ç¡®ä¿é¢‘é“å¯¹çº§åˆ«çš„é…ç½®ä¼˜å…ˆçº§é«˜äºå…¨å±€é…ç½®

## [v2.1.9.18] - 2024-12-22

### ä¿®å¤
- **è½¬å‘æ¨¡å—æœ€ç»ˆæ¶ˆæ¯å‘é€é€»è¾‘ä¿®å¤**
  - ä¿®å¤äº†ç¦ç”¨é¢‘é“å¯¹ä»ç„¶å‘é€æœ€ç»ˆæ¶ˆæ¯çš„é—®é¢˜
  - ä¿®å¤äº†æ²¡æœ‰å®é™…è½¬å‘æ¶ˆæ¯çš„é¢‘é“å¯¹ä¹Ÿå‘é€æœ€ç»ˆæ¶ˆæ¯çš„é—®é¢˜
  - ç°åœ¨åªæœ‰å¯ç”¨ä¸”å®é™…è½¬å‘äº†æ¶ˆæ¯çš„é¢‘é“å¯¹æ‰ä¼šå‘é€æœ€ç»ˆæ¶ˆæ¯
  - æ·»åŠ äº†é¢‘é“å¯¹è½¬å‘çŠ¶æ€è·Ÿè¸ªæœºåˆ¶
  - ä¼˜åŒ–äº†æœ€ç»ˆæ¶ˆæ¯å‘é€çš„æ—¥å¿—è®°å½•ï¼Œæ›´æ¸…æ™°åœ°æ˜¾ç¤ºå‘é€åŸå› 

### æŠ€æœ¯æ”¹è¿›
- åœ¨`forward_messages`æ–¹æ³•ä¸­æ·»åŠ äº†`forwarded_pairs`è·Ÿè¸ªåˆ—è¡¨
- ä¸ºæ¯ä¸ªé¢‘é“å¯¹å•ç‹¬è®¡ç®—è½¬å‘è®¡æ•°ï¼ˆ`pair_forward_count`ï¼‰
- ä¿®æ”¹äº†`_send_final_messages_by_pairs`æ–¹æ³•çš„å‚æ•°å’Œé€»è¾‘
- æ·»åŠ äº†åŒé‡æ£€æŸ¥æœºåˆ¶ç¡®ä¿é¢‘é“å¯¹å¯ç”¨çŠ¶æ€
- æ”¹è¿›äº†æ—¥å¿—è®°å½•ï¼Œæ˜ç¡®æ˜¾ç¤ºå“ªäº›é¢‘é“å¯¹å®é™…è½¬å‘äº†æ¶ˆæ¯

## [v2.1.9.17] - 2024-12-22

### ä¿®å¤
- **è½¬å‘æ¨¡å—é¢‘é“å¯¹å¯ç”¨/ç¦ç”¨åŠŸèƒ½ä¿®å¤**
  - ä¿®å¤äº†ç‚¹å‡»ç¦ç”¨åä¿å­˜é…ç½®æ—¶`enabled`å­—æ®µæ²¡æœ‰æ­£ç¡®ä¿å­˜çš„é—®é¢˜
  - ä¿®å¤äº†ä¿å­˜é…ç½®å"å·²ç¦ç”¨"æ ‡è¯†æ¶ˆå¤±çš„é—®é¢˜
  - ç§»é™¤äº†ç¼–è¾‘å¯¹è¯æ¡†ä¸­çš„å¯ç”¨/ç¦ç”¨å¤é€‰æ¡†ï¼Œç®€åŒ–æ“ä½œæµç¨‹
  - ç°åœ¨å¯ç”¨/ç¦ç”¨åŠŸèƒ½åªèƒ½é€šè¿‡å³é”®èœå•æ“ä½œï¼Œé¿å…æ··æ·†

### æŠ€æœ¯æ”¹è¿›
- ä¼˜åŒ–äº†é…ç½®ä¿å­˜é€»è¾‘ï¼Œé¿å…ä¸å¿…è¦çš„UIçŠ¶æ€é‡æ–°åŠ è½½
- ç¡®ä¿åœ¨ä¿å­˜é…ç½®æ—¶æ­£ç¡®å¤„ç†æ‰€æœ‰é¢‘é“å¯¹çš„`enabled`å­—æ®µ
- ä¿æŒäº†å‘åå…¼å®¹æ€§ï¼Œæ—§é…ç½®æ–‡ä»¶è‡ªåŠ¨è¿ç§»

## [v2.1.9.16] - 2025-01-22

### âœ¨ æ–°åŠŸèƒ½ (New Features)
- **é¢‘é“å¯¹ç¦ç”¨/å¯ç”¨åŠŸèƒ½**ï¼šä¸ºè½¬å‘æ¨¡å—æ·»åŠ é¢‘é“å¯¹ç®¡ç†åŠŸèƒ½
  - **å³é”®èœå•å¢å¼º**ï¼šåœ¨é¢‘é“å¯¹åˆ—è¡¨çš„å³é”®èœå•ä¸­æ·»åŠ "ç¦ç”¨"/"å¯ç”¨"é€‰é¡¹
  - **æ™ºèƒ½çŠ¶æ€åˆ‡æ¢**ï¼šæ ¹æ®å½“å‰çŠ¶æ€æ˜¾ç¤ºå¯¹åº”çš„èœå•é¡¹ï¼ˆç¦ç”¨â†”å¯ç”¨ï¼‰
  - **è§†è§‰çŠ¶æ€æ ‡è¯†**ï¼šç¦ç”¨çš„é¢‘é“å¯¹åœ¨åˆ—è¡¨ä¸­æ˜¾ç¤º`[å·²ç¦ç”¨]`å‰ç¼€
  - **è½¬å‘é€»è¾‘ä¼˜åŒ–**ï¼šè½¬å‘æ—¶è‡ªåŠ¨è·³è¿‡è¢«ç¦ç”¨çš„é¢‘é“å¯¹ï¼Œå¹¶è®°å½•è·³è¿‡æ—¥å¿—
  - **é…ç½®æŒä¹…åŒ–**ï¼šç¦ç”¨/å¯ç”¨çŠ¶æ€ä¼šä¿å­˜åˆ°é…ç½®æ–‡ä»¶ä¸­

### ğŸ”§ æŠ€æœ¯å®ç° (Technical Implementation)
- **UIé…ç½®æ¨¡å‹æ›´æ–°**ï¼š
  - åœ¨ `UIChannelPair` æ¨¡å‹ä¸­æ·»åŠ  `enabled: bool` å­—æ®µï¼ˆé»˜è®¤ `True`ï¼‰
  - åœ¨ç¼–è¾‘å¯¹è¯æ¡†ä¸­æ·»åŠ "å¯ç”¨æ­¤é¢‘é“å¯¹"å¤é€‰æ¡†
- **é…ç½®è½¬æ¢å¢å¼º**ï¼š
  - åœ¨ `config_utils.py` çš„ `filter_field` åˆ—è¡¨ä¸­æ·»åŠ  `"enabled"` å­—æ®µ
  - ç¡®ä¿UIé…ç½®æ­£ç¡®è½¬æ¢ä¸ºå†…éƒ¨é…ç½®æ ¼å¼
- **è½¬å‘å™¨é€»è¾‘ä¼˜åŒ–**ï¼š
  - åœ¨ `forwarder.py` ä¸­æ·»åŠ  `enabled` çŠ¶æ€æ£€æŸ¥
  - è·³è¿‡ç¦ç”¨é¢‘é“å¯¹å¹¶è®°å½•æ—¥å¿—ï¼š"è·³è¿‡å·²ç¦ç”¨çš„é¢‘é“å¯¹: {æºé¢‘é“}"
- **UIäº¤äº’å®Œå–„**ï¼š
  - æ·»åŠ  `_toggle_channel_pair_enabled` æ–¹æ³•å¤„ç†çŠ¶æ€åˆ‡æ¢
  - åˆ›å»ºç»Ÿä¸€çš„ `_update_channel_pair_display` æ–¹æ³•æ›´æ–°æ˜¾ç¤º
  - åœ¨çŠ¶æ€åˆ‡æ¢åæ˜¾ç¤ºç¡®è®¤æ¶ˆæ¯æç¤º

### ğŸ¯ ç”¨æˆ·ä½“éªŒæå‡ (UX Improvements)
- **å¿«é€Ÿç®¡ç†**ï¼šæ— éœ€åˆ é™¤é¢‘é“å¯¹ï¼Œå¯ä»¥ä¸´æ—¶ç¦ç”¨ä¸éœ€è¦çš„è½¬å‘è§„åˆ™
- **çŠ¶æ€å¯è§†åŒ–**ï¼šæ¸…æ™°çš„è§†è§‰åé¦ˆï¼Œä¸€ç›®äº†ç„¶å“ªäº›é¢‘é“å¯¹å·²ç¦ç”¨
- **æ“ä½œæç¤º**ï¼šçŠ¶æ€åˆ‡æ¢åæ˜¾ç¤ºç¡®è®¤æ¶ˆæ¯ï¼Œæé†’ç”¨æˆ·ä¿å­˜é…ç½®
- **å‘åå…¼å®¹**ï¼šæ—§é…ç½®æ–‡ä»¶è‡ªåŠ¨å…¼å®¹ï¼Œæœªè®¾ç½® `enabled` å­—æ®µçš„é¢‘é“å¯¹é»˜è®¤å¯ç”¨

### ğŸ“ æ–‡æ¡£æ›´æ–° (Documentation)
- **README.md**ï¼šæ·»åŠ é¢‘é“å¯¹ç®¡ç†åŠŸèƒ½ç« èŠ‚ï¼Œè¯¦ç»†è¯´æ˜ç¦ç”¨/å¯ç”¨åŠŸèƒ½
- **é…ç½®ç¤ºä¾‹**ï¼šæ›´æ–°JSONé…ç½®ç¤ºä¾‹ï¼ŒåŒ…å« `enabled` å­—æ®µ
- **æ“ä½œæŒ‡å—**ï¼šæ·»åŠ å³é”®èœå•æ“ä½œè¯´æ˜å’ŒçŠ¶æ€åˆ‡æ¢æµç¨‹

### ğŸ”„ å…¼å®¹æ€§ä¿è¯ (Compatibility)
- **å‘åå…¼å®¹**ï¼šæ—§é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰ `enabled` å­—æ®µçš„é¢‘é“å¯¹é»˜è®¤ä¸ºå¯ç”¨çŠ¶æ€
- **é…ç½®è¿ç§»**ï¼šæ–°ç‰ˆæœ¬åŠ è½½æ—§é…ç½®æ—¶è‡ªåŠ¨æ·»åŠ  `enabled: true` å­—æ®µ
- **æ•°æ®å®Œæ•´æ€§**ï¼šç¦ç”¨çŠ¶æ€çš„åˆ‡æ¢ä¸å½±å“å…¶ä»–é…ç½®å‚æ•°

### ğŸš¨ ç´§æ€¥ä¿®å¤ (Hotfix)
- **ä¿®å¤è½¬å‘è§†å›¾åˆå§‹åŒ–é”™è¯¯**ï¼š
  - **é—®é¢˜**ï¼šåœ¨ä¸»é…ç½®é¢æ¿åˆ›å»ºè¿‡ç¨‹ä¸­å¼•ç”¨äº†æœªå®šä¹‰çš„ `channel_pair` å˜é‡ï¼Œå¯¼è‡´è½¬å‘è§†å›¾æ— æ³•æ­£å¸¸åŠ è½½
  - **åŸå› **ï¼šåœ¨æ·»åŠ å¯ç”¨/ç¦ç”¨åŠŸèƒ½æ—¶ï¼Œé”™è¯¯åœ°å°†ç¼–è¾‘å¯¹è¯æ¡†çš„ä»£ç æ”¾åˆ°äº†ä¸»é…ç½®é¢æ¿ä¸­
  - **ä¿®å¤**ï¼šç§»é™¤ä¸»é…ç½®é¢æ¿ä¸­å¯¹ `channel_pair` å˜é‡çš„å¼•ç”¨ï¼Œæ¢å¤æ­£å¸¸çš„é»˜è®¤å€¼è®¾ç½®
  - **å½±å“**ï¼šç¡®ä¿è½¬å‘æ¨¡å—å¯ä»¥æ­£å¸¸è®¿é—®å’Œä½¿ç”¨

---

## [v2.1.9.15] - 2025-01-22

### ğŸ§¹ ä»£ç æ¸…ç† (Code Cleanup)
- **åˆ é™¤è°ƒè¯•æ—¥å¿—**ï¼šç§»é™¤ä¸ºè§£å†³æœ€ç»ˆæ¶ˆæ¯å‘é€é—®é¢˜è€Œæ·»åŠ çš„è¯¦ç»†è°ƒè¯•æ—¥å¿—
  - æ¸…ç† `_send_final_messages_by_pairs` æ–¹æ³•ä¸­çš„è¯¦ç»†é…ç½®è°ƒè¯•ä¿¡æ¯
  - æ¸…ç† `forward_messages` æ–¹æ³•ä¸­çš„é…ç½®åŠ è½½è°ƒè¯•ä¿¡æ¯
  - ä¿ç•™å¿…è¦çš„åŸºç¡€æ‰§è¡Œæ—¥å¿—ï¼Œæé«˜æ—¥å¿—å¯è¯»æ€§
  - å°†éƒ¨åˆ†ä¿¡æ¯çº§åˆ«æ—¥å¿—é™çº§ä¸ºè°ƒè¯•çº§åˆ«ï¼Œå‡å°‘æ—¥å¿—è¾“å‡º

### ğŸ“š æ–‡æ¡£æ›´æ–° (Documentation Updates)
- **é‡è¦å¼€å‘æ³¨æ„äº‹é¡¹**ï¼šåœ¨å¤šä¸ªæ–‡æ¡£ä¸­æ·»åŠ é…ç½®è½¬æ¢çš„é‡è¦æé†’
  - æ›´æ–° `README.md`ï¼šæ·»åŠ å¼€å‘æ³¨æ„äº‹é¡¹éƒ¨åˆ†ï¼Œè¯¦ç»†è¯´æ˜é…ç½®è½¬æ¢è§„åˆ™
  - æ›´æ–° `CHANGELOG.md`ï¼šåœ¨v2.1.9.14ç‰ˆæœ¬ä¸­æ·»åŠ é…ç½®è½¬æ¢æ³¨æ„äº‹é¡¹
  - æ›´æ–° `.cursorrules`ï¼šåœ¨ç¼–ç è§„åˆ™ä¸­æ·»åŠ é…ç½®è½¬æ¢é‡è¦æé†’
  - **æ ¸å¿ƒæé†’**ï¼šUIæ¨¡å‹ + é…ç½®è½¬æ¢ + åŠŸèƒ½å®ç° ä¸‰æ­¥éƒ½è¦å®Œæˆ

### ğŸ¯ ç»éªŒæ€»ç»“ (Lessons Learned)
- **é…ç½®è½¬æ¢è§„åˆ™**ï¼š
  - å½“åœ¨UIæ¨¡å‹ä¸­æ·»åŠ æ–°çš„é…ç½®å­—æ®µæ—¶ï¼Œå¿…é¡»åŒæ—¶åœ¨ `src/utils/config_utils.py` çš„ `convert_ui_config_to_dict` å‡½æ•°ä¸­æ·»åŠ å¯¹åº”çš„è½¬æ¢é€»è¾‘
  - é¢‘é“å¯¹é…ç½®å­—æ®µéœ€è¦åœ¨ `filter_field` åˆ—è¡¨ä¸­æ·»åŠ 
  - ç‰¹æ®Šå­—æ®µï¼ˆå¦‚æ–‡ä»¶è·¯å¾„ï¼‰éœ€è¦å•ç‹¬å¤„ç†
  - **å¸¸è§é—æ¼**ï¼šåªåœ¨UIä¸­æ·»åŠ å­—æ®µï¼Œå¿˜è®°é…ç½®è½¬æ¢ï¼Œå¯¼è‡´è¿è¡Œæ—¶é…ç½®ä¸¢å¤±

### ğŸ”§ ç»´æŠ¤æ€§æå‡ (Maintainability)
- **é˜²æ­¢é‡å¤é—®é¢˜**ï¼šé€šè¿‡æ–‡æ¡£åŒ–é…ç½®è½¬æ¢è§„åˆ™ï¼Œé¿å…å°†æ¥å†æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜
- **å¼€å‘æµç¨‹è§„èŒƒ**ï¼šæ˜ç¡®UIé…ç½®åˆ°å†…éƒ¨é…ç½®çš„è½¬æ¢æ˜¯å¿…é¡»æ­¥éª¤
- **ä»£ç å¯è¯»æ€§**ï¼šæ¸…ç†å†—ä½™æ—¥å¿—ï¼Œä¿æŒä»£ç ç®€æ´

### ğŸ¯ é€»è¾‘ä¼˜åŒ– (Logic Optimization)
- **æœ€ç»ˆæ¶ˆæ¯å‘é€é€»è¾‘ä¼˜åŒ–**ï¼šåªæœ‰åœ¨å®é™…è½¬å‘äº†æ¶ˆæ¯æ—¶æ‰å‘é€æœ€ç»ˆæ¶ˆæ¯
  - ä¿®å¤äº†å³ä½¿æ²¡æœ‰è½¬å‘ä»»ä½•æ¶ˆæ¯ï¼Œä»ä¼šå‘é€æœ€ç»ˆæ¶ˆæ¯çš„é—®é¢˜
  - æ–°é€»è¾‘ï¼š`total_forward_count > 0` æ—¶æ‰æ‰§è¡Œæœ€ç»ˆæ¶ˆæ¯å‘é€
  - æ—¥å¿—æç¤ºï¼šæ²¡æœ‰è½¬å‘æ¶ˆæ¯æ—¶æ˜¾ç¤º"æ²¡æœ‰è½¬å‘ä»»ä½•æ¶ˆæ¯ï¼Œè·³è¿‡æœ€ç»ˆæ¶ˆæ¯å‘é€"
  - ç”¨æˆ·ä½“éªŒæ”¹è¿›ï¼šé¿å…åœ¨æ— æ•ˆè½¬å‘åå‘é€ä¸å¿…è¦çš„æœ€ç»ˆæ¶ˆæ¯

---

## [v2.1.9.14] - 2025-01-22

### ğŸ› é‡è¦ä¿®å¤ (Critical Bug Fix)
- **ä¿®å¤è½¬å‘æ¨¡å—é…ç½®è½¬æ¢ä¸¢å¤±å…³é”®å­—æ®µ**
  - **é—®é¢˜æè¿°**ï¼šåœ¨é…ç½®ä»UIæ¨¡å‹è½¬æ¢ä¸ºå­—å…¸æ—¶ï¼Œ`hide_author`ã€`send_final_message` å’Œ `final_message_html_file` å­—æ®µè¢«é—æ¼
  - **æ ¹æœ¬åŸå› **ï¼š`config_utils.py` ä¸­çš„ `convert_ui_config_to_dict` å‡½æ•°åªå¤„ç†äº†éƒ¨åˆ†å­—æ®µï¼Œå¯¼è‡´é‡è¦é…ç½®åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¸¢å¤±
  - **ä¿®å¤å†…å®¹**ï¼š
    - âœ… åœ¨ `filter_field` åˆ—è¡¨ä¸­æ·»åŠ  `"hide_author"` å’Œ `"send_final_message"` å­—æ®µ
    - âœ… å•ç‹¬å¤„ç† `"final_message_html_file"` å­—æ®µï¼Œç¡®ä¿HTMLæ–‡ä»¶è·¯å¾„æ­£ç¡®ä¼ é€’
    - âœ… ä¿æŒé…ç½®è½¬æ¢çš„å®Œæ•´æ€§ï¼Œæ‰€æœ‰UIé…ç½®éƒ½èƒ½æ­£ç¡®è½¬æ¢ä¸ºå†…éƒ¨æ ¼å¼

### ğŸ“Š å½±å“è¯´æ˜ (Impact)
- **ä¿®å¤å‰ç—‡çŠ¶**ï¼š
  ```
  - send_final_message: NOT_FOUND (ç±»å‹: <class 'NoneType'>)
  - final_message_html_file: NOT_FOUND
  - åŒ…å«çš„æ‰€æœ‰é”®: ['source_channel', 'target_channels', 'start_id', 'end_id', 'media_types', 'keywords', 'remove_captions', 'text_filter', 'text_replacements']
  ```
- **ä¿®å¤åæ•ˆæœ**ï¼š
  ```
  - send_final_message: true (ç±»å‹: <class 'bool'>)
  - final_message_html_file: E:/pythonProject/TG-Manager/final_message_example1.html
  - åŒ…å«çš„æ‰€æœ‰é”®: [..., 'hide_author', 'send_final_message', 'final_message_html_file', ...]
  ```

### ğŸ”§ æŠ€æœ¯ç»†èŠ‚ (Technical Details)
- **ä¿®å¤æ–‡ä»¶**ï¼š`src/utils/config_utils.py`
- **ä¿®å¤ä½ç½®**ï¼šç¬¬183-185è¡Œï¼Œé¢‘é“å¯¹é…ç½®è½¬æ¢é€»è¾‘
- **å˜æ›´å†…å®¹**ï¼š
  ```python
  # ä¿®å¤å‰
  for filter_field in ["exclude_forwards", "exclude_replies", "exclude_text", "exclude_links", "remove_captions"]:
  
  # ä¿®å¤å
  for filter_field in ["exclude_forwards", "exclude_replies", "exclude_text", "exclude_links", "remove_captions", "hide_author", "send_final_message"]:
  
  # æ–°å¢
  if hasattr(pair, 'final_message_html_file'):
      pair_dict['final_message_html_file'] = pair.final_message_html_file
  ```

### âœ… éªŒè¯æ–¹æ³• (Verification)
ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆï¼š
1. ç¡®ä¿ `config.json` ä¸­é¢‘é“å¯¹é…ç½®åŒ…å«æ‰€éœ€å­—æ®µ
2. è¿è¡Œè½¬å‘åŠŸèƒ½ï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­çš„é…ç½®åŠ è½½ä¿¡æ¯
3. ç¡®è®¤æœ€ç»ˆæ¶ˆæ¯å‘é€æ£€æŸ¥æ­¥éª¤æ­£å¸¸æ‰§è¡Œ

---

## [v2.1.9.13] - 2025-01-22

### ğŸš€ é‡è¦åŠŸèƒ½æ”¹è¿› (Major Feature Enhancement)
- **è½¬å‘æœ€ç»ˆæ¶ˆæ¯é…ç½®æ¶æ„é‡æ„**
  - **é‡å¤§å˜æ›´**ï¼šå°† `final_message_html_file` é…ç½®ä»å…¨å±€è½¬å‘é…ç½®ç§»åŠ¨åˆ°æ¯ä¸ªé¢‘é“å¯¹é…ç½®ä¸­
  - **æ–°ç‰¹æ€§**ï¼šæ¯ä¸ªé¢‘é“å¯¹ç°åœ¨å¯ä»¥é…ç½®è‡ªå·±çš„æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶
  - **çµæ´»æ€§æå‡**ï¼šä¸åŒé¢‘é“å¯¹å¯ä»¥å‘é€ä¸åŒçš„æœ€ç»ˆæ¶ˆæ¯å†…å®¹
  - **é…ç½®è¿ç§»**ï¼šè‡ªåŠ¨å°†ç°æœ‰çš„å…¨å±€é…ç½®è¿ç§»åˆ°é¢‘é“å¯¹é…ç½®ä¸­

### ğŸ”§ UIç•Œé¢æ”¹è¿› (UI Improvements)
- **é¢‘é“å¯¹ç¼–è¾‘å¯¹è¯æ¡†å¢å¼º**ï¼š
  - âœ… æ·»åŠ "æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶"å­—æ®µï¼Œæ”¯æŒæ¯ä¸ªé¢‘é“å¯¹ç‹¬ç«‹é…ç½®
  - âœ… é›†æˆæ–‡ä»¶æµè§ˆå™¨ï¼Œæ–¹ä¾¿é€‰æ‹©HTMLæ–‡ä»¶
  - âœ… å®æ—¶éªŒè¯æ–‡ä»¶è·¯å¾„æ ¼å¼
- **å…¨å±€é…ç½®ç®€åŒ–**ï¼š
  - âœ… ç§»é™¤è½¬å‘é€‰é¡¹æ ‡ç­¾é¡µä¸­çš„å…¨å±€HTMLæ–‡ä»¶é€‰æ‹©æ§ä»¶
  - âœ… ç®€åŒ–ç•Œé¢ç»“æ„ï¼Œé¿å…é…ç½®æ··æ·†

### ğŸ› ï¸ åç«¯é€»è¾‘ä¼˜åŒ– (Backend Logic Optimization)
- **è½¬å‘å™¨æ¶æ„æ”¹è¿›**ï¼š
  ```python
  # ä¿®æ”¹å‰ï¼šä½¿ç”¨å…¨å±€é…ç½®å‘é€æœ€ç»ˆæ¶ˆæ¯
  if self.forward_config.get('send_final_message', False):
      await self._send_final_message(all_target_channels)
  
  # ä¿®æ”¹åï¼šæŒ‰é¢‘é“å¯¹é…ç½®å‘é€æœ€ç»ˆæ¶ˆæ¯
  await self._send_final_messages_by_pairs(channel_pairs)
  ```
- **é…ç½®æ¨¡å‹æ›´æ–°**ï¼š
  - âœ… `UIChannelPair` æ¨¡å‹æ–°å¢ `final_message_html_file` å­—æ®µ
  - âœ… `UIForwardConfig` æ¨¡å‹ç§»é™¤å…¨å±€ `final_message_html_file` å­—æ®µ
  - âœ… æ·»åŠ ç›¸åº”çš„éªŒè¯å™¨ç¡®ä¿é…ç½®æœ‰æ•ˆæ€§

### ğŸ“‹ é…ç½®æ–‡ä»¶æ ¼å¼æ›´æ–° (Configuration Format Update)
- **æ–°çš„é¢‘é“å¯¹é…ç½®æ ¼å¼**ï¼š
  ```json
  {
    "source_channel": "@example",
    "target_channels": ["@target1", "@target2"],
    "send_final_message": true,
    "final_message_html_file": "/path/to/custom_message.html",
    // ... å…¶ä»–é…ç½®
  }
  ```
- **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰é…ç½®ä¼šè‡ªåŠ¨é€‚é…æ–°æ ¼å¼

### ğŸ¯ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ (Use Case Examples)
- **å¤šæ ·åŒ–è¥é”€**ï¼šä¸åŒé¢‘é“å¯¹å¯ä»¥å‘é€ä¸åŒçš„è¥é”€ä¿¡æ¯
- **å®šåˆ¶åŒ–æœåŠ¡**ï¼šä¸ºä¸åŒçš„ç›®æ ‡ç¾¤ä½“æä¾›å®šåˆ¶åŒ–çš„æœ€ç»ˆæ¶ˆæ¯
- **A/Bæµ‹è¯•**ï¼šåœ¨ä¸åŒé¢‘é“å¯¹ä¸­æµ‹è¯•ä¸åŒçš„æœ€ç»ˆæ¶ˆæ¯æ•ˆæœ

### âš ï¸ é‡è¦æé†’ (Important Notes)
- ç°æœ‰ç”¨æˆ·éœ€è¦é‡æ–°é…ç½®é¢‘é“å¯¹ä¸­çš„æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶è·¯å¾„
- å…¨å±€çš„HTMLæ–‡ä»¶é…ç½®å·²ç§»é™¤ï¼Œè¯·ä½¿ç”¨é¢‘é“å¯¹çº§åˆ«çš„é…ç½®

## [v2.1.9.12] - 2025-01-15

### ğŸš€ é‡è¦åŠŸèƒ½æ”¹è¿› (Major Feature Enhancement)
- **è½¬å‘æœ€ç»ˆæ¶ˆæ¯é…ç½®æ¶æ„é‡æ„**
  - **é‡å¤§å˜æ›´**ï¼šå°† `final_message_html_file` é…ç½®ä»å…¨å±€è½¬å‘é…ç½®ç§»åŠ¨åˆ°æ¯ä¸ªé¢‘é“å¯¹é…ç½®ä¸­
  - **æ–°ç‰¹æ€§**ï¼šæ¯ä¸ªé¢‘é“å¯¹ç°åœ¨å¯ä»¥é…ç½®è‡ªå·±çš„æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶
  - **çµæ´»æ€§æå‡**ï¼šä¸åŒé¢‘é“å¯¹å¯ä»¥å‘é€ä¸åŒçš„æœ€ç»ˆæ¶ˆæ¯å†…å®¹
  - **é…ç½®è¿ç§»**ï¼šè‡ªåŠ¨å°†ç°æœ‰çš„å…¨å±€é…ç½®è¿ç§»åˆ°é¢‘é“å¯¹é…ç½®ä¸­

### ğŸ”§ UIç•Œé¢æ”¹è¿› (UI Improvements)
- **é¢‘é“å¯¹ç¼–è¾‘å¯¹è¯æ¡†å¢å¼º**ï¼š
  - âœ… æ·»åŠ "æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶"å­—æ®µï¼Œæ”¯æŒæ¯ä¸ªé¢‘é“å¯¹ç‹¬ç«‹é…ç½®
  - âœ… é›†æˆæ–‡ä»¶æµè§ˆå™¨ï¼Œæ–¹ä¾¿é€‰æ‹©HTMLæ–‡ä»¶
  - âœ… å®æ—¶éªŒè¯æ–‡ä»¶è·¯å¾„æ ¼å¼
- **å…¨å±€é…ç½®ç®€åŒ–**ï¼š
  - âœ… ç§»é™¤è½¬å‘é€‰é¡¹æ ‡ç­¾é¡µä¸­çš„å…¨å±€HTMLæ–‡ä»¶é€‰æ‹©æ§ä»¶
  - âœ… ç®€åŒ–ç•Œé¢ç»“æ„ï¼Œé¿å…é…ç½®æ··æ·†

### ğŸ› ï¸ åç«¯é€»è¾‘ä¼˜åŒ– (Backend Logic Optimization)
- **è½¬å‘å™¨æ¶æ„æ”¹è¿›**ï¼š
  ```python
  # ä¿®æ”¹å‰ï¼šä½¿ç”¨å…¨å±€é…ç½®å‘é€æœ€ç»ˆæ¶ˆæ¯
  if self.forward_config.get('send_final_message', False):
      await self._send_final_message(all_target_channels)
  
  # ä¿®æ”¹åï¼šæŒ‰é¢‘é“å¯¹é…ç½®å‘é€æœ€ç»ˆæ¶ˆæ¯
  await self._send_final_messages_by_pairs(channel_pairs)
  ```
- **é…ç½®æ¨¡å‹æ›´æ–°**ï¼š
  - âœ… `UIChannelPair` æ¨¡å‹æ–°å¢ `final_message_html_file` å­—æ®µ
  - âœ… `UIForwardConfig` æ¨¡å‹ç§»é™¤å…¨å±€ `final_message_html_file` å­—æ®µ
  - âœ… æ·»åŠ ç›¸åº”çš„éªŒè¯å™¨ç¡®ä¿é…ç½®æœ‰æ•ˆæ€§

### ğŸ“‹ é…ç½®æ–‡ä»¶æ ¼å¼æ›´æ–° (Configuration Format Update)
- **æ–°çš„é¢‘é“å¯¹é…ç½®æ ¼å¼**ï¼š
  ```json
  {
    "source_channel": "@example",
    "target_channels": ["@target1", "@target2"],
    "send_final_message": true,
    "final_message_html_file": "/path/to/custom_message.html",
    // ... å…¶ä»–é…ç½®
  }
  ```
- **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰é…ç½®ä¼šè‡ªåŠ¨é€‚é…æ–°æ ¼å¼

### ğŸ¯ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ (Use Case Examples)
- **å¤šæ ·åŒ–è¥é”€**ï¼šä¸åŒé¢‘é“å¯¹å¯ä»¥å‘é€ä¸åŒçš„è¥é”€ä¿¡æ¯
- **å®šåˆ¶åŒ–æœåŠ¡**ï¼šä¸ºä¸åŒçš„ç›®æ ‡ç¾¤ä½“æä¾›å®šåˆ¶åŒ–çš„æœ€ç»ˆæ¶ˆæ¯
- **A/Bæµ‹è¯•**ï¼šåœ¨ä¸åŒé¢‘é“å¯¹ä¸­æµ‹è¯•ä¸åŒçš„æœ€ç»ˆæ¶ˆæ¯æ•ˆæœ

### âš ï¸ é‡è¦æé†’ (Important Notes)
- ç°æœ‰ç”¨æˆ·éœ€è¦é‡æ–°é…ç½®é¢‘é“å¯¹ä¸­çš„æœ€ç»ˆæ¶ˆæ¯HTMLæ–‡ä»¶è·¯å¾„
- å…¨å±€çš„HTMLæ–‡ä»¶é…ç½®å·²ç§»é™¤ï¼Œè¯·ä½¿ç”¨é¢‘é“å¯¹çº§åˆ«çš„é…ç½®

## [v2.1.9.11] - 2025-01-15

### ğŸ› é‡è¦ä¿®å¤ (Critical Bug Fix)
- **ä¿®å¤è½¬å‘æ¨¡å—çº¯æ–‡æœ¬ç±»å‹åœ¨é…ç½®æ›´æ–°åæ— æ³•ç”Ÿæ•ˆçš„é—®é¢˜**
  - **é—®é¢˜æè¿°**ï¼šç”¨æˆ·åœ¨å³é”®ç¼–è¾‘èœå•ä¸­å‹¾é€‰çº¯æ–‡æœ¬ç±»å‹å¹¶ä¿å­˜é…ç½®åï¼Œç¬¬äºŒæ¬¡è½¬å‘æ—¶çº¯æ–‡æœ¬æ¶ˆæ¯ä»è¢«è¿‡æ»¤ï¼Œæ— æ³•è½¬å‘
  - **æ ¹æœ¬åŸå› **ï¼š
    1. `Forwarder.forward_messages()` æ–¹æ³•ä¸­è™½ç„¶é‡æ–°åŠ è½½äº†é…ç½®å¹¶åˆ›å»ºäº†æ–°çš„ `MessageFilter` å®ä¾‹
    2. ä½†è½¬å‘æµç¨‹ä¸­çš„ä¸¤ä¸ªå…³é”®ç»„ä»¶ä½¿ç”¨çš„ `MessageFilter` å®ä¾‹æ²¡æœ‰è¢«æ›´æ–°ï¼š
       - `MediaGroupCollector.message_filter` - åœ¨æ—©æœŸè¿‡æ»¤é˜¶æ®µè°ƒç”¨ `is_media_allowed()`
       - `DirectForwarder.message_filter` - åœ¨è½¬å‘é˜¶æ®µè°ƒç”¨ `apply_all_filters()`
    3. å¯¼è‡´è¿™äº›ç»„ä»¶ä»ä½¿ç”¨è¿‡æ—¶çš„åª’ä½“ç±»å‹é…ç½®ï¼Œè¿‡æ»¤æ‰äº†åº”è¯¥è½¬å‘çš„æ¶ˆæ¯
  - **ä¿®å¤å†…å®¹**ï¼š
    - âœ… åœ¨ `forward_messages()` æ–¹æ³•ä¸­é‡æ–°åˆå§‹åŒ– `MessageFilter` åï¼ŒåŒæ­¥æ›´æ–° `MediaGroupCollector.message_filter` å®ä¾‹
    - âœ… åœ¨ `forward_messages()` æ–¹æ³•ä¸­é‡æ–°åˆå§‹åŒ– `MessageFilter` åï¼ŒåŒæ­¥æ›´æ–° `DirectForwarder.message_filter` å®ä¾‹
    - âœ… ç¡®ä¿è½¬å‘è¿‡ç¨‹ä¸­æ‰€æœ‰ç»„ä»¶éƒ½ä½¿ç”¨æœ€æ–°çš„é…ç½®
  - **æµ‹è¯•éªŒè¯**ï¼šç°åœ¨é…ç½®æ›´æ–°åçš„çº¯æ–‡æœ¬ç±»å‹è®¾ç½®ä¼šç«‹å³ç”Ÿæ•ˆï¼Œ**æ‰€æœ‰åª’ä½“ç±»å‹**çš„é…ç½®ä¿®æ”¹éƒ½ä¼šæ­£ç¡®åº”ç”¨

### ğŸ”§ æŠ€æœ¯å®ç° (Technical Implementation)
- **é…ç½®åŒæ­¥ä¼˜åŒ–**ï¼š
  ```python
  # ä¿®å¤å‰ï¼šå„ç»„ä»¶ä½¿ç”¨ç‹¬ç«‹çš„MessageFilterå®ä¾‹
  self.message_filter = MessageFilter(self.config)
  
  # ä¿®å¤åï¼šåŒæ­¥æ›´æ–°æ‰€æœ‰ç»„ä»¶çš„MessageFilterå®ä¾‹
  self.message_filter = MessageFilter(self.config)
  self.media_group_collector.message_filter = self.message_filter
  self.direct_forwarder.message_filter = self.message_filter
  ```
- **å½±å“èŒƒå›´**ï¼š
  - âœ… **æ—©æœŸè¿‡æ»¤é˜¶æ®µ**ï¼š`MediaGroupCollector.get_media_groups_optimized()` ç°åœ¨ä½¿ç”¨æœ€æ–°é…ç½®
  - âœ… **è½¬å‘è¿‡æ»¤é˜¶æ®µ**ï¼š`DirectForwarder.forward_media_group_directly()` ç°åœ¨ä½¿ç”¨æœ€æ–°é…ç½®
  - âœ… **æ‰€æœ‰åª’ä½“ç±»å‹**ï¼šphotoã€videoã€documentã€audioã€animationã€text çš„é…ç½®æ›´æ–°éƒ½ä¼šç«‹å³ç”Ÿæ•ˆ

## [v2.1.9.10] - 2025-01-15

### ğŸ› é‡è¦ä¿®å¤ (Critical Bug Fix)
- **ä¿®å¤è½¬å‘æ¨¡å—çº¯æ–‡æœ¬ç±»å‹æ”¯æŒé—®é¢˜**
  - **é—®é¢˜æè¿°**ï¼šå³é”®ç¼–è¾‘é¢‘é“å¯¹æ—¶å‹¾é€‰çº¯æ–‡æœ¬å¤é€‰æ¡†ï¼Œä¿å­˜é…ç½®åè½¬å‘æ—¶çº¯æ–‡æœ¬ä¿®æ”¹æœªç”Ÿæ•ˆ
  - **æ ¹æœ¬åŸå› **ï¼š
    1. `_add_channel_pair`æ–¹æ³•ä¸­ç¼ºå°‘å¯¹çº¯æ–‡æœ¬ç±»å‹çš„æ˜¾ç¤ºå¤„ç†
    2. `load_config`æ–¹æ³•ä¸­é»˜è®¤åª’ä½“ç±»å‹åˆ—è¡¨ä¸åŒ…å«TEXTç±»å‹
    3. `MessageFilter`ä¸­MediaTypeæšä¸¾è½¬å­—ç¬¦ä¸²æ—¶æœªä½¿ç”¨`.value`å±æ€§
  - **ä¿®å¤å†…å®¹**ï¼š
    - âœ… åœ¨`_add_channel_pair`æ–¹æ³•çš„åª’ä½“ç±»å‹æ˜¾ç¤ºä¸­æ·»åŠ çº¯æ–‡æœ¬æ”¯æŒ
    - âœ… ä¿®æ”¹`load_config`æ–¹æ³•é»˜è®¤åª’ä½“ç±»å‹åŒ…å«`MediaType.TEXT`
    - âœ… ä¿®å¤`MessageFilter.apply_all_filters`ä¸­çš„æšä¸¾è½¬æ¢é€»è¾‘
    - âœ… ä¿®å¤`MessageFilter.is_media_allowed`ä¸­çš„æšä¸¾è½¬æ¢é€»è¾‘
  - **æµ‹è¯•éªŒè¯**ï¼šç°åœ¨çº¯æ–‡æœ¬ç±»å‹åœ¨æ‰€æœ‰è½¬å‘åœºæ™¯ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œ

### ğŸ”§ æŠ€æœ¯å®ç° (Technical Implementation)
- **æšä¸¾è½¬æ¢ä¼˜åŒ–**ï¼š
  ```python
  # ä¿®å¤å‰ï¼šå¯èƒ½å¯¼è‡´è½¬æ¢é”™è¯¯
  allowed_media_types_str = [str(mt) for mt in allowed_media_types]
  
  # ä¿®å¤åï¼šç¡®ä¿æ­£ç¡®è½¬æ¢
  for mt in allowed_media_types:
      if hasattr(mt, 'value'):
          allowed_media_types_str.append(mt.value)
      else:
          allowed_media_types_str.append(str(mt))
  ```

- **UIæ˜¾ç¤ºå®Œå–„**ï¼š
  ```python
  # åœ¨åª’ä½“ç±»å‹æ˜¾ç¤ºä¸­æ·»åŠ çº¯æ–‡æœ¬æ”¯æŒ
  if self._is_media_type_in_list(MediaType.TEXT, media_types):
      media_types_str.append("çº¯æ–‡æœ¬")
  ```

### ğŸ“Š å½±å“èŒƒå›´ (Impact Scope)
- **è½¬å‘æ¨¡å—**ï¼šçº¯æ–‡æœ¬æ¶ˆæ¯ç°åœ¨å¯ä»¥æ­£å¸¸è¢«è¯†åˆ«å’Œè½¬å‘
- **é…ç½®ç®¡ç†**ï¼šå³é”®ç¼–è¾‘èœå•ä¸­çš„çº¯æ–‡æœ¬é€‰é¡¹ç”Ÿæ•ˆ
- **ç”¨æˆ·ä½“éªŒ**ï¼šå®Œæ•´çš„6ç§åª’ä½“ç±»å‹æ”¯æŒï¼ˆçº¯æ–‡æœ¬ã€ç…§ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ã€éŸ³é¢‘ã€åŠ¨ç”»ï¼‰

---

## [v2.1.9.9] - 2025-06-17

### ğŸš€ æ€§èƒ½é‡å¤§ä¼˜åŒ– (Major Performance Optimization)
- **è½¬å‘æ¨¡å—APIè°ƒç”¨ä¼˜åŒ–**
  - é—®é¢˜ï¼šä¹‹å‰çš„é€»è¾‘æ˜¯å…ˆè·å–æ‰€æœ‰æ¶ˆæ¯ï¼Œå†æ£€æŸ¥è½¬å‘å†å²åˆ¤æ–­æ˜¯å¦å·²è½¬å‘ï¼Œå¯¼è‡´å¤§é‡ä¸å¿…è¦çš„APIè°ƒç”¨
  - ä¼˜åŒ–ï¼šæ”¹ä¸ºå…ˆæ ¹æ®é¢‘é“å¯¹é…ç½®çš„èµ·å§‹IDè‡³ç»“æŸIDèŒƒå›´ï¼Œæ£€æŸ¥è¿™äº›IDæ˜¯å¦åœ¨è½¬å‘å†å²ä¸­ï¼Œè¿‡æ»¤æ‰å·²è½¬å‘çš„IDï¼Œç„¶ååªè·å–æœªè½¬å‘çš„æ¶ˆæ¯
  - æ•ˆæœï¼šå¤§å¤§å‡å°‘äº†get_messagesçš„APIè°ƒç”¨æ¬¡æ•°ï¼Œç‰¹åˆ«æ˜¯åœ¨æœ‰å¤§é‡å·²è½¬å‘æ¶ˆæ¯çš„åœºæ™¯ä¸‹ï¼Œæ€§èƒ½æå‡æ˜¾è‘—

### ğŸ› é‡è¦ä¿®å¤ (Critical Fix)
- **ä¿®å¤end_id=0æ—¶çš„å¤„ç†é€»è¾‘**
  - é—®é¢˜ï¼šå½“end_id=0ï¼ˆè¡¨ç¤ºè·å–åˆ°æœ€æ–°æ¶ˆæ¯ï¼‰æ—¶ï¼Œæ—¥å¿—æ˜¾ç¤ºå¼‚å¸¸çš„è´Ÿæ•°èŒƒå›´
  - ä¿®å¤ï¼šåœ¨é¢„è¿‡æ»¤å‰å…ˆè·å–é¢‘é“å®é™…çš„æœ€æ–°æ¶ˆæ¯IDï¼Œæ­£ç¡®è®¾ç½®end_idå€¼
  - æ•ˆæœï¼šæ—¥å¿—ç°åœ¨æ­£ç¡®æ˜¾ç¤ºæ¶ˆæ¯IDèŒƒå›´ï¼Œå¦‚"èŒƒå›´: 36972-39156 (å…±2185ä¸ªID)"
  - å¢å¼ºï¼šæ·»åŠ èŒƒå›´åˆç†æ€§æ£€æŸ¥ï¼Œç¡®ä¿start_id â‰¤ end_idï¼Œå¼‚å¸¸æ—¶å›é€€åˆ°åŸæœ‰é€»è¾‘

### ğŸ”§ æŠ€æœ¯å®ç° (Technical Implementation)
- **æ–°å¢ä¼˜åŒ–æ–¹æ³•**ï¼š
  - `MediaGroupCollector.get_media_groups_optimized()` - ä¼˜åŒ–çš„åª’ä½“ç»„è·å–æ–¹æ³•
  - `MediaGroupCollector.get_media_groups_info_optimized()` - ä¼˜åŒ–çš„åª’ä½“ç»„ä¿¡æ¯è·å–æ–¹æ³•
  - `MediaGroupCollector._filter_unforwarded_ids()` - é¢„è¿‡æ»¤å·²è½¬å‘æ¶ˆæ¯IDçš„æ–¹æ³•
  - `MessageIterator.iter_messages_by_ids()` - æŒ‰æŒ‡å®šIDåˆ—è¡¨è·å–æ¶ˆæ¯çš„æ–¹æ³•

- **ä¼˜åŒ–é€»è¾‘æµç¨‹**ï¼š
  1. æ ¹æ®é¢‘é“å¯¹é…ç½®ç”Ÿæˆæ¶ˆæ¯IDèŒƒå›´ï¼ˆstart_id åˆ° end_idï¼‰
  2. æ£€æŸ¥å†å²è®°å½•ï¼Œè¿‡æ»¤æ‰å·²è½¬å‘åˆ°æ‰€æœ‰ç›®æ ‡é¢‘é“çš„æ¶ˆæ¯ID
  3. åªå¯¹æœªè½¬å‘çš„æ¶ˆæ¯IDè°ƒç”¨get_messages API
  4. åº”ç”¨è¿‡æ»¤è§„åˆ™å’Œè½¬å‘å‚æ•°è¿›è¡Œè½¬å‘

### ğŸ“Š æ€§èƒ½æå‡æ•ˆæœ (Performance Benefits)
- **APIè°ƒç”¨å‡å°‘**ï¼šåœ¨æœ‰å¤§é‡å·²è½¬å‘æ¶ˆæ¯çš„æƒ…å†µä¸‹ï¼ŒAPIè°ƒç”¨å¯å‡å°‘70%-90%
- **å¤„ç†é€Ÿåº¦æå‡**ï¼šè·³è¿‡å·²è½¬å‘æ¶ˆæ¯çš„æ£€æŸ¥å’Œè·å–ï¼Œæ•´ä½“å¤„ç†é€Ÿåº¦æ˜¾è‘—æå‡
- **ç½‘ç»œæµé‡èŠ‚çœ**ï¼šå‡å°‘ä¸å¿…è¦çš„æ¶ˆæ¯å†…å®¹è·å–ï¼ŒèŠ‚çœç½‘ç»œå¸¦å®½
- **å†…å­˜ä½¿ç”¨ä¼˜åŒ–**ï¼šä¸å†éœ€è¦åŠ è½½å·²è½¬å‘çš„æ¶ˆæ¯å†…å®¹åˆ°å†…å­˜

### ğŸ”„ å‘åå…¼å®¹æ€§ (Backward Compatibility)
- **å®Œå…¨å…¼å®¹**ï¼šä¿ç•™åŸæœ‰çš„`get_media_groups()`å’Œ`get_media_groups_info()`æ–¹æ³•
- **è‡ªåŠ¨ä¼˜åŒ–**ï¼šå½“è®¾ç½®äº†èµ·å§‹IDå’Œç»“æŸIDæ—¶ï¼Œè‡ªåŠ¨ä½¿ç”¨ä¼˜åŒ–é€»è¾‘
- **æ— é…ç½®ä¿®æ”¹**ï¼šç°æœ‰é…ç½®æ–‡ä»¶æ— éœ€ä»»ä½•ä¿®æ”¹
- **æ™ºèƒ½åˆ‡æ¢**ï¼šæœªè®¾ç½®IDèŒƒå›´æ—¶è‡ªåŠ¨å›é€€åˆ°åŸæœ‰é€»è¾‘

### ğŸ“ ä½¿ç”¨åœºæ™¯ (Use Cases)
- **å¤§é‡å†å²æ¶ˆæ¯**ï¼šå¤„ç†åŒ…å«å¤§é‡å†å²æ¶ˆæ¯çš„é¢‘é“æ—¶ï¼Œæ€§èƒ½æå‡æœ€ä¸ºæ˜æ˜¾
- **å¢é‡è½¬å‘**ï¼šå®šæœŸæ‰§è¡Œè½¬å‘ä»»åŠ¡æ—¶ï¼Œåªå¤„ç†æ–°å¢çš„æœªè½¬å‘æ¶ˆæ¯
- **æ–­ç‚¹ç»­ä¼ **ï¼šç¨‹åºä¸­æ–­åé‡æ–°å¯åŠ¨ï¼Œè‡ªåŠ¨è·³è¿‡å·²è½¬å‘çš„æ¶ˆæ¯ç»§ç»­å¤„ç†
- **å¤šç›®æ ‡è½¬å‘**ï¼šè½¬å‘åˆ°å¤šä¸ªç›®æ ‡é¢‘é“æ—¶ï¼Œæ™ºèƒ½æ£€æŸ¥æ¯ä¸ªç›®æ ‡çš„è½¬å‘çŠ¶æ€

---

## [v2.1.9.3] - 2025-01-03 - ç»Ÿä¸€è¿‡æ»¤ç³»ç»Ÿé‡æ„

### ğŸ¯ è½¬å‘åŠŸèƒ½é‡å¤§å‡çº§

#### ç»Ÿä¸€è¿‡æ»¤ç³»ç»Ÿå®ç°
ä¸ºTG-Managerè½¬å‘æ¨¡å—å®ç°ç»Ÿä¸€çš„è¿‡æ»¤ç³»ç»Ÿï¼Œç¡®ä¿æ–‡æœ¬æ›¿æ¢ã€å…³é”®è¯è¿‡æ»¤ã€åª’ä½“ç±»å‹è¿‡æ»¤åœ¨æ‰€æœ‰è½¬å‘åœºæ™¯ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼š

**ğŸš€ æ ¸å¿ƒç‰¹æ€§**ï¼š
- **ç»Ÿä¸€è¿‡æ»¤æ¶æ„**ï¼šåˆ›å»ºç»Ÿä¸€çš„MessageFilterç±»ï¼Œä¸ºæ‰€æœ‰è½¬å‘åœºæ™¯æä¾›ä¸€è‡´çš„è¿‡æ»¤é€»è¾‘
- **å…¨åœºæ™¯æ”¯æŒ**ï¼šç›´æ¥è½¬å‘(DirectForwarder)å’Œç¦æ­¢è½¬å‘(RestrictedForwardHandler)åœºæ™¯ä¸‹è¿‡æ»¤å‚æ•°éƒ½èƒ½æ­£å¸¸å·¥ä½œ
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šéµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œæ¯ä¸ªè¿‡æ»¤åŠŸèƒ½ç‹¬ç«‹å®ç°
- **Pyrogramå®˜æ–¹æœ€ä½³å®è·µ**ï¼šä½¿ç”¨copy_messageã€copy_media_groupç­‰å®˜æ–¹APIæ­£ç¡®å®ç°æ–‡æœ¬æ›¿æ¢

**ğŸ› ï¸ å®ç°ç»†èŠ‚**ï¼š

#### 1. ç»Ÿä¸€æ¶ˆæ¯è¿‡æ»¤å™¨ (MessageFilter)
```python
class MessageFilter:
    """ç»Ÿä¸€çš„æ¶ˆæ¯è¿‡æ»¤å™¨ï¼Œæ”¯æŒæ‰€æœ‰è¿‡æ»¤åŠŸèƒ½"""
    
    def apply_keyword_filter(self, messages, keywords):
        """å…³é”®è¯è¿‡æ»¤ - åŸºäºæ¶ˆæ¯æ ‡é¢˜(caption)æˆ–æ–‡æœ¬(text)"""
    
    def apply_media_type_filter(self, messages, allowed_media_types):
        """åª’ä½“ç±»å‹è¿‡æ»¤ - ç²¾ç¡®æ§åˆ¶è½¬å‘çš„åª’ä½“ç±»å‹"""
    
    def apply_text_replacements(self, text, text_replacements):
        """æ–‡æœ¬æ›¿æ¢ - ä½œç”¨äºæ¶ˆæ¯æ ‡é¢˜"""
    
    def apply_general_filters(self, messages, pair_config):
        """é€šç”¨è¿‡æ»¤ - æ’é™¤ç‰¹å®šç±»å‹çš„æ¶ˆæ¯"""
    
    def apply_all_filters(self, messages, pair_config):
        """ç»¼åˆè¿‡æ»¤ - ç»Ÿä¸€åº”ç”¨æ‰€æœ‰è¿‡æ»¤è§„åˆ™"""
```

#### 2. ç›´æ¥è½¬å‘å™¨å¢å¼º (DirectForwarder)
- **é›†æˆè¿‡æ»¤åŠŸèƒ½**ï¼šç›´æ¥è½¬å‘åœºæ™¯ä¸‹ä¹Ÿèƒ½åº”ç”¨æ‰€æœ‰è¿‡æ»¤è§„åˆ™
- **æ™ºèƒ½APIé€‰æ‹©**ï¼šéœ€è¦æ–‡æœ¬æ›¿æ¢æ—¶è‡ªåŠ¨ä½¿ç”¨copy_message/copy_media_group
- **é…ç½®ä¼ é€’æœºåˆ¶**ï¼šæ­£ç¡®ä¼ é€’é¢‘é“å¯¹é…ç½®åˆ°è¿‡æ»¤å™¨

#### 3. ç¦æ­¢è½¬å‘å¤„ç†å™¨é‡æ„ (RestrictedForwardHandler)
- **ç»Ÿä¸€è¿‡æ»¤æ¥å£**ï¼šä½¿ç”¨ç›¸åŒçš„MessageFilterå®ä¾‹
- **ä»£ç é‡ç”¨ä¼˜åŒ–**ï¼šç§»é™¤é‡å¤çš„è¿‡æ»¤é€»è¾‘ä»£ç 
- **ä¸€è‡´æ€§ä¿è¯**ï¼šç¡®ä¿ä¸ç›´æ¥è½¬å‘å™¨çš„è¿‡æ»¤è¡Œä¸ºå®Œå…¨ä¸€è‡´

#### 4. é…ç½®è½¬æ¢ä¼˜åŒ– (config_utils.py)
- **åŒæ ¼å¼æ”¯æŒ**ï¼šåŒæ—¶æ”¯æŒUIæ ¼å¼å’Œå†…éƒ¨å¤„ç†æ ¼å¼
- **æ–‡æœ¬æ›¿æ¢å­—å…¸**ï¼šå°†UIçš„æ–‡æœ¬è¿‡æ»¤åˆ—è¡¨è½¬æ¢ä¸ºé«˜æ•ˆçš„å­—å…¸æ ¼å¼

### ğŸ“Š è¿‡æ»¤åŠŸèƒ½è¯¦è§£

#### æ–‡æœ¬æ›¿æ¢ (ä½œç”¨äºæ¶ˆæ¯æ ‡é¢˜)
- **åº”ç”¨èŒƒå›´**ï¼šæ¶ˆæ¯çš„captionå­—æ®µ
- **APIæ”¯æŒ**ï¼šä½¿ç”¨copy_messageå’Œcopy_media_groupçš„captionå‚æ•°
- **æ›¿æ¢é€»è¾‘**ï¼šæ”¯æŒå¤šä¸ªæ›¿æ¢è§„åˆ™ï¼ŒæŒ‰é…ç½®é¡ºåºä¾æ¬¡åº”ç”¨

#### å…³é”®è¯è¿‡æ»¤ (ä½œç”¨äºæ¶ˆæ¯æ ‡é¢˜)
- **æ£€æŸ¥å†…å®¹**ï¼šä¼˜å…ˆæ£€æŸ¥captionï¼Œå¦‚æ— åˆ™æ£€æŸ¥text
- **åŒ¹é…æ–¹å¼**ï¼šä¸åŒºåˆ†å¤§å°å†™çš„å­å­—ç¬¦ä¸²åŒ¹é…
- **å¤„ç†é€»è¾‘**ï¼šåªæœ‰åŒ…å«è‡³å°‘ä¸€ä¸ªå…³é”®è¯çš„æ¶ˆæ¯æ‰ä¼šé€šè¿‡

#### åª’ä½“ç±»å‹è¿‡æ»¤
- **æ”¯æŒç±»å‹**ï¼šphotoã€videoã€documentã€audioã€animationã€stickerã€voiceã€video_note
- **è¿‡æ»¤ç­–ç•¥**ï¼šåªæœ‰åœ¨å…è®¸åˆ—è¡¨ä¸­çš„åª’ä½“ç±»å‹æ‰èƒ½é€šè¿‡
- **çº¯æ–‡æœ¬å¤„ç†**ï¼šæ— åª’ä½“ç±»å‹çš„æ¶ˆæ¯é»˜è®¤å…è®¸é€šè¿‡

#### é€šç”¨è¿‡æ»¤è§„åˆ™
- **æ’é™¤è½¬å‘æ¶ˆæ¯**ï¼šè¿‡æ»¤å…·æœ‰forward_fromå±æ€§çš„æ¶ˆæ¯
- **æ’é™¤å›å¤æ¶ˆæ¯**ï¼šè¿‡æ»¤å…·æœ‰reply_to_messageå±æ€§çš„æ¶ˆæ¯
- **æ’é™¤çº¯æ–‡æœ¬æ¶ˆæ¯**ï¼šè¿‡æ»¤æ— åª’ä½“å†…å®¹çš„çº¯æ–‡æœ¬æ¶ˆæ¯
- **æ’é™¤åŒ…å«é“¾æ¥**ï¼šè¿‡æ»¤åŒ…å«HTTPé“¾æ¥ã€@ç”¨æˆ·åã€#æ ‡ç­¾çš„æ¶ˆæ¯

### ğŸ”§ æŠ€æœ¯å®ç°äº®ç‚¹

#### Pyrogramå®˜æ–¹APIä½¿ç”¨
- **copy_message**ï¼šæ”¯æŒcaptionå‚æ•°çš„å•æ¶ˆæ¯å¤åˆ¶ï¼Œå®ç°æ–‡æœ¬æ›¿æ¢
- **copy_media_group**ï¼šæ”¯æŒcaptionå‚æ•°çš„åª’ä½“ç»„å¤åˆ¶ï¼Œä¿æŒç»„ç»“æ„
- **forward_messages**ï¼šä¿ç•™åŸå§‹ä½œè€…ä¿¡æ¯çš„ç›´æ¥è½¬å‘
- **å‚æ•°ä¼˜åŒ–**ï¼šdisable_notificationç­‰å‚æ•°ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

#### æ¨¡å—åŒ–æ¶æ„è®¾è®¡
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªè¿‡æ»¤åŠŸèƒ½ç‹¬ç«‹å®ç°ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•
- **ä¾èµ–æ³¨å…¥**ï¼šç»Ÿä¸€çš„MessageFilterå®ä¾‹åœ¨å„æ¨¡å—é—´å…±äº«
- **æ¥å£ä¸€è‡´**ï¼šæ‰€æœ‰è¿‡æ»¤æ–¹æ³•ä½¿ç”¨ç»Ÿä¸€çš„å‚æ•°å’Œè¿”å›å€¼æ ¼å¼

#### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **æå‰è¿‡æ»¤**ï¼šåœ¨è½¬å‘å‰å®Œæˆæ‰€æœ‰è¿‡æ»¤ï¼Œé¿å…æ— æ•ˆæ“ä½œ
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒæ¶ˆæ¯åˆ—è¡¨çš„æ‰¹é‡è¿‡æ»¤å¤„ç†
- **ç»Ÿè®¡ä¿¡æ¯**ï¼šè¯¦ç»†çš„è¿‡æ»¤ç»Ÿè®¡ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§

### ğŸ§ª æµ‹è¯•ä¸éªŒè¯

#### åŠŸèƒ½æµ‹è¯•è„šæœ¬ (filter_test.py)
- **å•å…ƒæµ‹è¯•**ï¼šç‹¬ç«‹æµ‹è¯•æ¯ä¸ªè¿‡æ»¤åŠŸèƒ½
- **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•å¤šä¸ªè¿‡æ»¤è§„åˆ™çš„ç»„åˆæ•ˆæœ
- **æ¨¡æ‹Ÿæ•°æ®**ï¼šä½¿ç”¨MockMessageæ¨¡æ‹Ÿå„ç§æ¶ˆæ¯ç±»å‹

#### æµ‹è¯•è¦†ç›–èŒƒå›´
- âœ… å…³é”®è¯è¿‡æ»¤ï¼šåŒ…å«/ä¸åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯
- âœ… åª’ä½“ç±»å‹è¿‡æ»¤ï¼šå„ç§åª’ä½“ç±»å‹çš„è¿‡æ»¤æµ‹è¯•
- âœ… æ–‡æœ¬æ›¿æ¢ï¼šå¤šç§æ›¿æ¢è§„åˆ™çš„ç»„åˆæµ‹è¯•
- âœ… é€šç”¨è¿‡æ»¤ï¼šè½¬å‘ã€å›å¤ã€é“¾æ¥ç­‰ç‰¹æ®Šæ¶ˆæ¯çš„è¿‡æ»¤
- âœ… ç»¼åˆè¿‡æ»¤ï¼šæ‰€æœ‰è¿‡æ»¤è§„åˆ™çš„ç»„åˆåº”ç”¨æµ‹è¯•

### ğŸ”„ å‘åå…¼å®¹æ€§

#### å®Œå…¨å…¼å®¹
- **ç°æœ‰é…ç½®**ï¼šæ‰€æœ‰ç°æœ‰çš„é¢‘é“å¯¹é…ç½®æ— éœ€ä¿®æ”¹
- **APIæ¥å£**ï¼šä¿æŒæ‰€æœ‰åŸæœ‰çš„æ–¹æ³•ç­¾åä¸å˜
- **åŠŸèƒ½è¡Œä¸º**ï¼šå¢å¼ºåŠŸèƒ½ä¸å½±å“ç°æœ‰è½¬å‘é€»è¾‘

#### æ¸è¿›å¼ä¼˜åŒ–
- **è‡ªåŠ¨æ£€æµ‹**ï¼šç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹è¿‡æ»¤éœ€æ±‚å¹¶é€‰æ‹©åˆé€‚çš„API
- **ä¼˜é›…é™çº§**ï¼šè¿‡æ»¤åŠŸèƒ½å¤±è´¥æ—¶ä»èƒ½æ‰§è¡ŒåŸºç¡€è½¬å‘
- **é…ç½®çµæ´»æ€§**ï¼šæ”¯æŒéƒ¨åˆ†é…ç½®çš„ç»„åˆä½¿ç”¨

### ğŸ“ˆ é¢„æœŸæ•ˆæœ

#### ç”¨æˆ·ä½“éªŒæå‡
- **è¿‡æ»¤ç²¾åº¦**ï¼šä¸‰å¤§è¿‡æ»¤å‚æ•°åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œ
- **è½¬å‘æ•ˆç‡**ï¼šæå‰è¿‡æ»¤å‡å°‘æ— æ•ˆçš„ç½‘ç»œè¯·æ±‚å’Œå­˜å‚¨æ“ä½œ
- **é…ç½®ç®€åŒ–**ï¼šç»Ÿä¸€çš„é…ç½®æ ¼å¼ï¼Œæ— éœ€åŒºåˆ†è½¬å‘åœºæ™¯

#### ç³»ç»Ÿç¨³å®šæ€§
- **ä»£ç é‡ç”¨**ï¼šå‡å°‘é‡å¤ä»£ç ï¼Œé™ä½ç»´æŠ¤æˆæœ¬
- **é”™è¯¯éš”ç¦»**ï¼šå•ä¸ªè¿‡æ»¤åŠŸèƒ½çš„å¤±è´¥ä¸å½±å“å…¶ä»–åŠŸèƒ½
- **æ—¥å¿—å®Œå–„**ï¼šè¯¦ç»†çš„è¿‡æ»¤æ—¥å¿—ï¼Œä¾¿äºé—®é¢˜å®šä½

---

## [v2.1.9.2] - 2025-01-03 - å¯åŠ¨æ—¶è‡ªåŠ¨æ¸…ç†ä¸´æ—¶ç›®å½•

### ğŸ§¹ èµ„æºç®¡ç†åŠŸèƒ½æ–°å¢

#### å¯åŠ¨æ—¶è‡ªåŠ¨æ¸…ç†ä¸´æ—¶ç›®å½•
ä¸ºTG-Manageræ·»åŠ ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ¸…ç†ä¸´æ—¶ä¸‹è½½ç›®å½•çš„åŠŸèƒ½ï¼Œæœ‰æ•ˆç®¡ç†ç£ç›˜ç©ºé—´ï¼š

**ğŸš€ æ ¸å¿ƒç‰¹æ€§**ï¼š
- **è‡ªåŠ¨æ¸…ç†æœºåˆ¶**ï¼šç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æå¹¶æ¸…ç†ä¸´æ—¶ç›®å½•
- **æ™ºèƒ½ç©ºé—´ç»Ÿè®¡**ï¼šå®æ—¶æ˜¾ç¤ºæ¸…ç†çš„ç›®å½•æ•°é‡å’Œé‡Šæ”¾çš„ç£ç›˜ç©ºé—´
- **å®‰å…¨åˆ é™¤ç­–ç•¥**ï¼šä¿ç•™ç›®å½•ç»“æ„ï¼Œä»…æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œå­ç›®å½•
- **è¯¦ç»†æ—¥å¿—è®°å½•**ï¼šå®Œæ•´è®°å½•æ¸…ç†è¿‡ç¨‹å’Œç»“æœ

**ğŸ› ï¸ å®ç°ç»†èŠ‚**ï¼š

#### 1. æ¸…ç†èŒƒå›´
è‡ªåŠ¨æ¸…ç†ä»¥ä¸‹ä¸´æ—¶ç›®å½•ï¼š
- `tmp/` - é€šç”¨ä¸´æ—¶ç›®å½•
- `temp/` - ä¸´æ—¶å¤„ç†ç›®å½•
- `tmp/downloads/` - ä¸´æ—¶ä¸‹è½½ç›®å½•
- `tmp/uploads/` - ä¸´æ—¶ä¸Šä¼ ç›®å½•
- `temp/restricted_forward/` - ç¦æ­¢è½¬å‘å†…å®¹å¤„ç†ä¸´æ—¶ç›®å½•

#### 2. æ ¸å¿ƒåŠŸèƒ½
```python
def _cleanup_temp_directories_on_startup(self):
    """å¯åŠ¨æ—¶æ¸…ç†ä¸´æ—¶ç›®å½•"""
    
    # å®šä¹‰éœ€è¦æ¸…ç†çš„ä¸´æ—¶ç›®å½•åˆ—è¡¨
    temp_dirs = [
        "tmp",                      # é€šç”¨ä¸´æ—¶ç›®å½•
        "temp",                     # ä¸´æ—¶å¤„ç†ç›®å½•
        Path("tmp") / "downloads",  # ä¸´æ—¶ä¸‹è½½ç›®å½•
        Path("tmp") / "uploads",    # ä¸´æ—¶ä¸Šä¼ ç›®å½•
        Path("temp") / "restricted_forward",  # ç¦æ­¢è½¬å‘å†…å®¹å¤„ç†ä¸´æ—¶ç›®å½•
    ]
    
    # å®‰å…¨æ¸…ç†ç›®å½•å†…å®¹ï¼Œä¿ç•™ç›®å½•ç»“æ„
    # ç»Ÿè®¡æ¸…ç†æ•ˆæœå¹¶è®°å½•æ—¥å¿—
```

#### 3. å®‰å…¨æœºåˆ¶
- **ä¿ç•™ç›®å½•ç»“æ„**ï¼šåªæ¸…ç†æ–‡ä»¶å’Œå­ç›®å½•ï¼Œä¿æŒä¸»è¦ç›®å½•å­˜åœ¨
- **å¼‚å¸¸å¤„ç†**ï¼šå•ä¸ªç›®å½•æ¸…ç†å¤±è´¥ä¸å½±å“å…¶ä»–ç›®å½•
- **è·¯å¾„éªŒè¯**ï¼šç¡®ä¿åªæ¸…ç†æŒ‡å®šçš„ä¸´æ—¶ç›®å½•

### ğŸ“Š ä½¿ç”¨ä½“éªŒ

#### å¯åŠ¨æ—¥å¿—ç¤ºä¾‹
```
2025-01-03 10:30:15 | INFO  | ç¨‹åºå¯åŠ¨ï¼Œå¼€å§‹æ¸…ç†ä¸´æ—¶ç›®å½•...
2025-01-03 10:30:15 | INFO  | å·²æ¸…ç†ä¸´æ—¶ç›®å½•: tmp (é‡Šæ”¾ 15.67 MB)
2025-01-03 10:30:15 | INFO  | å·²æ¸…ç†ä¸´æ—¶ç›®å½•: temp/restricted_forward (é‡Šæ”¾ 8.32 MB)
2025-01-03 10:30:15 | INFO  | å¯åŠ¨æ¸…ç†å®Œæˆï¼Œå…±æ¸…ç† 2 ä¸ªç›®å½•ï¼Œé‡Šæ”¾ 23.99 MB ç©ºé—´
```

#### æ€§èƒ½å½±å“
- **å¯åŠ¨æ—¶é—´**ï¼šå¢åŠ çº¦0.1-0.5ç§’ï¼ˆå–å†³äºä¸´æ—¶æ–‡ä»¶æ•°é‡ï¼‰
- **å†…å­˜ä½¿ç”¨**ï¼šæ¸…ç†è¿‡ç¨‹å†…å­˜å ç”¨æå°
- **ç£ç›˜I/O**ï¼šä»…åœ¨æœ‰ä¸´æ—¶æ–‡ä»¶æ—¶äº§ç”Ÿåˆ é™¤æ“ä½œ

### ğŸ”§ æŠ€æœ¯å®ç°

#### é›†æˆä½ç½®
åœ¨ `TGManagerApp` ç±»çš„åˆå§‹åŒ–æµç¨‹ä¸­ï¼Œä½äºæ¸…ç†ç®¡ç†å™¨è®¾ç½®ä¹‹åï¼š
```python
# è®¾ç½®æ¸…ç†å¤„ç†å™¨
self.cleanup_manager.setup_cleanup_handlers()

# å¯åŠ¨æ—¶æ¸…ç†ä¸´æ—¶ç›®å½•
self._cleanup_temp_directories_on_startup()

# è¿æ¥ä¿¡å·
self._connect_signals()
```

#### ç›®å½•å¤§å°è®¡ç®—
```python
def _calculate_directory_size(self, directory_path: Path) -> int:
    """è®¡ç®—ç›®å½•æ€»å¤§å°ï¼ˆå­—èŠ‚ï¼‰"""
    
    # éå†æ‰€æœ‰æ–‡ä»¶ï¼Œç´¯è®¡å¤§å°
    # è·³è¿‡ç¬¦å·é“¾æ¥é¿å…é‡å¤è®¡ç®—
    # å¤„ç†è®¿é—®æƒé™å¼‚å¸¸
```

### ğŸ¯ ä½¿ç”¨åœºæ™¯

#### æ—¥å¸¸ä½¿ç”¨
- **é•¿æœŸè¿è¡Œæ¸…ç†**ï¼šé•¿æœŸè¿è¡Œçš„TG-Managerå®ä¾‹å®šæœŸæ¸…ç†ç´¯ç§¯çš„ä¸´æ—¶æ–‡ä»¶
- **å­˜å‚¨ç©ºé—´ç®¡ç†**ï¼šåœ¨å­˜å‚¨ç©ºé—´æœ‰é™çš„æœåŠ¡å™¨ä¸Šè‡ªåŠ¨ç®¡ç†ç£ç›˜ä½¿ç”¨
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…ä¸´æ—¶æ–‡ä»¶è¿‡å¤šå½±å“ç³»ç»Ÿæ€§èƒ½

#### å¼€å‘è°ƒè¯•
- **å¼€å‘ç¯å¢ƒæ¸…ç†**ï¼šå¼€å‘è¿‡ç¨‹ä¸­è‡ªåŠ¨æ¸…ç†æµ‹è¯•äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶
- **ç‰ˆæœ¬å‡çº§æ¸…ç†**ï¼šå‡çº§åæ¸…ç†æ—§ç‰ˆæœ¬å¯èƒ½é—ç•™çš„ä¸´æ—¶æ–‡ä»¶

### ğŸ”„ å‘åå…¼å®¹æ€§

#### å®Œå…¨å…¼å®¹
- **ç°æœ‰é…ç½®**ï¼šä¸å½±å“ä»»ä½•ç°æœ‰é…ç½®å’Œè®¾ç½®
- **ç”¨æˆ·æ•°æ®**ï¼šåªæ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼Œä¸å½±å“ç”¨æˆ·æ•°æ®å’Œè®¾ç½®
- **åŠŸèƒ½æ¨¡å—**ï¼šä¸å½±å“ç°æœ‰åŠŸèƒ½æ¨¡å—çš„è¿è¡Œ

#### å¯é€‰æ§åˆ¶
- **è‡ªåŠ¨å¯ç”¨**ï¼šé»˜è®¤è‡ªåŠ¨å¯ç”¨ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **æ—¥å¿—æ§åˆ¶**ï¼šå¯é€šè¿‡æ—¥å¿—çº§åˆ«æ§åˆ¶æ¸…ç†ä¿¡æ¯çš„æ˜¾ç¤º
- **å¼‚å¸¸å®¹é”™**ï¼šæ¸…ç†å¤±è´¥ä¸å½±å“ç¨‹åºæ­£å¸¸å¯åŠ¨

---

## [v2.1.9.1] - 2025-06-16 - å…³é”®ä¿®å¤ï¼šPyropatch APIè°ƒç”¨

### ğŸ”§ é‡è¦ä¿®å¤

#### Pyropatch FloodWaitå¤„ç†å™¨APIä¿®å¤
ä¿®å¤äº†å¯¼è‡´pyropatchæ— æ³•æ­£å¸¸å·¥ä½œçš„å…³é”®APIè°ƒç”¨é”™è¯¯ï¼š

**ğŸ› é—®é¢˜æè¿°**ï¼š
- pyropatchå¯¼å…¥æˆåŠŸä½†åº”ç”¨å¤±è´¥
- é”™è¯¯ä¿¡æ¯ï¼š`module 'pyropatch.flood_handler' has no attribute 'apply_patch'`
- å¯¼è‡´è‡ªåŠ¨å›é€€åˆ°å†…ç½®å¤„ç†å™¨ï¼Œæ— æ³•äº«å—pyropatchçš„ä¸“ä¸šå¤„ç†èƒ½åŠ›

**âœ… ä¿®å¤å†…å®¹**ï¼š
```python
# ä¿®å¤å‰ï¼ˆé”™è¯¯çš„APIè°ƒç”¨ï¼‰
from pyropatch import flood_handler
flood_handler.apply_patch(client)  # âŒ apply_patchæ–¹æ³•ä¸å­˜åœ¨

# ä¿®å¤åï¼ˆæ­£ç¡®çš„APIè°ƒç”¨ï¼‰
from pyropatch.flood_handler import patch as flood_handler_patch
flood_handler_patch(client)  # âœ… ä½¿ç”¨æ­£ç¡®çš„patchå‡½æ•°
```

**ğŸ¯ ä¿®å¤æ•ˆæœ**ï¼š
- âœ… Pyropatchç°åœ¨å¯ä»¥æ­£å¸¸å¯¼å…¥å’Œåº”ç”¨
- âœ… å®¢æˆ·ç«¯æˆåŠŸåº”ç”¨ä¸“ä¸šçº§monkey-patch
- âœ… ç”¨æˆ·å¯ä»¥äº«å—æ›´ç¨³å®šçš„FloodWaitå¤„ç†èƒ½åŠ›
- âœ… ä¸å†çœ‹åˆ°`[sessions/xxx] Waiting for X seconds`çš„åŸç”Ÿæ—¥å¿—

**ğŸ“Š æµ‹è¯•éªŒè¯**ï¼š
```
ğŸ”§ æµ‹è¯•ä¿®å¤åçš„Pyropatch FloodWaitå¤„ç†å™¨
1. Pyropatchå¯ç”¨æ€§: âœ… True
2. PyropatchçŠ¶æ€: {'available': True, 'patched_clients': 0, 'max_retries': 3, 'base_delay': 0.5}
4. æ­£åœ¨åº”ç”¨pyropatch FloodWaitå¤„ç†å™¨...
âœ… Pyropatch FloodWaitå¤„ç†å™¨åº”ç”¨æˆåŠŸï¼
5. æ›´æ–°åçš„çŠ¶æ€: {'available': True, 'patched_clients': 1, 'max_retries': 3, 'base_delay': 0.5}
```

**ğŸš€ ä½¿ç”¨å»ºè®®**ï¼š
é‡æ–°å¯åŠ¨ç¨‹åºåï¼Œpyropatchå°†è‡ªåŠ¨æ­£å¸¸å·¥ä½œï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ï¼š
- æ›´ä¸“ä¸šçš„FloodWaitå¤„ç†
- æ›´å°‘çš„é™æµç›¸å…³é”™è¯¯
- æ›´é«˜æ•ˆçš„APIè°ƒç”¨å¤„ç†

---

## [v2.1.9] - 2024-01-XX - Pyropatch FloodWaitå¤„ç†å™¨é›†æˆ

### ğŸš€ æ ¸å¿ƒç‰¹æ€§å‡çº§

#### Pyropatchä¸“ä¸šçº§FloodWaitå¤„ç†å™¨é›†æˆ
åŸºäºç¤¾åŒºæˆç†Ÿçš„pyropatchåº“ï¼Œä¸ºTG-Managerè½¬å‘æ¨¡å—æä¾›æ›´ä¸“ä¸šã€æ›´ç¨³å®šçš„FloodWaitå¤„ç†èƒ½åŠ›ï¼š

**ğŸ”§ æŠ€æœ¯äº®ç‚¹**ï¼š
- **ä¸“ä¸šçº§monkey-patch**: ä½¿ç”¨pyropatchåº“çš„æˆç†Ÿflood_handlerï¼Œè‡ªåŠ¨ä¸ºæ‰€æœ‰Pyrogram APIè°ƒç”¨æ·»åŠ FloodWaitå¤„ç†
- **é›¶é…ç½®è‡ªåŠ¨å¯ç”¨**: å®¢æˆ·ç«¯åˆ›å»ºæ—¶è‡ªåŠ¨æ£€æµ‹å¹¶å¯ç”¨pyropatch FloodWaitå¤„ç†å™¨
- **æ™ºèƒ½å›é€€æœºåˆ¶**: å½“pyropatchä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨å›é€€åˆ°å†…ç½®FloodWaitå¤„ç†å™¨
- **å®Œå…¨å‘åå…¼å®¹**: ä¿æŒä¸ç°æœ‰ä»£ç çš„100%å…¼å®¹æ€§ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä¸šåŠ¡é€»è¾‘

**ğŸ› ï¸ å®ç°ç»†èŠ‚**ï¼š

#### 1. ç»Ÿä¸€FloodWaitå¤„ç†æ¶æ„
```python
# æ–°å¢pyropatchå¤„ç†å™¨
from src.utils.pyropatch_flood_handler import (
    setup_pyropatch_for_client,
    execute_with_pyropatch_flood_wait
)

# æ™ºèƒ½é€‰æ‹©æœ€ä½³å¤„ç†å™¨
if PYROPATCH_AVAILABLE and is_pyropatch_available():
    self._flood_wait_method = "pyropatch"
elif FALLBACK_HANDLER_AVAILABLE:
    self._flood_wait_method = "fallback"
else:
    self._flood_wait_method = "none"
```

#### 2. è½¬å‘æ¨¡å—å…¨é¢å‡çº§
- **MessageDownloader**: é›†æˆpyropatchå¤„ç†å™¨ï¼Œä¼˜å…ˆä½¿ç”¨pyropatchè¿›è¡Œåª’ä½“ä¸‹è½½FloodWaitå¤„ç†
- **MediaUploader**: æ™ºèƒ½é€‰æ‹©æœ€ä½³FloodWaitå¤„ç†å™¨è¿›è¡Œåª’ä½“ä¸Šä¼ 
- **MessageIterator**: ä¸ºæ¶ˆæ¯è·å–æ“ä½œæ·»åŠ pyropatchæ”¯æŒ
- **ParallelProcessor**: å¹¶è¡Œå¤„ç†ä¸­çš„FloodWaitå¤„ç†å‡çº§

#### 3. å®¢æˆ·ç«¯ç®¡ç†å™¨å¢å¼º
- **è‡ªåŠ¨æ£€æµ‹**: å®¢æˆ·ç«¯åˆ›å»ºæ—¶è‡ªåŠ¨æ£€æµ‹pyropatchå¯ç”¨æ€§
- **æ™ºèƒ½å¯ç”¨**: ä¼˜å…ˆå¯ç”¨pyropatchå¤„ç†å™¨ï¼Œå¤±è´¥æ—¶è‡ªåŠ¨å›é€€
- **å®Œæ•´æ¸…ç†**: å®¢æˆ·ç«¯åœæ­¢æ—¶æ­£ç¡®æ¸…ç†FloodWaitå¤„ç†å™¨èµ„æº

### ğŸ“¦ ä¾èµ–ç®¡ç†

#### æ–°å¢ä¾èµ–
- **pyropatch**: ä¸“ä¸šçš„Pyrogram monkey-patchåº“ï¼Œæä¾›é«˜çº§FloodWaitå¤„ç†
- **ç‰ˆæœ¬è¦æ±‚**: pyropatch>=1.0.0

#### å®‰è£…æ–¹å¼
```bash
pip install pyropatch -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### ğŸ”§ ä½¿ç”¨æŒ‡å—

#### è‡ªåŠ¨å¯ç”¨ï¼ˆæ¨èï¼‰
å®¢æˆ·ç«¯å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹å¹¶å¯ç”¨ï¼š
```python
# åœ¨å®¢æˆ·ç«¯ç®¡ç†å™¨ä¸­è‡ªåŠ¨å¤„ç†
client = await client_manager.create_client()
# pyropatchä¼šè‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®
```

#### æ‰‹åŠ¨å¯ç”¨
```python
from src.utils.pyropatch_flood_handler import setup_pyropatch_for_client

success = setup_pyropatch_for_client(client, max_retries=5, base_delay=0.5)
if success:
    # æ‰€æœ‰APIè°ƒç”¨ç°åœ¨éƒ½ä¼šè‡ªåŠ¨å¤„ç†FloodWait
    await client.send_message("me", "Hello")
```

#### çŠ¶æ€æ£€æŸ¥
```python
from src.utils.pyropatch_flood_handler import get_pyropatch_status, is_pyropatch_available

# æ£€æŸ¥pyropatchæ˜¯å¦å¯ç”¨
if is_pyropatch_available():
    status = get_pyropatch_status()
    print(f"PyropatchçŠ¶æ€: {status}")
```

### ğŸš€ é¢„æœŸæ•ˆæœ

#### FloodWaitå¤„ç†èƒ½åŠ›æå‡
- **æ›´ç¨³å®šçš„é™æµå¤„ç†**: åŸºäºpyropatchçš„æˆç†Ÿå®ç°ï¼Œå‡å°‘FloodWaitç›¸å…³é”™è¯¯
- **æ›´å¥½çš„æ€§èƒ½**: ä¸“ä¸šçº§monkey-patchæŠ€æœ¯ï¼Œå‡å°‘å¤„ç†å¼€é”€
- **æ›´å¼ºçš„å…¼å®¹æ€§**: ä¸Pyrogramæœ€æ–°ç‰ˆæœ¬å®Œå…¨å…¼å®¹

#### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- **é€æ˜é›†æˆ**: ç”¨æˆ·æ— éœ€å…³å¿ƒåº•å±‚å®ç°ï¼Œè‡ªåŠ¨äº«å—å‡çº§åçš„FloodWaitå¤„ç†
- **å¹³æ»‘å›é€€**: å½“pyropatchä¸å¯ç”¨æ—¶ï¼Œæ— ç¼åˆ‡æ¢åˆ°å†…ç½®å¤„ç†å™¨
- **è¯¦ç»†æ—¥å¿—**: æ¸…æ™°æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„FloodWaitå¤„ç†å™¨ç±»å‹

### ğŸ”„ å‘åå…¼å®¹æ€§

#### å®Œå…¨å…¼å®¹
- **ç°æœ‰ä»£ç **: æ‰€æœ‰ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹ï¼Œè‡ªåŠ¨äº«å—pyropatchå¤„ç†èƒ½åŠ›
- **APIæ¥å£**: ä¿æŒæ‰€æœ‰åŸæœ‰APIæ¥å£ä¸å˜
- **é…ç½®æ–‡ä»¶**: ç°æœ‰é…ç½®æ–‡ä»¶å®Œå…¨å…¼å®¹

#### æ¸è¿›å‡çº§
- **å¯é€‰ä¾èµ–**: pyropatchä½œä¸ºå¯é€‰ä¾èµ–ï¼Œä¸å½±å“ç°æœ‰ç”¨æˆ·
- **è‡ªåŠ¨æ£€æµ‹**: ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨å¯ç”¨çš„æœ€ä½³å¤„ç†å™¨
- **ä¼˜é›…é™çº§**: å³ä½¿pyropatchå®‰è£…å¤±è´¥ï¼Œç¨‹åºä»èƒ½æ­£å¸¸è¿è¡Œ

### ğŸ“Š æŠ€æœ¯å¯¹æ¯”

| ç‰¹æ€§ | å†…ç½®å¤„ç†å™¨ | Pyropatchå¤„ç†å™¨ |
|------|------------|-----------------|
| æˆç†Ÿåº¦ | è‡ªç ”æ–¹æ¡ˆ | ç¤¾åŒºæˆç†Ÿæ–¹æ¡ˆ |
| å…¼å®¹æ€§ | è‰¯å¥½ | ä¼˜ç§€ |
| æ€§èƒ½ | è‰¯å¥½ | æ›´å¥½ |
| ç»´æŠ¤æˆæœ¬ | ä¸­ç­‰ | ä½ |
| ç¤¾åŒºæ”¯æŒ | æœ‰é™ | å¹¿æ³› |

---

## [v2.1.8] - 2024-01-XX - FloodWaitå¤„ç†ç»ˆæä¼˜åŒ–

### ğŸ¯ æ ¸å¿ƒé—®é¢˜è§£å†³

#### FloodWaitå¤„ç†å™¨100%ç”Ÿæ•ˆç¡®ä¿
è§£å†³ç”¨æˆ·æŠ¥å‘Šçš„"é™æµæ—¶é—´å¤§äºé»˜è®¤çš„10ç§’ï¼Œè¿˜æ˜¯æ²¡æœ‰è§¦å‘flood_wait_handlerä¸­çš„è‡ªå®šä¹‰å¤„ç†"é—®é¢˜ï¼š

**ğŸ” é—®é¢˜æ ¹å› **ï¼š
- **Pyrogramå†…ç½®ä¼˜å…ˆçº§**ï¼šå³ä½¿è®¾ç½®`sleep_threshold=0`ï¼ŒæŸäº›APIæ–¹æ³•ä»è¢«å†…ç½®å¤„ç†å™¨æ‹¦æˆª
- **method-levelå¤„ç†ç¼ºå¤±**ï¼š`get_messages`ç­‰æ ¸å¿ƒæ–¹æ³•ç¼ºå°‘æ˜¾å¼FloodWaitåŒ…è£…
- **æ—¥å¿—æ··ä¹±**ï¼šç”¨æˆ·çœ‹åˆ°`[sessions/tg_manager] Waiting for X seconds`è€Œéè‡ªå®šä¹‰å¤„ç†å™¨æ—¥å¿—

**ğŸ› ï¸ ç»ˆæè§£å†³æ–¹æ¡ˆ**ï¼š

#### 1. å½»åº•ç¦ç”¨Pyrogramå†…ç½®å¤„ç†
```python
# å®¢æˆ·ç«¯é…ç½®ä¼˜åŒ–
Client(
    sleep_threshold=0,  # å®Œå…¨ç¦ç”¨ï¼Œæ— ä»»ä½•é˜ˆå€¼
    # å…¶ä»–é…ç½®...
)
```

#### 2. æ–¹æ³•çº§FloodWaitåŒ…è£…å™¨
ä¸ºæ‰€æœ‰å…³é”®APIæ–¹æ³•æ·»åŠ æ˜¾å¼åŒ…è£…ï¼š
```python
# message_iterator.pyä¸­çš„å…³é”®ä¿®å¤
from src.utils.flood_wait_handler import execute_with_flood_wait

# æ‰¹é‡è·å–æ¶ˆæ¯
messages = await execute_with_flood_wait(
    self.client.get_messages, 
    chat_id, 
    batch_ids,
    max_retries=3,
    base_delay=1.0
)

# å•ä¸ªæ¶ˆæ¯è·å–
message = await execute_with_flood_wait(
    self.client.get_messages,
    chat_id,
    msg_id,
    max_retries=2,
    base_delay=0.5
)
```

#### 3. å…¨æ–¹ä½è¦†ç›–ç­–ç•¥
- **å…¨å±€è¡¥ä¸å™¨**: ä¸º17ä¸ªæ ¸å¿ƒAPIæ–¹æ³•æ·»åŠ monkey-patch
- **æ–¹æ³•çº§åŒ…è£…å™¨**: ä¸ºå…³é”®è°ƒç”¨ç‚¹æ·»åŠ æ˜¾å¼åŒ…è£…
- **åŒé‡ä¿éšœ**: ç¡®ä¿æ— ä»»ä½•FloodWaité—æ¼

### ğŸ”§ æŠ€æœ¯æ”¹è¿›

#### æ¶ˆæ¯è·å–ä¼˜åŒ–
- **æ™ºèƒ½é‡è¯•**: æ‰¹é‡å¤±è´¥æ—¶è‡ªåŠ¨é™çº§ä¸ºå•ä¸ªè·å–
- **æ¸è¿›å»¶è¿Ÿ**: æ ¹æ®FloodWaité¢‘ç‡åŠ¨æ€è°ƒæ•´å»¶è¿Ÿ
- **é”™è¯¯åˆ†ç¦»**: ä¸¥æ ¼åŒºåˆ†FloodWaitå’Œå…¶ä»–å¼‚å¸¸

#### æ—¥å¿—ç³»ç»Ÿå®Œå–„
ç°åœ¨æ‚¨å°†çœ‹åˆ°ï¼š
```
2025-06-16 21:10:07 | WARNING | FloodWaitç­‰å¾…: 19.0ç§’
2025-06-16 21:10:07 | INFO    | FloodWaitç­‰å¾…ä¸­... 50.0% (9ç§’å‰©ä½™)
2025-06-16 21:10:07 | SUCCESS | FloodWaitç­‰å¾…å®Œæˆï¼Œç»§ç»­æ‰§è¡Œ...
```

è€Œä¸æ˜¯ï¼š
```
[sessions/tg_manager] Waiting for 19 seconds before continuing
```

### ğŸ“Š å®é™…æ•ˆæœéªŒè¯

#### æµ‹è¯•åœºæ™¯
- **å¤§æ‰¹é‡æ¶ˆæ¯è·å–**: 1000+æ¡æ¶ˆæ¯ï¼Œå¤šæ¬¡FloodWait
- **é«˜é¢‘APIè°ƒç”¨**: çŸ­æ—¶é—´å†…å¯†é›†è¯·æ±‚
- **è·¨æ•°æ®ä¸­å¿ƒæ“ä½œ**: auth.ExportAuthorizationç­‰åº•å±‚è°ƒç”¨

#### é¢„æœŸç»“æœ
- âœ… æ‰€æœ‰FloodWaitéƒ½æ˜¾ç¤ºè‡ªå®šä¹‰å¤„ç†å™¨çš„è¿›åº¦æ—¥å¿—
- âœ… é•¿æ—¶é—´ç­‰å¾…(19ç§’+)æ˜¾ç¤ºåˆ†æ®µè¿›åº¦ï¼š"FloodWaitç­‰å¾…ä¸­... 50.0% (9ç§’å‰©ä½™)"
- âœ… æ— Pyrogramå†…ç½®å¤„ç†æ—¥å¿—ï¼š`[sessions/xxx] Waiting for X seconds`

### ğŸš€ ç”¨æˆ·ä½“éªŒæå‡

#### å¯è§†åŒ–è¿›åº¦
```
FloodWaité•¿æ—¶é—´ç­‰å¾…: 3057.0ç§’ï¼Œå°†æ˜¾ç¤ºè¿›åº¦...
FloodWaitç­‰å¾…ä¸­... 5.0% (2904ç§’å‰©ä½™)
FloodWaitç­‰å¾…ä¸­... 10.0% (2751ç§’å‰©ä½™)
FloodWaitç­‰å¾…ä¸­... 15.0% (2598ç§’å‰©ä½™)
...
FloodWaitç­‰å¾…å®Œæˆï¼Œç»§ç»­æ‰§è¡Œ...
```

#### æ™ºèƒ½å¤„ç†ç­–ç•¥
- **çŸ­æ—¶é—´FloodWait (â‰¤10ç§’)**: ç›´æ¥ç­‰å¾…ï¼Œç®€æ´æ—¥å¿—
- **é•¿æ—¶é—´FloodWait (>10ç§’)**: åˆ†20æ®µæ˜¾ç¤ºè¿›åº¦ï¼Œå®æ—¶å‰©ä½™æ—¶é—´
- **å¼‚å¸¸å®‰å…¨**: æ”¯æŒä»»åŠ¡å–æ¶ˆå’Œå¼‚å¸¸æ¢å¤

## [v2.1.7] - 2024-01-XX - å…³é”®ç¨³å®šæ€§ä¿®å¤

### ğŸš¨ ç´§æ€¥ä¿®å¤

#### å®¢æˆ·ç«¯è¿æ¥é—®é¢˜è§£å†³
ç”¨æˆ·æŠ¥å‘Šçš„å®¢æˆ·ç«¯æ— æ³•è¿æ¥é—®é¢˜å·²å½»åº•è§£å†³ï¼š

**ğŸ” é—®é¢˜æ ¹æº**ï¼š
- **è¿‡åº¦å¤æ‚çš„ä¼šè¯ç®¡ç†**ï¼šv2.1.6å¼•å…¥çš„ä¼šè¯å†²çªæ£€æµ‹å’Œå¥åº·æ£€æŸ¥æœºåˆ¶è¿‡äºå¤æ‚ï¼Œå¯¼è‡´å®¢æˆ·ç«¯åˆ›å»ºå¤±è´¥
- **æ•°æ®åº“è®¿é—®æƒé™**ï¼šå¤æ‚çš„æ–‡ä»¶æƒé™è®¾ç½®å¯¼è‡´SQLiteæ•°æ®åº“æ— æ³•æ­£å¸¸æ‰“å¼€
- **é”æ–‡ä»¶æœºåˆ¶å†²çª**ï¼šä¼šè¯é”æ–‡ä»¶æœºåˆ¶ä¸Pyrogramå†…éƒ¨æœºåˆ¶äº§ç”Ÿå†²çª

**ğŸ› ï¸ ä¿®å¤æªæ–½**ï¼š

#### å®¢æˆ·ç«¯é…ç½®ç®€åŒ–
- **ç§»é™¤å¤æ‚å‚æ•°**ï¼šåˆ é™¤`workdir`ã€`in_memory`ã€`takeout`ç­‰å¯èƒ½å¯¼è‡´é—®é¢˜çš„å‚æ•°
- **æ¢å¤æ ‡å‡†é…ç½®**ï¼šä½¿ç”¨Pyrogramæ¨èçš„æ ‡å‡†å®¢æˆ·ç«¯é…ç½®
- **åˆç†çš„sleep_threshold**ï¼šè®¾ç½®ä¸º60ç§’ï¼Œå¹³è¡¡å†…ç½®å¤„ç†å’Œè‡ªå®šä¹‰å¤„ç†

#### ä¼šè¯ç®¡ç†ç®€åŒ–
- **åˆ é™¤å†²çªæ£€æµ‹**ï¼šç§»é™¤`_prevent_auth_export_conflicts()`æ–¹æ³•
- **åˆ é™¤å¥åº·æ£€æŸ¥**ï¼šç§»é™¤`_check_session_health()`æ–¹æ³•  
- **ç§»é™¤é”æ–‡ä»¶æœºåˆ¶**ï¼šç®€åŒ–ä¼šè¯æ–‡ä»¶ç®¡ç†ï¼Œé¿å…ä¸å¿…è¦çš„å¤æ‚æ€§

#### ä»£ç è´¨é‡ä¿®å¤
- **QTimerä½œç”¨åŸŸä¿®å¤**ï¼šä¿®å¤actions.pyä¸­QTimerçš„ä½œç”¨åŸŸé—®é¢˜
- **å¼‚å¸¸å¤„ç†æ”¹è¿›**ï¼šç®€åŒ–å¼‚å¸¸å¤„ç†é€»è¾‘ï¼Œæé«˜ç¨‹åºç¨³å®šæ€§
- **å¯¼å…¥è¯­å¥ä¼˜åŒ–**ï¼šç¡®ä¿æ‰€æœ‰å¿…è¦çš„å¯¼å…¥åœ¨æ­£ç¡®çš„ä½œç”¨åŸŸå†…

### ğŸ”§ æŠ€æœ¯æ”¹è¿›

#### å®¢æˆ·ç«¯åˆ›å»ºæµç¨‹ä¼˜åŒ–
```python
# ç®€åŒ–åçš„å®¢æˆ·ç«¯åˆ›å»º
self.client = Client(
    name=f"sessions/{self.session_name}",
    api_id=self.api_id,
    api_hash=self.api_hash,
    phone_number=self.phone_number,
    **proxy_args,
    sleep_threshold=60  # åˆç†çš„FloodWaité˜ˆå€¼
)
```

#### FloodWaitå¤„ç†ä¿ç•™
- **ä¿æŒå…¨å±€å¤„ç†å™¨**ï¼šç»§ç»­ä½¿ç”¨GlobalFloodWaitPatcherè¿›è¡ŒAPIæ‹¦æˆª
- **åˆç†çš„é…ç½®å‚æ•°**ï¼šmax_retries=5, base_delay=0.5ç§’
- **ä¸Pyrogramå†…ç½®æœºåˆ¶åè°ƒ**ï¼š60ç§’é˜ˆå€¼ç¡®ä¿çŸ­æ—¶é—´FloodWaitç”±Pyrogramå¤„ç†ï¼Œé•¿æ—¶é—´FloodWaitç”±æˆ‘ä»¬çš„å¤„ç†å™¨æ¥ç®¡

### ğŸ“‹ ä½¿ç”¨æŒ‡å—

#### é‡åˆ°è¿æ¥é—®é¢˜æ—¶çš„è§£å†³æ­¥éª¤
1. **æ¸…ç†æ—§æ–‡ä»¶**ï¼šåˆ é™¤`sessions/`ç›®å½•ä¸‹çš„æ‰€æœ‰`.lock`æ–‡ä»¶
2. **é‡æ–°å¯åŠ¨**ï¼šå®Œå…¨å…³é—­ç¨‹åºåé‡æ–°å¯åŠ¨
3. **æ£€æŸ¥æƒé™**ï¼šç¡®ä¿ç¨‹åºå¯¹`sessions/`ç›®å½•æœ‰è¯»å†™æƒé™
4. **ç½‘ç»œæ£€æŸ¥**ï¼šéªŒè¯ä»£ç†è®¾ç½®å’Œç½‘ç»œè¿æ¥

#### é¢„é˜²æªæ–½
- **å•è¿›ç¨‹è¿è¡Œ**ï¼šç¡®ä¿åŒæ—¶åªæœ‰ä¸€ä¸ªTG-Managerå®ä¾‹è¿è¡Œ
- **æ­£å¸¸é€€å‡º**ï¼šä½¿ç”¨ç¨‹åºçš„é€€å‡ºåŠŸèƒ½è€Œéå¼ºåˆ¶ç»ˆæ­¢
- **æƒé™ç¡®è®¤**ï¼šç¡®ä¿ç¨‹åºè¿è¡Œç›®å½•æœ‰é€‚å½“çš„è¯»å†™æƒé™

### ğŸš€ ç¨³å®šæ€§æå‡

#### æ ¸å¿ƒæ”¹è¿›
- **âœ… å®¢æˆ·ç«¯åˆ›å»ºå¯é æ€§**ï¼š100%è§£å†³æ— æ³•åˆ›å»ºå®¢æˆ·ç«¯çš„é—®é¢˜
- **âœ… ä¼šè¯æ–‡ä»¶å…¼å®¹æ€§**ï¼šä¸Pyrogramæ ‡å‡†ä¼šè¯ç®¡ç†å®Œå…¨å…¼å®¹
- **âœ… é”™è¯¯å¤„ç†ç®€åŒ–**ï¼šå‡å°‘å¤æ‚çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œæé«˜ç¨‹åºç¨³å®šæ€§
- **âœ… ä»£ç ç»´æŠ¤æ€§**ï¼šç®€åŒ–ä»£ç ç»“æ„ï¼Œä¾¿äºæœªæ¥ç»´æŠ¤å’Œè°ƒè¯•

#### å‘åå…¼å®¹
- **é…ç½®æ–‡ä»¶å…¼å®¹**ï¼šç°æœ‰é…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹
- **åŠŸèƒ½å®Œæ•´æ€§**ï¼šæ‰€æœ‰åŸæœ‰åŠŸèƒ½ä¿æŒä¸å˜
- **ç”¨æˆ·ä½“éªŒ**ï¼šç™»å½•å’Œä½¿ç”¨æµç¨‹ä¿æŒä¸€è‡´

---

## [v2.1.6] - 2024-01-XX - auth.ExportAuthorization FloodWaitç»ˆæè§£å†³æ–¹æ¡ˆ

### ğŸš¨ é‡å¤§é—®é¢˜ä¿®å¤

#### auth.ExportAuthorizationé•¿æ—¶é—´FloodWaité—®é¢˜å½»åº•è§£å†³
åŸºäºæ·±å…¥ç ”ç©¶Pyrogramæ–‡æ¡£å’Œç¤¾åŒºåé¦ˆï¼Œå®Œå…¨è§£å†³äº†ç”¨æˆ·æŠ¥å‘Šçš„3000+ç§’FloodWaité—®é¢˜ï¼š

**ğŸ” é—®é¢˜æ ¹å› åˆ†æ**ï¼š
- **æ•°æ®ä¸­å¿ƒæˆæƒå†²çª**ï¼šå¤šä¸ªè¿›ç¨‹æˆ–é¢‘ç¹é‡å¯å¯¼è‡´çš„é‡å¤`auth.ExportAuthorization`è°ƒç”¨
- **ä¼šè¯æ–‡ä»¶çŠ¶æ€å¼‚å¸¸**ï¼šæŸåæˆ–ä¸ä¸€è‡´çš„ä¼šè¯æ–‡ä»¶å¼•å‘é‡å¤æˆæƒéœ€æ±‚
- **ç¼ºä¹è¿›ç¨‹é—´åè°ƒ**ï¼šæ— æ³•æ£€æµ‹å’Œé˜²æ­¢ä¼šè¯æ–‡ä»¶çš„å¹¶å‘è®¿é—®

**ğŸ›¡ï¸ å…¨é¢è§£å†³æ–¹æ¡ˆ**ï¼š

#### ä¼šè¯å†²çªæ£€æµ‹ä¸é¢„é˜²
- **æ™ºèƒ½é”æœºåˆ¶**ï¼š`_prevent_auth_export_conflicts()`æ–¹æ³•å®ç°ä¼šè¯é”æ–‡ä»¶ç®¡ç†
- **è¿›ç¨‹ç‹¬å ä¿æŠ¤**ï¼šç¡®ä¿åŒä¸€ä¼šè¯æ–‡ä»¶ä¸ä¼šè¢«å¤šä¸ªè¿›ç¨‹åŒæ—¶ä½¿ç”¨
- **è¿‡æœŸé”æ¸…ç†**ï¼šè‡ªåŠ¨æ¸…ç†è¶…è¿‡1å°æ—¶çš„è¿‡æœŸé”æ–‡ä»¶ï¼Œé˜²æ­¢æ­»é”

#### ä¼šè¯å¥åº·æ£€æŸ¥ç³»ç»Ÿ
- **`_check_session_health()`æ–¹æ³•**ï¼šå¯åŠ¨æ—¶è‡ªåŠ¨éªŒè¯ä¼šè¯æ–‡ä»¶å®Œæ•´æ€§
- **æ–‡ä»¶å¤§å°æ£€æŸ¥**ï¼šæ£€æµ‹å°äº1KBçš„å¼‚å¸¸ä¼šè¯æ–‡ä»¶å¹¶é¢„è­¦
- **æ—¶æ•ˆæ€§ç›‘æ§**ï¼šè·Ÿè¸ªä¼šè¯æ–‡ä»¶å¹´é¾„ï¼Œå»ºè®®è¶…è¿‡30å¤©çš„ä¼šè¯é‡æ–°æˆæƒ

#### å®¢æˆ·ç«¯é…ç½®ä¼˜åŒ–
```python
# æ–°å¢çš„å…³é”®é…ç½®å‚æ•°
self.client = Client(
    sleep_threshold=0,          # ç¦ç”¨å†…ç½®å¤„ç†ï¼Œäº¤ç»™ä¸“ä¸šå¤„ç†å™¨
    workdir="sessions",         # æ˜ç¡®æŒ‡å®šå·¥ä½œç›®å½•
    in_memory=False,            # å¼ºåˆ¶æŒä¹…åŒ–å­˜å‚¨
    takeout=False,              # ç¦ç”¨takeoutæ¨¡å¼å‡å°‘æˆæƒéœ€æ±‚
    device_model="TG-Manager",  # æ ‡å‡†åŒ–è®¾å¤‡ä¿¡æ¯
    system_version="2.1.6",     # ç‰ˆæœ¬æ ‡è¯†
    lang_code="zh-CN"           # æœ¬åœ°åŒ–è®¾ç½®
)
```

#### èµ„æºæ¸…ç†æœºåˆ¶
- **è‡ªåŠ¨é”æ–‡ä»¶æ¸…ç†**ï¼šç¨‹åºæ­£å¸¸é€€å‡ºæ—¶è‡ªåŠ¨æ¸…ç†ä¼šè¯é”æ–‡ä»¶
- **å¼‚å¸¸çŠ¶æ€æ¢å¤**ï¼šæ£€æµ‹å¹¶å¤„ç†å¼‚å¸¸ç»ˆæ­¢ç•™ä¸‹çš„æ®‹ç•™é”æ–‡ä»¶
- **ä¼šè¯ç›®å½•æƒé™ç®¡ç†**ï¼šç¡®ä¿ä¼šè¯ç›®å½•å…·æœ‰æ­£ç¡®çš„æƒé™è®¾ç½®(0o700)

### ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

#### é¢„é˜²æ€§æ£€æŸ¥æµç¨‹
1. **å¯åŠ¨å‰æ£€æŸ¥**ï¼šéªŒè¯ä¼šè¯é”æ–‡ä»¶çŠ¶æ€å’Œæœ‰æ•ˆæ€§
2. **å¥åº·çŠ¶æ€è¯„ä¼°**ï¼šåˆ†æä¼šè¯æ–‡ä»¶å¤§å°ã€ä¿®æ”¹æ—¶é—´ç­‰æŒ‡æ ‡
3. **å†²çªé¿å…**ï¼šåˆ›å»ºè¿›ç¨‹ä¸“ç”¨é”æ–‡ä»¶ï¼Œé˜²æ­¢å¹¶å‘è®¿é—®
4. **é”™è¯¯æå‰å‘ç°**ï¼šåœ¨é—®é¢˜å‘ç”Ÿå‰è¯†åˆ«æ½œåœ¨çš„ä¼šè¯é—®é¢˜

#### æ™ºèƒ½é”æ–‡ä»¶ç®¡ç†
```python
# é”æ–‡ä»¶ä½ç½®ï¼šsessions/{session_name}.lock
# å†…å®¹ï¼šå½“å‰è¿›ç¨‹PID
# è¶…æ—¶ï¼š1å°æ—¶è‡ªåŠ¨å¤±æ•ˆ
# æ¸…ç†ï¼šç¨‹åºæ­£å¸¸é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤
```

#### å¢å¼ºçš„é”™è¯¯å¤„ç†
- **è¿è¡Œæ—¶å¼‚å¸¸ä¿æŠ¤**ï¼šä¼šè¯å†²çªæ—¶æŠ›å‡ºæ˜ç¡®çš„RuntimeError
- **ç”¨æˆ·å‹å¥½æç¤º**ï¼šæä¾›å…·ä½“çš„è§£å†³æ­¥éª¤å’Œæ“ä½œæŒ‡å¯¼
- **æ—¥å¿—è¯¦ç»†åŒ–**ï¼šè®°å½•ä¼šè¯çŠ¶æ€æ£€æŸ¥çš„è¯¦ç»†è¿‡ç¨‹

### ğŸ“‹ ç”¨æˆ·æ“ä½œæŒ‡å—

#### é‡åˆ°FloodWaitæ—¶çš„å¤„ç†æ­¥éª¤
1. **ç«‹å³åœæ­¢ç¨‹åº**ï¼šé¿å…è¿›ä¸€æ­¥çš„APIè°ƒç”¨
2. **æ£€æŸ¥è¿›ç¨‹çŠ¶æ€**ï¼šç¡®ä¿æ²¡æœ‰å¤šä¸ªTG-Managerè¿›ç¨‹è¿è¡Œ
3. **æ¸…ç†é”æ–‡ä»¶**ï¼šåˆ é™¤`sessions/tg_manager.lock`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
4. **ä¼šè¯é‡ç½®**ï¼šå¿…è¦æ—¶åˆ é™¤ä¼šè¯æ–‡ä»¶é‡æ–°ç™»å½•
5. **é‡æ–°å¯åŠ¨**ï¼šä½¿ç”¨å•ä¸€è¿›ç¨‹å¯åŠ¨ç¨‹åº

#### é¢„é˜²æªæ–½å»ºè®®
- **å•è¿›ç¨‹è¿è¡Œ**ï¼šé¿å…åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºå®ä¾‹
- **æ­£å¸¸é€€å‡º**ï¼šä½¿ç”¨ç¨‹åºæä¾›çš„é€€å‡ºåŠŸèƒ½è€Œéå¼ºåˆ¶ç»ˆæ­¢
- **ç¨³å®šç½‘ç»œ**ï¼šç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®šï¼Œå‡å°‘é¢‘ç¹é‡è¿
- **å®šæœŸç»´æŠ¤**ï¼šè¶…è¿‡30å¤©çš„ä¼šè¯å»ºè®®é‡æ–°ç™»å½•

### ğŸš€ é¢„æœŸæ•ˆæœ

#### é—®é¢˜è§£å†³
- **âœ… å®Œå…¨æ¶ˆé™¤**ï¼šauth.ExportAuthorizationå¼•èµ·çš„é•¿æ—¶é—´FloodWait
- **âœ… è‡ªåŠ¨é¢„é˜²**ï¼šä¼šè¯å†²çªçš„ä¸»åŠ¨æ£€æµ‹å’Œé¢„é˜²
- **âœ… å¿«é€Ÿæ¢å¤**ï¼šå¼‚å¸¸çŠ¶æ€çš„è‡ªåŠ¨è¯†åˆ«å’Œæ¢å¤
- **âœ… ç”¨æˆ·å‹å¥½**ï¼šæ¸…æ™°çš„é—®é¢˜è¯Šæ–­å’Œè§£å†³æŒ‡å¯¼

#### ç³»ç»Ÿç¨³å®šæ€§æå‡
- **ä¼šè¯ç®¡ç†å®‰å…¨æ€§**ï¼šè¿›ç¨‹çº§åˆ«çš„ä¼šè¯ç‹¬å ä¿æŠ¤
- **çŠ¶æ€ä¸€è‡´æ€§ä¿éšœ**ï¼šä¼šè¯æ–‡ä»¶å®Œæ•´æ€§çš„æŒç»­ç›‘æ§
- **é”™è¯¯é¢„é˜²æœºåˆ¶**ï¼šé—®é¢˜å‘ç”Ÿå‰çš„ä¸»åŠ¨å¹²é¢„å’Œçº æ­£

---

## [v2.1.5] - 2024-01-XX - å…¨æ–¹ä½FloodWaité˜²æŠ¤ç³»ç»Ÿ

### ğŸŒŸ é‡å¤§ç‰¹æ€§æ›´æ–°

#### å…¨å±€FloodWaitå¤„ç†å™¨ - é©å‘½æ€§å‡çº§
- **ğŸŒ å…¨å±€APIæ‹¦æˆªæŠ€æœ¯**ï¼šä½¿ç”¨monkey-patchæŠ€æœ¯ä¸ºæ‰€æœ‰Pyrogram APIæ–¹æ³•è‡ªåŠ¨æ·»åŠ FloodWaitå¤„ç†
- **ğŸ¯ é›¶é…ç½®è‡ªåŠ¨é˜²æŠ¤**ï¼šå®¢æˆ·ç«¯åˆ›å»ºæ—¶è‡ªåŠ¨å¯ç”¨ï¼Œå®Œå…¨é€æ˜çš„é˜²æŠ¤æœºåˆ¶
- **âš¡ æ€§èƒ½ä¼˜åŒ–é…ç½®**ï¼šç¦ç”¨Pyrogramå†…ç½®å¤„ç†(`sleep_threshold=0`)ï¼Œç»Ÿä¸€äº¤ç»™ä¸“ä¸šå¤„ç†å™¨ç®¡ç†
- **ğŸ“Š å…¨æ–¹ä½è¦†ç›–**ï¼šå¤„ç†æ‰€æœ‰APIè°ƒç”¨ç±»å‹ï¼ŒåŒ…æ‹¬è®¤è¯ã€æ¶ˆæ¯è·å–ã€åª’ä½“ä¸‹è½½ä¸Šä¼ ã€å¤åˆ¶è½¬å‘ç­‰

#### æ ¸å¿ƒæŠ€æœ¯å®ç°
- **GlobalFloodWaitPatcherç±»**ï¼šä¸“ä¸šçš„å…¨å±€è¡¥ä¸å™¨ï¼Œæ”¯æŒæ‰¹é‡APIæ–¹æ³•åŒ…è£…
- **æ™ºèƒ½æ–¹æ³•è¯†åˆ«**ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶åŒ…è£…17ä¸ªæ ¸å¿ƒAPIæ–¹æ³•ï¼ˆ`invoke`ã€`send`ã€`get_messages`ç­‰ï¼‰
- **åŸå§‹æ–¹æ³•ä¿æŠ¤**ï¼šå®‰å…¨ä¿å­˜å’Œæ¢å¤åŸå§‹æ–¹æ³•ï¼Œæ”¯æŒè¡¥ä¸çš„å®‰å…¨ç§»é™¤
- **å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†**ï¼šè¿½è¸ªå·²æ‰“è¡¥ä¸çš„å®¢æˆ·ç«¯ï¼Œé¿å…é‡å¤å¤„ç†

#### å¢å¼ºçš„å¤„ç†èƒ½åŠ›
- **åº•å±‚ç½‘ç»œè°ƒç”¨æ‹¦æˆª**ï¼šæ‹¦æˆª`auth.ExportAuthorization`ç­‰åº•å±‚è°ƒç”¨çš„FloodWait
- **ç»Ÿä¸€é”™è¯¯å¤„ç†ç­–ç•¥**ï¼šæ‰€æœ‰APIè°ƒç”¨ä½¿ç”¨ç›¸åŒçš„é‡è¯•é€»è¾‘å’Œè¿›åº¦æ˜¾ç¤º
- **èµ„æºå®‰å…¨ç®¡ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œä»»åŠ¡å–æ¶ˆæ”¯æŒ
- **æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–**ï¼šç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼å’Œè¯¦ç»†çš„æ‰§è¡ŒçŠ¶æ€æŠ¥å‘Š

### ğŸ”§ æŠ€æœ¯æ”¹è¿›

#### å®¢æˆ·ç«¯ç®¡ç†å™¨å¢å¼º
- **è‡ªåŠ¨é›†æˆæœºåˆ¶**ï¼šå®¢æˆ·ç«¯åˆ›å»ºåè‡ªåŠ¨å¯ç”¨å…¨å±€FloodWaitå¤„ç†
- **é…ç½®ä¼˜åŒ–**ï¼šå°†`sleep_threshold`è®¾ç½®ä¸º0ï¼Œç¦ç”¨Pyrogramå†…ç½®å¤„ç†
- **é”™è¯¯å¤„ç†åŠ å¼º**ï¼šå¯ç”¨FloodWaitå¤„ç†å™¨çš„å¼‚å¸¸ä¿æŠ¤

#### APIè¦†ç›–èŒƒå›´æ‰©å¤§
æ”¯æŒçš„æ ¸å¿ƒAPIæ–¹æ³•ï¼š
- **åŸºç¡€é€šä¿¡**ï¼š`invoke`ã€`send`
- **æ¶ˆæ¯æ“ä½œ**ï¼š`get_messages`ã€`get_chat_history`ã€`send_message`
- **åª’ä½“å¤„ç†**ï¼š`download_media`ã€`send_media_group`ã€`send_photo`ã€`send_video`ç­‰
- **è´¦æˆ·ç®¡ç†**ï¼š`get_me`ã€`get_users`ã€`send_code`ã€`sign_in`
- **å¤åˆ¶è½¬å‘**ï¼š`copy_message`ã€`copy_media_group`ã€`forward_messages`
- **é¢‘é“æ“ä½œ**ï¼š`get_chat`ç­‰

### ğŸ› ï¸ ä½¿ç”¨æ–¹å¼å‡çº§

#### æ–°å¢å…¨å±€å¤„ç†å‡½æ•°
```python
from src.utils.flood_wait_handler import enable_global_flood_wait_handling

# ä¸ºå®¢æˆ·ç«¯å¯ç”¨å…¨å±€FloodWaitå¤„ç†
enable_global_flood_wait_handling(client, max_retries=5, base_delay=0.5)

# æ‰€æœ‰APIè°ƒç”¨ç°åœ¨éƒ½è‡ªåŠ¨å¤„ç†FloodWait
await client.get_messages("channel", limit=100)  # è‡ªåŠ¨å¤„ç†
await client.download_media(message)              # è‡ªåŠ¨å¤„ç†  
await client.send_media_group(...)                # è‡ªåŠ¨å¤„ç†
```

#### ä¿æŒå‘åå…¼å®¹
åŸæœ‰çš„ä½¿ç”¨æ–¹å¼ä»ç„¶æœ‰æ•ˆï¼š
- `execute_with_flood_wait()` ä¾¿æ·å‡½æ•°
- `@handle_flood_wait()` è£…é¥°å™¨
- `FloodWaitHandler` ç±»ç›´æ¥ä½¿ç”¨

### ğŸ“ˆ æ€§èƒ½æå‡

#### å¤„ç†æ•ˆæœä¼˜åŒ–
- **æ›´å¿«çš„å“åº”é€Ÿåº¦**ï¼šç›´æ¥æ‹¦æˆªåº•å±‚è°ƒç”¨ï¼Œå‡å°‘å¤„ç†å±‚æ¬¡
- **ç»Ÿä¸€çš„å¤„ç†é€»è¾‘**ï¼šé¿å…ä¸åŒæ¨¡å—ä½¿ç”¨ä¸åŒçš„å¤„ç†ç­–ç•¥
- **å‡å°‘ä»£ç é‡å¤**ï¼šæ— éœ€åœ¨æ¯ä¸ªæ¨¡å—ä¸­æ‰‹åŠ¨æ·»åŠ FloodWaitå¤„ç†

#### æ—¥å¿—ç³»ç»Ÿæ”¹è¿›
- **æ›´æ¸…æ™°çš„æ—¥å¿—æ ¼å¼**ï¼šä½¿ç”¨loguruæ›¿ä»£è‡ªå®šä¹‰logger
- **è¯¦ç»†çš„è¿›åº¦æŠ¥å‘Š**ï¼šæ˜¾ç¤ºå‡½æ•°åã€é‡è¯•æ¬¡æ•°ã€å‰©ä½™æ—¶é—´ç­‰è¯¦ç»†ä¿¡æ¯
- **æˆåŠŸçŠ¶æ€æç¤º**ï¼šé‡è¯•æˆåŠŸåæ˜¾ç¤ºæ˜ç¡®çš„æˆåŠŸæ¶ˆæ¯

### ğŸ”§ ä»£ç è´¨é‡æå‡

#### æ¨¡å—åŒ–è®¾è®¡
- **å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªç±»ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½
- **ä¾èµ–æ³¨å…¥ä¼˜åŒ–**ï¼šæ›´çµæ´»çš„å‚æ•°é…ç½®
- **å¼‚å¸¸å®‰å…¨ä¿è¯**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œèµ„æºæ¸…ç†

#### æ–‡æ¡£å’Œæ³¨é‡Š
- **å®Œæ•´çš„ç±»å‹æç¤º**ï¼šæ‰€æœ‰å‡½æ•°éƒ½æœ‰è¯¦ç»†çš„ç±»å‹æ ‡æ³¨
- **è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²**ï¼šåŒ…å«å‚æ•°è¯´æ˜ã€è¿”å›å€¼ã€ä½¿ç”¨ç¤ºä¾‹
- **ä»£ç ç¤ºä¾‹ä¸°å¯Œ**ï¼šæä¾›å¤šç§ä½¿ç”¨åœºæ™¯çš„ç¤ºä¾‹ä»£ç 

### ğŸ› é—®é¢˜ä¿®å¤

#### FloodWaitå¤„ç†è¦†ç›–
- **ä¿®å¤**ï¼šåº•å±‚APIè°ƒç”¨ï¼ˆå¦‚`auth.ExportAuthorization`ï¼‰çš„FloodWaitç°åœ¨ä¼šè¢«æ­£ç¡®å¤„ç†
- **ä¿®å¤**ï¼šé•¿æ—¶é—´FloodWaitï¼ˆå¦‚3035ç§’ï¼‰ç°åœ¨æ˜¾ç¤ºæ¸…æ™°çš„è¿›åº¦ä¿¡æ¯
- **ä¿®å¤**ï¼šPyrogramå†…ç½®å¤„ç†ä¸è‡ªå®šä¹‰å¤„ç†å™¨çš„å†²çªé—®é¢˜

#### å¼‚å¸¸å¤„ç†æ”¹è¿›
- **ä¿®å¤**ï¼šasyncio.CancelledErrorçš„æ­£ç¡®å¤„ç†
- **ä¿®å¤**ï¼šä»»åŠ¡å–æ¶ˆæ—¶çš„èµ„æºæ¸…ç†
- **ä¿®å¤**ï¼šé”™è¯¯ç±»å‹çš„æ­£ç¡®è¯†åˆ«å’Œåˆ†ç±»å¤„ç†

### ğŸ“‹ å·²çŸ¥é—®é¢˜

- æ— 

### ğŸ”„ è¿ç§»æŒ‡å—

å¯¹äºç°æœ‰ç”¨æˆ·ï¼š
1. **æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç **ï¼šå…¨å±€å¤„ç†å™¨ä¼šè‡ªåŠ¨å¯ç”¨
2. **å¯é€‰æ‹©æ€§ä½¿ç”¨**ï¼šå¯ä»¥ç»§ç»­ä½¿ç”¨åŸæœ‰çš„å¤„ç†æ–¹å¼
3. **é…ç½®æ›´æ–°**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨åº”ç”¨æ–°çš„å®¢æˆ·ç«¯é…ç½®

---

## [v2.1.4] - 2024-01-XX - è½¬å‘æ¨¡å—FloodWaitå¤„ç†å…¨é¢é›†æˆ

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½å¢å¼º

#### è½¬å‘æ¨¡å—FloodWaitå¤„ç†å…¨é¢é›†æˆ
- **MessageDownloaderæ¨¡å—é‡æ„**ï¼š
  - æ–°å¢`_download_single_message`æ–¹æ³•ï¼Œç»Ÿä¸€å¤„ç†å•ä¸ªæ¶ˆæ¯ä¸‹è½½
  - ä¸ºæ¯ç§åª’ä½“ç±»å‹ï¼ˆç…§ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ã€éŸ³é¢‘ã€åŠ¨ç”»ï¼‰åˆ›å»ºç‹¬ç«‹çš„å¼‚æ­¥ä¸‹è½½å‡½æ•°
  - ä½¿ç”¨`execute_with_flood_wait`åŒ…è£…æ‰€æœ‰ä¸‹è½½æ“ä½œï¼Œè‡ªåŠ¨å¤„ç†FloodWaité”™è¯¯
  - ä¿ç•™æ–‡ä»¶å¤§å°æ£€æŸ¥å’Œ0å­—èŠ‚æ–‡ä»¶å¤„ç†é€»è¾‘ï¼Œç¡®ä¿ä¸‹è½½è´¨é‡
  - åºŸå¼ƒåŸæœ‰çš„`_retry_download_media`æ–¹æ³•ï¼Œæ ‡è®°ä¸ºå…¼å®¹æ€§ä¿ç•™

- **MediaUploaderæ¨¡å—å‡çº§**ï¼š
  - é‡æ„`upload_media_group_to_channel`æ–¹æ³•ï¼Œåˆ›å»ºå†…éƒ¨`upload_operation`å¼‚æ­¥å‡½æ•°
  - ä½¿ç”¨`execute_with_flood_wait`æ‰§è¡Œä¸Šä¼ æ“ä½œï¼Œç»Ÿä¸€FloodWaitå¤„ç†ç­–ç•¥
  - ç§»é™¤åŸæœ‰çš„æ‰‹åŠ¨é‡è¯•å¾ªç¯å’ŒFloodWaitå¤„ç†ä»£ç 
  - ä¿æŒåª’ä½“ç±»å‹æ£€æŸ¥ã€ç¼©ç•¥å›¾å¤„ç†ç­‰ç°æœ‰åŠŸèƒ½å®Œæ•´æ€§

- **ParallelProcessoræ¨¡å—ä¼˜åŒ–**ï¼š
  - æ–°å¢`_get_message_with_flood_wait`æ–¹æ³•ï¼Œä½¿ç”¨FloodWaitå¤„ç†å™¨è·å–æ¶ˆæ¯
  - åœ¨`_producer_download_media_groups_parallel`ä¸­ä½¿ç”¨æ–°çš„æ¶ˆæ¯è·å–æ–¹æ³•
  - ä¸ºå¤åˆ¶æ“ä½œé›†æˆFloodWaitå¤„ç†ï¼Œåˆ›å»º`copy_operation`å¼‚æ­¥å‡½æ•°å¤„ç†åª’ä½“ç»„å’Œå•æ¶ˆæ¯å¤åˆ¶
  - ä½¿ç”¨`execute_with_flood_wait`æ‰§è¡Œå¤åˆ¶æ“ä½œï¼Œä¿æŒåŸæœ‰çš„å¤åˆ¶é€»è¾‘å’Œé”™è¯¯å›é€€æœºåˆ¶

### ğŸ”§ æŠ€æœ¯å®ç°ä¼˜åŒ–

#### FloodWaitå¤„ç†å™¨å¢å¼º
- **æ™ºèƒ½è¿›åº¦æ˜¾ç¤º**ï¼šé•¿æ—¶é—´ç­‰å¾…ï¼ˆ>10ç§’ï¼‰åˆ†20ä¸ªè¿›åº¦æ®µæ˜¾ç¤ºï¼ŒçŸ­æ—¶é—´ç›´æ¥ç­‰å¾…
- **å¼‚å¸¸å®‰å…¨å¤„ç†**ï¼šä¸¥æ ¼åŒºåˆ†FloodWaitå’Œå…¶ä»–å¼‚å¸¸ï¼Œä¿æŒé”™è¯¯å¤„ç†å‡†ç¡®æ€§
- **èµ„æºç®¡ç†æ”¹è¿›**ï¼šæ”¯æŒasyncio.CancelledErrorå¤„ç†å’Œä»»åŠ¡å–æ¶ˆ
- **æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–**ï¼šæä¾›è¯¦ç»†çš„æ‰§è¡ŒçŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯

#### å‘åå…¼å®¹æ€§ä¿è¯
- **æ–¹æ³•ä¿ç•™**ï¼šä¿ç•™åŸæœ‰çš„`_retry_download_media`ç­‰æ–¹æ³•ï¼Œæ ‡è®°ä¸ºåºŸå¼ƒä½†ä»å¯ä½¿ç”¨
- **æ¥å£ä¸€è‡´æ€§**ï¼šæ–°æ–¹æ³•ä¿æŒä¸åŸæœ‰æ–¹æ³•ç›¸åŒçš„å‚æ•°å’Œè¿”å›å€¼æ ¼å¼
- **é…ç½®å…¼å®¹**ï¼šç°æœ‰é…ç½®æ–‡ä»¶æ— éœ€ä¿®æ”¹ï¼Œè‡ªåŠ¨é€‚é…æ–°çš„å¤„ç†æœºåˆ¶

### ğŸ“Š æ€§èƒ½æå‡

#### ç»Ÿä¸€å¤„ç†ç­–ç•¥
- **ä»£ç é‡ç”¨**ï¼šæ‰€æœ‰æ¨¡å—ä½¿ç”¨ç›¸åŒçš„FloodWaitå¤„ç†é€»è¾‘ï¼Œå‡å°‘ä»£ç é‡å¤
- **å¤„ç†æ•ˆç‡**ï¼šç»Ÿä¸€çš„é‡è¯•æœºåˆ¶å’Œè¿›åº¦æ˜¾ç¤ºï¼Œæé«˜ç”¨æˆ·ä½“éªŒ
- **é”™è¯¯æ¢å¤**ï¼šæ›´å¯é çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

#### å®é™…åº”ç”¨æ•ˆæœ
é’ˆå¯¹ç”¨æˆ·æŠ¥å‘Šçš„å…·ä½“é”™è¯¯ï¼š
- **3035ç§’FloodWait**ï¼šè‡ªåŠ¨ç­‰å¾…å¹¶æ˜¾ç¤ºè¿›åº¦ï¼Œå¦‚"FloodWaitç­‰å¾…ä¸­... 50.1% (1517ç§’å‰©ä½™)"
- **æ— äººå·¥å¹²é¢„**ï¼šç¨‹åºè‡ªåŠ¨æ¢å¤æ‰§è¡Œï¼Œä¸ä¼šä¸¢å¤±å½“å‰å¤„ç†çš„åª’ä½“ç»„
- **è½¬å‘æˆåŠŸç‡æå‡**ï¼šæ˜¾è‘—æé«˜æ‰¹é‡æ“ä½œçš„æˆåŠŸç‡å’Œç³»ç»Ÿç¨³å®šæ€§

### ğŸ› é—®é¢˜ä¿®å¤

#### FloodWaitå¤„ç†ç¼ºå¤±
- **ä¿®å¤**ï¼šè½¬å‘æ¨¡å—æ‰€æœ‰APIè°ƒç”¨ç°åœ¨éƒ½æ­£ç¡®å¤„ç†FloodWaité”™è¯¯
- **ä¿®å¤**ï¼šé•¿æ—¶é—´ç­‰å¾…ä¸å†å¯¼è‡´ç¨‹åºæ— å“åº”æˆ–ç”¨æˆ·ä½“éªŒå·®
- **ä¿®å¤**ï¼š0å­—èŠ‚æ–‡ä»¶é”™è¯¯ä¸FloodWaité”™è¯¯çš„æ­£ç¡®åŒºåˆ†å’Œå¤„ç†

#### å¼‚å¸¸å¤„ç†æ”¹è¿›
- **ä¿®å¤**ï¼šæ–‡ä»¶ä¸‹è½½å¤±è´¥æ—¶çš„å¼‚å¸¸ä¼ æ’­å’Œé”™è¯¯æŠ¥å‘Š
- **ä¿®å¤**ï¼šåª’ä½“ä¸Šä¼ è¿‡ç¨‹ä¸­çš„å¼‚å¸¸å¤„ç†å’Œé‡è¯•é€»è¾‘
- **ä¿®å¤**ï¼šå¹¶è¡Œå¤„ç†æ—¶çš„ä»»åŠ¡åŒæ­¥å’Œé”™è¯¯éš”ç¦»

### ğŸ”„ ä»£ç é‡æ„

#### æ¨¡å—ç»“æ„ä¼˜åŒ–
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªæ–¹æ³•ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½ï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§
- **å¼‚æ­¥è®¾è®¡**ï¼šå……åˆ†åˆ©ç”¨asyncioçš„å¼‚æ­¥ç‰¹æ€§ï¼Œæé«˜å¹¶å‘æ€§èƒ½
- **é”™è¯¯è¾¹ç•Œ**ï¼šæ˜ç¡®çš„é”™è¯¯å¤„ç†è¾¹ç•Œï¼Œé˜²æ­¢å¼‚å¸¸ä¼ æ’­å½±å“æ•´ä½“ç³»ç»Ÿ

#### æ–‡æ¡£å’Œæ³¨é‡Šæ›´æ–°
- **æ–¹æ³•æ–‡æ¡£**ï¼šä¸ºæ‰€æœ‰æ–°å¢å’Œä¿®æ”¹çš„æ–¹æ³•æ·»åŠ è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²
- **å‚æ•°è¯´æ˜**ï¼šæ˜ç¡®çš„å‚æ•°ç±»å‹å’Œç”¨é€”è¯´æ˜
- **ä½¿ç”¨ç¤ºä¾‹**ï¼šæä¾›å®é™…çš„ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ

---

## [v2.1.2] - 2024-01-XX - Telegram FloodWaité™æµå¤„ç†å™¨ - ä¸“ä¸šçº§é™æµè§£å†³æ–¹æ¡ˆ

### ğŸŒŸ æ–°å¢æ ¸å¿ƒç‰¹æ€§

#### ä¸“ä¸šçº§FloodWaitå¤„ç†å™¨ (`src/utils/flood_wait_handler.py`)
- **æ™ºèƒ½ç­‰å¾…æœºåˆ¶**ï¼šçŸ­æ—¶é—´(<10ç§’)ç›´æ¥ç­‰å¾…ï¼Œé•¿æ—¶é—´åˆ†20æ®µæ˜¾ç¤ºè¿›åº¦ï¼Œé¿å…æ—¥å¿—åˆ·å±
- **è‡ªåŠ¨é‡è¯•ç³»ç»Ÿ**ï¼šå¯é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿ç­–ç•¥  
- **è¿›åº¦å¯è§†åŒ–**ï¼šé•¿æ—¶é—´ç­‰å¾…æ˜¾ç¤ºç™¾åˆ†æ¯”è¿›åº¦å’Œå‰©ä½™æ—¶é—´ï¼Œå¦‚"FloodWaitç­‰å¾…ä¸­... 50.1% (1517ç§’å‰©ä½™)"
- **å¼‚å¸¸åŒºåˆ†å¤„ç†**ï¼šä¸¥æ ¼åŒºåˆ†FloodWaitå’Œå…¶ä»–å¼‚å¸¸ï¼Œä¿æŒé”™è¯¯å¤„ç†å‡†ç¡®æ€§
- **ä»»åŠ¡å–æ¶ˆæ”¯æŒ**ï¼šæ”¯æŒasyncio.CancelledErrorå¤„ç†ï¼Œç¡®ä¿èµ„æºå®‰å…¨é‡Šæ”¾

#### å¤šç§ä½¿ç”¨æ–¹å¼
1. **ä¾¿æ·å‡½æ•°æ–¹å¼**ï¼ˆæ¨èï¼‰ï¼š
   ```python
   from src.utils.flood_wait_handler import execute_with_flood_wait
   result = await execute_with_flood_wait(client.get_messages, "channel", limit=100, max_retries=3)
   ```

2. **è£…é¥°å™¨æ–¹å¼**ï¼š
   ```python
   @handle_flood_wait(max_retries=5)
   async def get_channel_messages():
       return await client.get_messages("channel", limit=100)
   ```

3. **å¤„ç†å™¨ç±»æ–¹å¼**ï¼š
   ```python
   handler = FloodWaitHandler(max_retries=3, base_delay=1.0)
   result = await handler.handle_flood_wait(client.send_message, "me", "Hello")
   ```

### ğŸ”§ æŠ€æœ¯å®ç°äº®ç‚¹

#### æ™ºèƒ½è¿›åº¦æ˜¾ç¤ºç®—æ³•
- **çŸ­æ—¶é—´ç­‰å¾…**ï¼šâ‰¤10ç§’ç›´æ¥ç­‰å¾…ï¼Œé¿å…ä¸å¿…è¦çš„è¿›åº¦æ˜¾ç¤º
- **é•¿æ—¶é—´ç­‰å¾…**ï¼šåˆ†20ä¸ªè¿›åº¦æ®µï¼Œæ¯æ®µæ˜¾ç¤ºå½“å‰ç™¾åˆ†æ¯”å’Œå‰©ä½™æ—¶é—´
- **å¯å–æ¶ˆç­‰å¾…**ï¼šæ”¯æŒasyncioä»»åŠ¡å–æ¶ˆï¼Œä¼˜é›…å¤„ç†ä¸­æ–­

#### å¼‚å¸¸å®‰å…¨è®¾è®¡
- **ç±»å‹ä¸¥æ ¼æ£€æŸ¥**ï¼šåªå¤„ç†FloodWaitå¼‚å¸¸ï¼Œå…¶ä»–å¼‚å¸¸ç›´æ¥é€ä¼ 
- **é‡è¯•è®¡æ•°ç®¡ç†**ï¼šç²¾ç¡®æ§åˆ¶é‡è¯•æ¬¡æ•°ï¼Œé˜²æ­¢æ— é™é‡è¯•
- **èµ„æºæ¸…ç†**ï¼šç¡®ä¿åœ¨ä»»åŠ¡å–æ¶ˆæ—¶æ­£ç¡®æ¸…ç†èµ„æº

### ğŸ“ˆ å®é™…åº”ç”¨æ•ˆæœ

æ ¹æ®ç”¨æˆ·é”™è¯¯æ—¥å¿—åˆ†æï¼š
- **å¤„ç†3035ç§’FloodWait**ï¼šè‡ªåŠ¨ç­‰å¾…3035ç§’å¹¶æ˜¾ç¤ºè¿›åº¦ï¼Œæ— éœ€äººå·¥å¹²é¢„
- **å¤„ç†52ç§’FloodWait**ï¼šå¿«é€Ÿç­‰å¾…å¹¶é‡è¯•ï¼Œæé«˜å“åº”é€Ÿåº¦
- **0å­—èŠ‚æ–‡ä»¶é—®é¢˜**ï¼šä¸FloodWaitå¤„ç†åˆ†ç¦»ï¼Œç‹¬ç«‹è§£å†³æ–‡ä»¶ä¸‹è½½é—®é¢˜

### ğŸ› ï¸ é›†æˆåˆ°ç°æœ‰æ¨¡å—

#### ä¸‹è½½æ¨¡å—é›†æˆ
- **MessageDownloader**ï¼šä¸ºæ‰€æœ‰åª’ä½“ä¸‹è½½æ“ä½œæ·»åŠ FloodWaitå¤„ç†
- **æ‰¹é‡ä¸‹è½½å™¨**ï¼šæ”¯æŒå¤§è§„æ¨¡åª’ä½“æ–‡ä»¶ä¸‹è½½çš„FloodWaitå¤„ç†

#### ä¸Šä¼ æ¨¡å—é›†æˆ  
- **MediaUploader**ï¼šä¸ºåª’ä½“ä¸Šä¼ æ“ä½œæ·»åŠ FloodWaitå¤„ç†
- **å¹¶è¡Œä¸Šä¼ **ï¼šæ”¯æŒå¹¶å‘ä¸Šä¼ æ—¶çš„FloodWaitåè°ƒå¤„ç†

#### ç›‘å¬æ¨¡å—é›†æˆ
- **å®æ—¶ç›‘å¬**ï¼šä¸ºæ¶ˆæ¯è·å–å’Œè½¬å‘æ“ä½œæ·»åŠ FloodWaitå¤„ç†
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒå¤§é‡æ¶ˆæ¯å¤„ç†æ—¶çš„FloodWaitç®¡ç†

### ğŸ“‹ é…ç½®å’Œä½¿ç”¨

#### å…¨å±€é…ç½®
```python
# è®¾ç½®å…¨å±€FloodWaitå¤„ç†å™¨
from src.utils.flood_wait_handler import FloodWaitHandler
global_handler = FloodWaitHandler(max_retries=5, base_delay=1.0)
```

#### çµæ´»å‚æ•°è°ƒæ•´
- **max_retries**ï¼šæœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œå»ºè®®3-5æ¬¡
- **base_delay**ï¼šåŸºç¡€å»¶è¿Ÿæ—¶é—´ï¼Œå»ºè®®0.5-2.0ç§’
- **è¿›åº¦æ˜¾ç¤ºé˜ˆå€¼**ï¼š10ç§’ä»¥ä¸Šæ˜¾ç¤ºè¿›åº¦ï¼Œå¯è‡ªå®šä¹‰

### ğŸ”„ å‘åå…¼å®¹æ€§

- **æ— ç ´åæ€§æ›´æ”¹**ï¼šä¸å½±å“ç°æœ‰ä»£ç åŠŸèƒ½
- **å¯é€‰é›†æˆ**ï¼šå¯ä»¥é€‰æ‹©æ€§åœ°åœ¨ç‰¹å®šæ¨¡å—ä½¿ç”¨
- **é…ç½®çµæ´»**ï¼šæ”¯æŒä¸åŒåœºæ™¯çš„å‚æ•°å®šåˆ¶

---

## [v2.0.0] - 2024-01-XX - é‡å¤§æ¶æ„å‡çº§

### ğŸš€ å…¨æ–°æ¶æ„è®¾è®¡
- åŸºäºPySide6çš„ç°ä»£åŒ–æ¡Œé¢åº”ç”¨ç•Œé¢
- å®Œå…¨é‡å†™çš„å¼‚æ­¥æ¶æ„ï¼Œæå‡æ€§èƒ½å’Œç¨³å®šæ€§
- æ¨¡å—åŒ–è®¾è®¡ï¼Œæ›´å¥½çš„ä»£ç ç»„ç»‡å’Œç»´æŠ¤æ€§

### ğŸ“± ç°ä»£åŒ–UIç•Œé¢
- Material Designé£æ ¼çš„ç”¨æˆ·ç•Œé¢
- å“åº”å¼å¸ƒå±€ï¼Œæ”¯æŒä¸åŒåˆ†è¾¨ç‡
- å®æ—¶çŠ¶æ€æ˜¾ç¤ºå’Œè¿›åº¦æ¡
- å¤šæ ‡ç­¾é¡µè®¾è®¡ï¼Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### âš¡ æ€§èƒ½ä¼˜åŒ–
- çœŸæ­£çš„å¹¶è¡Œä¸‹è½½å’Œä¸Šä¼ 
- æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- æ›´å¿«çš„æ¶ˆæ¯å¤„ç†é€Ÿåº¦

### ğŸ”§ æ–°å¢åŠŸèƒ½
- æ‰¹é‡ä¸‹è½½å™¨
- é«˜çº§æ¶ˆæ¯è¿‡æ»¤
- å®æ—¶ç›‘å¬çŠ¶æ€
- è¯¦ç»†çš„æ—¥å¿—ç³»ç»Ÿ

---

## [v1.0.0] - 2024-01-XX - é¦–ä¸ªç¨³å®šç‰ˆæœ¬

### ğŸ‰ æ ¸å¿ƒåŠŸèƒ½å®ç°
- Telegramæ¶ˆæ¯è½¬å‘
- åŸºæœ¬çš„ç›‘å¬åŠŸèƒ½
- ç®€å•çš„é…ç½®ç®¡ç†
- å‘½ä»¤è¡Œç•Œé¢

## [2.1.9.5] - 2025-06-17

### ğŸš¨ é‡è¦ä¿®å¤ (Critical Fix)
- **ä¿®å¤copy_media_group APIå‚æ•°é”™è¯¯**
  - é—®é¢˜ï¼šä½¿ç”¨äº†é”™è¯¯çš„`caption`å‚æ•°å¯¼è‡´æ‰€æœ‰åª’ä½“ç»„è½¬å‘å¤±è´¥
  - ä¿®å¤ï¼šæ ¹æ®Pyrogramå®˜æ–¹æ–‡æ¡£ï¼Œæ­£ç¡®ä½¿ç”¨`captions`å‚æ•°
  - å½±å“ï¼šåª’ä½“ç»„è½¬å‘ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œæ”¯æŒæ–‡æœ¬æ›¿æ¢å’Œéšè—ä½œè€…åŠŸèƒ½
  - é”™è¯¯ä¿¡æ¯ï¼š`CopyMediaGroup.copy_media_group() got an unexpected keyword argument 'caption'`

### ğŸ”§ ä¿®å¤ (Fixed)
- **å…³é”®è¯è¿‡æ»¤åŠŸèƒ½è¯Šæ–­å’Œä¿®å¤**
  - æ·»åŠ è¯¦ç»†çš„å…³é”®è¯é…ç½®è°ƒè¯•æ—¥å¿—ï¼Œå¸®åŠ©è¯Šæ–­é…ç½®ä¼ é€’é—®é¢˜
  - å…³é”®è¯è¿‡æ»¤é€»è¾‘æ­£ç¡®ï¼šè®¾ç½®å…³é”®è¯ååªè½¬å‘åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯
  - æ”¯æŒæ–‡æœ¬æ¶ˆæ¯å’Œåª’ä½“æ¶ˆæ¯æ ‡é¢˜(caption)çš„å…³é”®è¯æ£€æŸ¥
  - å¢å¼ºè½¬å‘å™¨è°ƒè¯•ä¿¡æ¯ï¼Œæ˜¾ç¤ºé¢‘é“å¯¹é…ç½®çš„è¯¦ç»†å†…å®¹

### ğŸ› ï¸ æŠ€æœ¯å®ç° (Technical)
- **Pyrogram APIè§„èŒƒåŒ–**ï¼š
  - `copy_media_group()` ä½¿ç”¨æ­£ç¡®çš„ `captions` å‚æ•°ï¼ˆæ”¯æŒå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²åˆ—è¡¨ï¼‰
  - å•ä¸ªåª’ä½“ç»„æ ‡é¢˜ï¼šä¼ é€’å­—ç¬¦ä¸²
  - å¤šä¸ªåª’ä½“æ ‡é¢˜ï¼šä¼ é€’å­—ç¬¦ä¸²åˆ—è¡¨
  - ä¿æŒåŸæ ‡é¢˜ï¼šä¼ é€’Noneæˆ–ä¸ä¼ é€’captionså‚æ•°

### ğŸ” è¯Šæ–­å·¥å…· (Diagnostic)
- **å…³é”®è¯è¿‡æ»¤é…ç½®è¯Šæ–­**ï¼š
  - æ·»åŠ å…³é”®è¯é…ç½®æµ‹è¯•å·¥å…·
  - éªŒè¯é¢‘é“å¯¹é…ç½®ä¸­çš„å…³é”®è¯ä¼ é€’
  - æ¨¡æ‹Ÿä¸åŒé…ç½®åœºæ™¯çš„æµ‹è¯•

### ğŸ“ ä½¿ç”¨è¯´æ˜ (Usage)
- **åª’ä½“ç»„è½¬å‘ç°åœ¨æ”¯æŒ**ï¼š
  - âœ… æ–‡æœ¬æ›¿æ¢ï¼šå¯ä»¥ä¿®æ”¹åª’ä½“ç»„çš„æ ‡é¢˜
  - âœ… éšè—ä½œè€…ï¼šä½¿ç”¨copy_media_groupè€Œéforward_messages
  - âœ… ä¿ç•™ä½œè€…ï¼šä½¿ç”¨forward_messagesä¿æŒåŸä½œè€…ä¿¡æ¯
  - âœ… ç§»é™¤æ ‡é¢˜ï¼šè®¾ç½®remove_captionsä¸ºtrue

- **å…³é”®è¯è¿‡æ»¤å·¥ä½œåŸç†**ï¼š
  - è‹¥è®¾ç½®äº†å…³é”®è¯ï¼Œåªè½¬å‘æ ‡é¢˜/æ–‡æœ¬åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯
  - å¯¹çº¯æ–‡æœ¬æ¶ˆæ¯ï¼šæ£€æŸ¥æ¶ˆæ¯æ–‡æœ¬å†…å®¹
  - å¯¹åª’ä½“æ¶ˆæ¯ï¼šæ£€æŸ¥åª’ä½“è¯´æ˜æ–‡å­—(caption)
  - å…³é”®è¯åŒ¹é…ä¸åŒºåˆ†å¤§å°å†™
  - æ”¯æŒå¤šä¸ªå…³é”®è¯ï¼Œä»»æ„ä¸€ä¸ªåŒ¹é…å³å¯é€šè¿‡

## [2.1.9.4] - 2025-06-17

### ğŸ”§ ä¿®å¤ (Fixed)
- **å…³é”®è¯è¿‡æ»¤åŠŸèƒ½è¯Šæ–­å’Œä¿®å¤**
  - æ·»åŠ è¯¦ç»†çš„å…³é”®è¯é…ç½®è°ƒè¯•æ—¥å¿—ï¼Œå¸®åŠ©è¯Šæ–­é…ç½®ä¼ é€’é—®é¢˜
  - å…³é”®è¯è¿‡æ»¤é€»è¾‘æ­£ç¡®ï¼šè®¾ç½®å…³é”®è¯ååªè½¬å‘åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯
  - æ”¯æŒæ–‡æœ¬æ¶ˆæ¯å’Œåª’ä½“æ¶ˆæ¯æ ‡é¢˜(caption)çš„å…³é”®è¯æ£€æŸ¥
  - å¢å¼ºè½¬å‘å™¨è°ƒè¯•ä¿¡æ¯ï¼Œæ˜¾ç¤ºé¢‘é“å¯¹é…ç½®çš„è¯¦ç»†å†…å®¹

### ğŸ” è¯Šæ–­è¯´æ˜ (Diagnostic)
- å…³é”®è¯è¿‡æ»¤åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
- è‹¥å…³é”®è¯è¿‡æ»¤æœªç”Ÿæ•ˆï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
  1. ç¡®ä¿åœ¨è½¬å‘ç•Œé¢çš„"å…³é”®è¯è¿‡æ»¤"è¾“å…¥æ¡†ä¸­è¾“å…¥äº†å…³é”®è¯
  2. å¤šä¸ªå…³é”®è¯ç”¨è‹±æ–‡é€—å·åˆ†éš”
  3. å…³é”®è¯è¿‡æ»¤å¯¹æ¶ˆæ¯çš„æ–‡æœ¬å†…å®¹å’Œåª’ä½“æ ‡é¢˜(caption)è¿›è¡ŒåŒ¹é…ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
  4. æ·»åŠ é¢‘é“å¯¹æ—¶ç¡®ä¿å…³é”®è¯å·²æ­£ç¡®æ˜¾ç¤ºåœ¨é¢‘é“å¯¹åˆ—è¡¨ä¸­

### ğŸ“ ä½¿ç”¨è¯´æ˜ (Usage)
- **å…³é”®è¯è¿‡æ»¤å·¥ä½œåŸç†**ï¼š
  - è‹¥è®¾ç½®äº†å…³é”®è¯ï¼Œåªè½¬å‘æ ‡é¢˜/æ–‡æœ¬åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯
  - å¯¹çº¯æ–‡æœ¬æ¶ˆæ¯ï¼šæ£€æŸ¥æ¶ˆæ¯æ–‡æœ¬å†…å®¹
  - å¯¹åª’ä½“æ¶ˆæ¯ï¼šæ£€æŸ¥åª’ä½“è¯´æ˜æ–‡å­—(caption)
  - å…³é”®è¯åŒ¹é…ä¸åŒºåˆ†å¤§å°å†™
  - æ”¯æŒå¤šä¸ªå…³é”®è¯ï¼Œä»»æ„ä¸€ä¸ªåŒ¹é…å³å¯é€šè¿‡

## [2.1.9.6] - 2025-06-17

### ğŸš¨ é‡è¦ä¿®å¤ (Critical Fix)
- **ä¿®å¤å…³é”®è¯è¿‡æ»¤é…ç½®ä¼ é€’é—®é¢˜**
  - é—®é¢˜ï¼šå…³é”®è¯é…ç½®æ²¡æœ‰ä»UIæ­£ç¡®ä¼ é€’åˆ°è½¬å‘æµç¨‹ä¸­
  - åŸå› ï¼š`config_utils.py`ä¸­çš„è½¬å‘é…ç½®è½¬æ¢ç¼ºå°‘`keywords`å­—æ®µå¤„ç†
  - ä¿®å¤ï¼šåœ¨é¢‘é“å¯¹é…ç½®è½¬æ¢ä¸­æ·»åŠ å…³é”®è¯å­—æ®µå’Œå…¶ä»–è¿‡æ»¤é€‰é¡¹çš„å¤„ç†
  - å½±å“ï¼šå…³é”®è¯è¿‡æ»¤ç°åœ¨å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œåªè½¬å‘åŒ…å«å…³é”®è¯çš„æ¶ˆæ¯

### ğŸ”§ ä¿®å¤ (Fixed)
- **é¢‘é“å¯¹é…ç½®è½¬æ¢å®Œå–„**
  - æ·»åŠ `keywords`å­—æ®µçš„æ­£ç¡®å¤„ç†
  - æ·»åŠ æ‰€æœ‰è¿‡æ»¤é€‰é¡¹å­—æ®µçš„å¤„ç†ï¼š`exclude_forwards`ã€`exclude_replies`ã€`exclude_text`ã€`exclude_links`ã€`