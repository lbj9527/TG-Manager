# 监听模块端到端测试系统 - 快速使用指南

## 🚀 快速开始

### 1. 检查依赖
```bash
cd tests/modules/monitor
python check_dependencies.py
```

### 2. 运行完整测试
```bash
python comprehensive_e2e_test.py
```

### 3. 运行专项测试
```bash
# 媒体组专项测试
python test_media_group_scenarios.py

# 单元测试
pytest test_monitor_comprehensive.py -v
```

## 📁 核心文件说明

### 测试脚本 (3个)
- **`comprehensive_e2e_test.py`** - 主测试程序，运行所有测试套件
- **`test_media_group_scenarios.py`** - 媒体组专项测试
- **`test_monitor_comprehensive.py`** - 单元测试和数据工厂

### 测试数据 (自动加载)
- **`test_data/`** - 测试数据目录
  - `sample_messages/` - 示例消息数据
  - `sample_configs/` - 示例配置数据

### 工具脚本
- **`check_dependencies.py`** - 依赖检查工具

## 📊 测试覆盖范围

✅ **基础功能测试**: 消息创建、处理、转发  
✅ **过滤逻辑测试**: 关键词过滤、媒体类型过滤  
✅ **文本替换测试**: 文本规则替换  
✅ **媒体组测试**: 10个媒体组场景  
✅ **边界情况测试**: 空消息、超长文本、网络错误  

## 🎯 预期结果

- **总测试数**: ~25个
- **成功率**: >95%
- **执行时间**: <3秒
- **API模拟调用**: ~40次

## 💡 故障排除

1. **导入错误**: 确保在正确目录运行
2. **Mock错误**: 检查AsyncMock配置
3. **路径错误**: 运行依赖检查确认文件路径

## 📞 支持

运行遇到问题时，首先运行 `python check_dependencies.py` 检查依赖状态。 